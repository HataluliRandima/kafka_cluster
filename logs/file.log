19:24:11.921 [info]     :supervisor: {:local, :brod_sup}
    :started: [
  pid: #PID<0.349.0>,
  id: :kaffe_producer_client,
  mfargs: {:brod_client, :start_link,
   [
     [{~c"13.40.7.67", 9092}],
     :kaffe_producer_client,
     [
       auto_start_producers: true,
       allow_topic_auto_creation: false,
       default_producer_config: [
         required_acks: 1,
         ack_timeout: 1000,
         partition_buffer_limit: 512,
         partition_onwire_limit: 1,
         max_batch_size: 1048576,
         max_retries: 5,
         retry_backoff_ms: 100,
         compression: :gzip,
         min_compression_batch_size: 1024
       ]
     ]
   ]},
  restart_type: {:permanent, 10},
  shutdown: 5000,
  child_type: :worker
]
19:24:12.770 [info] Running KafkaClusterWeb.Endpoint with cowboy 2.12.0 at 0.0.0.0:4080 (http)
19:24:12.776 [info] Access KafkaClusterWeb.Endpoint at http://localhost:4080
19:24:13.067 [info] Application kafka_cluster exited: KafkaCluster.Application.start(:normal, []) returned an error: shutdown: failed to start child: KafkaCluster.Kaffe.ChargeListener
    ** (EXIT) {:bad_return_from_init, {:stop, %Postgrex.Error{message: nil, postgres: %{code: :invalid_password, line: "326", message: "password authentication failed for user \"postgres\"", file: "auth.c", unknown: "FATAL", severity: "FATAL", pg_code: "28P01", routine: "auth_failed"}, connection_id: nil, query: nil}, %Postgrex.SimpleConnection{idle_interval: 5000, protocol: nil, auto_reconnect: false, reconnect_backoff: 500, state: {Postgrex.Notifications, %Postgrex.Notifications{from: nil, ref: nil, auto_reconnect: false, connected: false, listeners: %{}, listener_channels: %{}}}}}}
19:24:13.068 [info] Application logger_file_backend exited: :stopped
19:24:13.070 [info] Application gettext exited: :stopped
19:24:13.070 [info] Application expo exited: :stopped
19:24:13.074 [info] Application telemetry_poller exited: :stopped
19:24:13.083 [info] Application swoosh exited: :stopped
19:24:13.083 [info] Application finch exited: :stopped
19:24:13.083 [info] Application nimble_options exited: :stopped
19:24:13.085 [info] Application nimble_pool exited: :stopped
19:24:13.086 [info] Application mint exited: :stopped
19:24:13.087 [info] Application hpax exited: :stopped
19:24:13.087 [info] Application xmerl exited: :stopped
19:24:13.089 [info] Application tailwind exited: :stopped
19:24:13.103 [info] Application esbuild exited: :stopped
19:24:13.105 [info] Application phoenix_live_dashboard exited: :stopped
19:24:13.105 [info] Application telemetry_metrics exited: :stopped
19:24:13.107 [info] Application phoenix_live_view exited: :stopped
19:24:13.110 [info] Application phoenix_live_reload exited: :stopped
19:24:13.128 [info] Application file_system exited: :stopped
19:24:13.141 [info] Application ecto_sql exited: :stopped
19:24:13.145 [info] Application phoenix_ecto exited: :stopped
19:24:13.147 [info] Application postgrex exited: :stopped
19:24:15.656 [error] Postgrex.Protocol (#PID<0.511.0>) failed to connect: ** (DBConnection.ConnectionError) tcp connect (10.10.10.168:5432): host is unreachable - :ehostunreach
19:24:15.656 [error] Postgrex.Protocol (#PID<0.515.0>) failed to connect: ** (DBConnection.ConnectionError) tcp connect (10.10.10.168:5432): host is unreachable - :ehostunreach
19:24:15.656 [error] Postgrex.Protocol (#PID<0.512.0>) failed to connect: ** (DBConnection.ConnectionError) tcp connect (10.10.10.168:5432): host is unreachable - :ehostunreach
19:24:15.656 [error] Postgrex.Protocol (#PID<0.514.0>) failed to connect: ** (DBConnection.ConnectionError) tcp connect (10.10.10.168:5432): host is unreachable - :ehostunreach
19:24:15.656 [error] Postgrex.Protocol (#PID<0.513.0>) failed to connect: ** (DBConnection.ConnectionError) tcp connect (10.10.10.168:5432): host is unreachable - :ehostunreach
19:24:15.657 [error] Postgrex.Protocol (#PID<0.516.0>) failed to connect: ** (DBConnection.ConnectionError) tcp connect (10.10.10.168:5432): host is unreachable - :ehostunreach
19:24:20.726 [info] Application db_connection exited: :stopped
19:24:20.727 [info] Application ecto exited: :stopped
19:24:20.728 [info] Application phoenix exited: :stopped
19:24:20.729 [info] Application jason exited: :stopped
19:24:20.729 [info] Application decimal exited: :stopped
19:24:20.729 [info] Application castore exited: :stopped
19:24:20.729 [info] Application websock_adapter exited: :stopped
19:24:20.730 [info] Application plug_cowboy exited: :stopped
19:24:20.730 [info] Application cowboy_telemetry exited: :stopped
19:24:20.732 [info] Application cowboy exited: :stopped
19:24:20.734 [info] Application ranch exited: :stopped
19:24:20.734 [info] Application cowlib exited: :stopped
19:24:20.734 [info] Application websock exited: :stopped
19:24:20.734 [info] Application phoenix_template exited: :stopped
19:24:20.734 [info] Application phoenix_html exited: :stopped
19:24:20.736 [info] Application phoenix_pubsub exited: :stopped
19:24:20.744 [info] Application plug exited: :stopped
19:24:20.754 [info] Application telemetry exited: :stopped
19:24:20.755 [info] Application plug_crypto exited: :stopped
19:24:20.755 [info] Application mime exited: :stopped
19:24:20.755 [info] Application eex exited: :stopped
19:24:20.756 [info] Application kaffe exited: :stopped
19:24:20.756 [info] Application retry exited: :stopped
19:24:20.758 [info] Application brod exited: :stopped
19:24:20.758 [info] Application supervisor3 exited: :stopped
19:24:20.758 [info] Application kafka_protocol exited: :stopped
19:24:20.758 [info] Application crc32cer exited: :stopped
19:24:20.758 [info] Application snappyer exited: :stopped
19:24:20.759 [info] Application runtime_tools exited: :stopped
19:28:51.810 [info]     :supervisor: {:local, :brod_sup}
    :started: [
  pid: #PID<0.233.0>,
  id: :kaffe_producer_client,
  mfargs: {:brod_client, :start_link,
   [
     [{~c"13.40.7.67", 9092}],
     :kaffe_producer_client,
     [
       auto_start_producers: true,
       allow_topic_auto_creation: false,
       default_producer_config: [
         required_acks: 1,
         ack_timeout: 1000,
         partition_buffer_limit: 512,
         partition_onwire_limit: 1,
         max_batch_size: 1048576,
         max_retries: 5,
         retry_backoff_ms: 100,
         compression: :gzip,
         min_compression_batch_size: 1024
       ]
     ]
   ]},
  restart_type: {:permanent, 10},
  shutdown: 5000,
  child_type: :worker
]
19:28:52.632 [info] Running KafkaClusterWeb.Endpoint with cowboy 2.12.0 at 0.0.0.0:4080 (http)
19:28:52.671 [info] Access KafkaClusterWeb.Endpoint at http://localhost:4080
19:28:52.804 [info] Thoma
19:29:46.002 [info] Payload :: "{\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"allocated_cost\":0.0,\"uncharged\":null,\"allocated_qty\":165681,\"applies_to\":{\"balances\": [\"uncapped\"], \"service_type\": \"mobile_data\"},\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"charged_for\":\"Unlimited home 5G Premium\",\"charged_to\":[{\"qty\": 165681, \"amount\": 0, \"balance_name\": \"uncapped\"}],\"connection_surcharge\":0,\"cost\":0.0,\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"description\":null,\"end_time\":\"2024-01-19T11:35:00+00:00\",\"item_seq_num\":1,\"meta\":{\"ratType\": \"NR\", \"consumed\": {\"6000\": {\"cost\": 0, \"end_time\": \"2024-01-19T13:35:00+02:00\", \"quantity\": 165681, \"uncharged\": 0, \"start_time\": \"2024-01-19T13:25:17+02:00\", \"allocated_qty\": 0, \"allocated_cost\": 0, \"session_status\": 300}}, \"ipv4_addr\": \"10.209.0.26\", \"requestor\": \"satest\", \"chargingId\": 375767394, \"service_id\": \"msisdn-27816699304\", \"resource_id\": \"imei-861935050829590\", \"oneTimeEvent\": false, \"userLocationinfo\": {\"nrLocation\": {\"tai\": {\"nid\": null, \"tac\": \"07F394\", \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}}, \"ncgi\": {\"nid\": null, \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}, \"nrCellId\": \"0d1414033\"}, \"ignoreNcgi\": null, \"globalGnbId\": null, \"geodeticInformation\": null, \"ueLocationTimestamp\": \"2024-01-19T13:25:15+02:00\", \"geographicalInformation\": null, \"ageOfLocationInformation\": null}, \"n3gaLocation\": null, \"eutraLocation\": null}},\"post_surcharge\":0,\"primary_service\":\"5G Home X\",\"quantity\":165681,\"rating_group\":6000,\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"rg_meta\":{\"mode\": \"ONLINE\", \"sessionFailover\": \"FAILOVER_NOT_SUPPORTED\"},\"rounding_policy\":\"1.110000\",\"start_time\":\"2024-01-19T11:25:18+00:00\",\"status\":400,\"sub_id\":\"imsi-655730000598400\",\"tariff_plan\":\"5G Home X\",\"taxes\":{\"gl\": \"9500A030\", \"name\": \"VAT\", \"fixed\": 0, \"percentage\": 15, \"tax_amount\": 0.0, \"taxable_amount\": 0, \"tax_inclusive_amount\": 0.0},\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"tp_meta\":{\"model\": \"POST-PAID\", \"unit_info\": {\"triggers\": [{\"triggerType\": \"QUOTA_THRESHOLD\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QUOTA_EXHAUSTED\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QHT\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"VALIDITY_TIME\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"validityTime\": 43200, \"quotaHoldingTime\": 0, \"timeQuotaThreshold\": 70, \"unitQuotaThreshold\": 80}, \"final_unit\": {\"finalUnitAction\": \"TERMINATE\"}, \"quota_calc\": \"default\", \"quota_rules\": [], \"neg_balances\": false, \"default_quota\": {\"name\": \"totalVolume\", \"quota\": 57982058496}, \"policy_states\": [\"High Speed\", \"RICA\", \"Device\", \"Payment\", \"PAYMENT_HOLD\"], \"vqt_percentage\": 0.4},\"type\":100,\"unit\":{\"time\": null, \"triggers\": [{\"timeLimit\": null, \"triggerType\": \"FINAL\", \"volumeLimit\": null, \"volumeLimit64\": null, \"maxNumberOfccc\": null, \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"totalVolume\": 165681, \"uplinkVolume\": 165681, \"downlinkVolume\": 0, \"eventTimeStamp\": null, \"triggerTimestamp\": \"2024-01-19T13:35:01+02:00\", \"serviceSpecificUnits\": null},\"unit_rate\":0,\"error\":null,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\"}"
19:29:46.004 [info] Decoded Payload :: %{"timestamp" => "2024-01-19T11:35:01+00:00", "charged_to" => [%{"amount" => 0, "balance_name" => "uncapped", "qty" => 165681}], "id" => "\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035", "cost" => 0.0, "status" => 400, "quantity" => 165681, "primary_service" => "5G Home X", "allocated_qty" => 165681, "type" => 100, "service_id" => "a72e5f19-6245-4d24-8f69-3bf4bf215895", "connection_surcharge" => 0, "inserted_at" => "2024-01-19T11:35:32+00:00", "updated_at" => "2024-01-19T11:35:32+00:00", "end_time" => "2024-01-19T11:35:00+00:00", "meta" => %{"chargingId" => 375767394, "consumed" => %{"6000" => %{"allocated_cost" => 0, "allocated_qty" => 0, "cost" => 0, "end_time" => "2024-01-19T13:35:00+02:00", "quantity" => 165681, "session_status" => 300, "start_time" => "2024-01-19T13:25:17+02:00", "uncharged" => 0}}, "ipv4_addr" => "10.209.0.26", "oneTimeEvent" => false, "ratType" => "NR", "requestor" => "satest", "resource_id" => "imei-861935050829590", "service_id" => "msisdn-27816699304", "userLocationinfo" => %{"eutraLocation" => nil, "n3gaLocation" => nil, "nrLocation" => %{"ageOfLocationInformation" => nil, "geodeticInformation" => nil, "geographicalInformation" => nil, "globalGnbId" => nil, "ignoreNcgi" => nil, "ncgi" => %{"nid" => nil, "nrCellId" => "0d1414033", "plmnId" => %{"mcc" => "655", "mnc" => "73"}}, "tai" => %{"nid" => nil, "plmnId" => %{"mcc" => "655", "mnc" => "73"}, "tac" => "07F394"}, "ueLocationTimestamp" => "2024-01-19T13:25:15+02:00"}}}, "rating_group" => 6000, "uncharged" => nil, "charged_for" => "Unlimited home 5G Premium", "rg_meta" => %{"mode" => "ONLINE", "sessionFailover" => "FAILOVER_NOT_SUPPORTED"}, "start_time" => "2024-01-19T11:25:18+00:00", "c_id" => "20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2", "rounding_policy" => "1.110000", "unit_rate" => 0, "sub_id" => "imsi-655730000598400", "cr_id" => "20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2", "tp_meta" => %{"default_quota" => %{"name" => "totalVolume", "quota" => 57982058496}, "final_unit" => %{"finalUnitAction" => "TERMINATE"}, "model" => "POST-PAID", "neg_balances" => false, "policy_states" => ["High Speed", "RICA", "Device", "Payment", "PAYMENT_HOLD"], "quota_calc" => "default", "quota_rules" => [], "unit_info" => %{"quotaHoldingTime" => 0, "timeQuotaThreshold" => 70, "triggers" => [%{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_THRESHOLD"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_EXHAUSTED"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QHT"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "VALIDITY_TIME"}], "unitQuotaThreshold" => 80, "validityTime" => 43200}, "vqt_percentage" => 0.4}, "requestor_node_id" => "trc_udg_upf_01", "requestor_service_id" => nil, "item_seq_num" => 1, "applies_to" => %{"balances" => ["uncapped"], "service_type" => "mobile_data"}, "description" => nil, "unit" => %{"downlinkVolume" => 0, "eventTimeStamp" => nil, "serviceSpecificUnits" => nil, "time" => nil, "totalVolume" => 165681, "triggerTimestamp" => "2024-01-19T13:35:01+02:00", "triggers" => [%{"maxNumberOfccc" => nil, "timeLimit" => nil, "triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "FINAL", "volumeLimit" => nil, "volumeLimit64" => nil}], "uplinkVolume" => 165681}, "post_surcharge" => 0, "tariff_plan" => "5G Home X", "taxes" => %{"fixed" => 0, "gl" => "9500A030", "name" => "VAT", "percentage" => 15, "tax_amount" => 0.0, "tax_inclusive_amount" => 0.0, "taxable_amount" => 0}, "allocated_cost" => 0.0, "error" => nil}
19:29:46.246 [error] GenServer KafkaCluster.Kaffe.ChargeListener terminating
** (FunctionClauseError) no function clause matching in Kaffe.Producer.choose_partition/5
    (kaffe 1.25.0) lib/kaffe/producer.ex:212: Kaffe.Producer.choose_partition("kafka-topic-test", 3, "charge_key", "{\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"charged_to\":[{\"amount\":0,\"balance_name\":\"uncapped\",\"qty\":165681}],\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"cost\":0.0,\"status\":400,\"quantity\":165681,\"primary_service\":\"5G Home X\",\"allocated_qty\":165681,\"type\":100,\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\",\"connection_surcharge\":0,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"end_time\":\"2024-01-19T11:35:00+00:00\",\"meta\":{\"chargingId\":375767394,\"consumed\":{\"6000\":{\"allocated_cost\":0,\"allocated_qty\":0,\"cost\":0,\"end_time\":\"2024-01-19T13:35:00+02:00\",\"quantity\":165681,\"session_status\":300,\"start_time\":\"2024-01-19T13:25:17+02:00\",\"uncharged\":0}},\"ipv4_addr\":\"10.209.0.26\",\"oneTimeEvent\":false,\"ratType\":\"NR\",\"requestor\":\"satest\",\"resource_id\":\"imei-861935050829590\",\"service_id\":\"msisdn-27816699304\",\"userLocationinfo\":{\"eutraLocation\":null,\"n3gaLocation\":null,\"nrLocation\":{\"ageOfLocationInformation\":null,\"geodeticInformation\":null,\"geographicalInformation\":null,\"globalGnbId\":null,\"ignoreNcgi\":null,\"ncgi\":{\"nid\":null,\"nrCellId\":\"0d1414033\",\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"}},\"tai\":{\"nid\":null,\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"},\"tac\":\"07F394\"},\"ueLocationTimestamp\":\"2024-01-19T13:25:15+02:00\"}}},\"rating_group\":6000,\"uncharged\":null,\"charged_for\":\"Unlimited home 5G Premium\",\"rg_meta\":{\"mode\":\"ONLINE\",\"sessionFailover\":\"FAILOVER_NOT_SUPPORTED\"},\"start_time\":\"2024-01-19T11:25:18+00:00\",\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"rounding_policy\":\"1.110000\",\"unit_rate\":0,\"sub_id\":\"imsi-655730000598400\",\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"tp_meta\":{\"default_quota\":{\"name\":\"totalVolume\",\"quota\":57982058496},\"final_unit\":{\"finalUnitAction\":\"TERMINATE\"},\"model\":\"POST-PAID\",\"neg_balances\":false,\"policy_states\":[\"High Speed\",\"RICA\",\"Device\",\"Payment\",\"PAYMENT_HOLD\"],\"quota_calc\":\"default\",\"quota_rules\":[],\"unit_info\":{\"quotaHoldingTime\":0,\"timeQuotaThreshold\":70,\"triggers\":[{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_THRESHOLD\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_EXHAUSTED\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QHT\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"VALIDITY_TIME\"}],\"unitQuotaThreshold\":80,\"validityTime\":43200},\"vqt_percentage\":0.4},\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"item_seq_num\":1,\"applies_to\":{\"balances\":[\"uncapped\"],\"service_type\":\"mobile_data\"},\"description\":null,\"unit\":{\"downlinkVolume\":0,\"eventTimeStamp\":null,\"serviceSpecificUnits\":null,\"time\":null,\"totalVolume\":165681,\"triggerTimestamp\":\"2024-01-19T13:35:01+02:00\",\"triggers\":[{\"maxNumberOfccc\":null,\"timeLimit\":null,\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"FINAL\",\"volumeLimit\":null,\"volumeLimit64\":null}],\"uplinkVolume\":165681},\"post_surcharge\":0,\"tariff_plan\":\"5G Home X\",\"taxes\":{\"fixed\":0,\"gl\":\"9500A030\",\"name\":\"VAT\",\"percentage\":15,\"tax_amount\":0.0,\"tax_inclusive_amount\":0.0,\"taxable_amount\":0},\"allocated_cost\":0.0,\"error\":null}", :round_robin)
    (elixir 1.16.0-rc.0) lib/enum.ex:1414: anonymous fn/4 in Enum.group_by/3
    (elixir 1.16.0-rc.0) lib/enum.ex:2528: Enum."-group_by/3-lists^foldl/2-0-"/3
    (kaffe 1.25.0) lib/kaffe/producer.ex:140: Kaffe.Producer.produce_list/3
    (elixir 1.16.0-rc.0) lib/enum.ex:992: anonymous fn/3 in Enum.each/2
    (elixir 1.16.0-rc.0) lib/enum.ex:4391: Enum.reduce_range/5
    (elixir 1.16.0-rc.0) lib/enum.ex:2532: Enum.each/2
    (kafka_cluster 0.1.0) lib/kafka_cluster/kaffe/producer.ex:12: KafkaCluster.Kaffe.Producer.send_my_message/3
    (kafka_cluster 0.1.0) lib/kafka_cluster/kaffe/charge_listener.ex:33: KafkaCluster.Kaffe.ChargeListener.handle_info/2
    (stdlib 5.1.1) gen_server.erl:1077: :gen_server.try_handle_info/3
    (stdlib 5.1.1) gen_server.erl:1165: :gen_server.handle_msg/6
    (stdlib 5.1.1) proc_lib.erl:241: :proc_lib.init_p_do_apply/3
Last message: {:notification, #PID<0.548.0>, #Reference<0.1713408316.2888040453.25826>, "new_charge", "{\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"allocated_cost\":0.0,\"uncharged\":null,\"allocated_qty\":165681,\"applies_to\":{\"balances\": [\"uncapped\"], \"service_type\": \"mobile_data\"},\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"charged_for\":\"Unlimited home 5G Premium\",\"charged_to\":[{\"qty\": 165681, \"amount\": 0, \"balance_name\": \"uncapped\"}],\"connection_surcharge\":0,\"cost\":0.0,\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"description\":null,\"end_time\":\"2024-01-19T11:35:00+00:00\",\"item_seq_num\":1,\"meta\":{\"ratType\": \"NR\", \"consumed\": {\"6000\": {\"cost\": 0, \"end_time\": \"2024-01-19T13:35:00+02:00\", \"quantity\": 165681, \"uncharged\": 0, \"start_time\": \"2024-01-19T13:25:17+02:00\", \"allocated_qty\": 0, \"allocated_cost\": 0, \"session_status\": 300}}, \"ipv4_addr\": \"10.209.0.26\", \"requestor\": \"satest\", \"chargingId\": 375767394, \"service_id\": \"msisdn-27816699304\", \"resource_id\": \"imei-861935050829590\", \"oneTimeEvent\": false, \"userLocationinfo\": {\"nrLocation\": {\"tai\": {\"nid\": null, \"tac\": \"07F394\", \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}}, \"ncgi\": {\"nid\": null, \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}, \"nrCellId\": \"0d1414033\"}, \"ignoreNcgi\": null, \"globalGnbId\": null, \"geodeticInformation\": null, \"ueLocationTimestamp\": \"2024-01-19T13:25:15+02:00\", \"geographicalInformation\": null, \"ageOfLocationInformation\": null}, \"n3gaLocation\": null, \"eutraLocation\": null}},\"post_surcharge\":0,\"primary_service\":\"5G Home X\",\"quantity\":165681,\"rating_group\":6000,\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"rg_meta\":{\"mode\": \"ONLINE\", \"sessionFailover\": \"FAILOVER_NOT_SUPPORTED\"},\"rounding_policy\":\"1.110000\",\"start_time\":\"2024-01-19T11:25:18+00:00\",\"status\":400,\"sub_id\":\"imsi-655730000598400\",\"tariff_plan\":\"5G Home X\",\"taxes\":{\"gl\": \"9500A030\", \"name\": \"VAT\", \"fixed\": 0, \"percentage\": 15, \"tax_amount\": 0.0, \"taxable_amount\": 0, \"tax_inclusive_amount\": 0.0},\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"tp_meta\":{\"model\": \"POST-PAID\", \"unit_info\": {\"triggers\": [{\"triggerType\": \"QUOTA_THRESHOLD\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QUOTA_EXHAUSTED\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QHT\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"VALIDITY_TIME\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"validityTime\": 43200, \"quotaHoldingTime\": 0, \"timeQuotaThreshold\": 70, \"unitQuotaThreshold\": 80}, \"final_unit\": {\"finalUnitAction\": \"TERMINATE\"}, \"quota_calc\": \"default\", \"quota_rules\": [], \"neg_balances\": false, \"default_quota\": {\"name\": \"totalVolume\", \"quota\": 57982058496}, \"policy_states\": [\"High Speed\", \"RICA\", \"Device\", \"Payment\", \"PAYMENT_HOLD\"], \"vqt_percentage\": 0.4},\"type\":100,\"unit\":{\"time\": null, \"triggers\": [{\"timeLimit\": null, \"triggerType\": \"FINAL\", \"volumeLimit\": null, \"volumeLimit64\": null, \"maxNumberOfccc\": null, \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"totalVolume\": 165681, \"uplinkVolume\": 165681, \"downlinkVolume\": 0, \"eventTimeStamp\": null, \"triggerTimestamp\": \"2024-01-19T13:35:01+02:00\", \"serviceSpecificUnits\": null},\"unit_rate\":0,\"error\":nul (truncated)
19:29:46.482 [info] Thoma
19:34:27.380 [info]     :supervisor: {:local, :brod_sup}
    :started: [
  pid: #PID<0.253.0>,
  id: :kaffe_producer_client,
  mfargs: {:brod_client, :start_link,
   [
     [{~c"13.40.7.67", 9092}],
     :kaffe_producer_client,
     [
       auto_start_producers: true,
       allow_topic_auto_creation: false,
       default_producer_config: [
         required_acks: 1,
         ack_timeout: 1000,
         partition_buffer_limit: 512,
         partition_onwire_limit: 1,
         max_batch_size: 1048576,
         max_retries: 5,
         retry_backoff_ms: 100,
         compression: :gzip,
         min_compression_batch_size: 1024
       ]
     ]
   ]},
  restart_type: {:permanent, 10},
  shutdown: 5000,
  child_type: :worker
]
19:34:29.183 [info] Running KafkaClusterWeb.Endpoint with cowboy 2.12.0 at 0.0.0.0:4080 (http)
19:34:29.199 [info] Access KafkaClusterWeb.Endpoint at http://localhost:4080
19:34:29.350 [info] Thoma
19:34:31.786 [info] Payload :: "{\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"allocated_cost\":0.0,\"uncharged\":null,\"allocated_qty\":165681,\"applies_to\":{\"balances\": [\"uncapped\"], \"service_type\": \"mobile_data\"},\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"charged_for\":\"Unlimited home 5G Premium\",\"charged_to\":[{\"qty\": 165681, \"amount\": 0, \"balance_name\": \"uncapped\"}],\"connection_surcharge\":0,\"cost\":0.0,\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"description\":null,\"end_time\":\"2024-01-19T11:35:00+00:00\",\"item_seq_num\":1,\"meta\":{\"ratType\": \"NR\", \"consumed\": {\"6000\": {\"cost\": 0, \"end_time\": \"2024-01-19T13:35:00+02:00\", \"quantity\": 165681, \"uncharged\": 0, \"start_time\": \"2024-01-19T13:25:17+02:00\", \"allocated_qty\": 0, \"allocated_cost\": 0, \"session_status\": 300}}, \"ipv4_addr\": \"10.209.0.26\", \"requestor\": \"satest\", \"chargingId\": 375767394, \"service_id\": \"msisdn-27816699304\", \"resource_id\": \"imei-861935050829590\", \"oneTimeEvent\": false, \"userLocationinfo\": {\"nrLocation\": {\"tai\": {\"nid\": null, \"tac\": \"07F394\", \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}}, \"ncgi\": {\"nid\": null, \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}, \"nrCellId\": \"0d1414033\"}, \"ignoreNcgi\": null, \"globalGnbId\": null, \"geodeticInformation\": null, \"ueLocationTimestamp\": \"2024-01-19T13:25:15+02:00\", \"geographicalInformation\": null, \"ageOfLocationInformation\": null}, \"n3gaLocation\": null, \"eutraLocation\": null}},\"post_surcharge\":0,\"primary_service\":\"5G Home X\",\"quantity\":165681,\"rating_group\":6000,\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"rg_meta\":{\"mode\": \"ONLINE\", \"sessionFailover\": \"FAILOVER_NOT_SUPPORTED\"},\"rounding_policy\":\"1.110000\",\"start_time\":\"2024-01-19T11:25:18+00:00\",\"status\":400,\"sub_id\":\"imsi-655730000598400\",\"tariff_plan\":\"5G Home X\",\"taxes\":{\"gl\": \"9500A030\", \"name\": \"VAT\", \"fixed\": 0, \"percentage\": 15, \"tax_amount\": 0.0, \"taxable_amount\": 0, \"tax_inclusive_amount\": 0.0},\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"tp_meta\":{\"model\": \"POST-PAID\", \"unit_info\": {\"triggers\": [{\"triggerType\": \"QUOTA_THRESHOLD\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QUOTA_EXHAUSTED\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QHT\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"VALIDITY_TIME\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"validityTime\": 43200, \"quotaHoldingTime\": 0, \"timeQuotaThreshold\": 70, \"unitQuotaThreshold\": 80}, \"final_unit\": {\"finalUnitAction\": \"TERMINATE\"}, \"quota_calc\": \"default\", \"quota_rules\": [], \"neg_balances\": false, \"default_quota\": {\"name\": \"totalVolume\", \"quota\": 57982058496}, \"policy_states\": [\"High Speed\", \"RICA\", \"Device\", \"Payment\", \"PAYMENT_HOLD\"], \"vqt_percentage\": 0.4},\"type\":100,\"unit\":{\"time\": null, \"triggers\": [{\"timeLimit\": null, \"triggerType\": \"FINAL\", \"volumeLimit\": null, \"volumeLimit64\": null, \"maxNumberOfccc\": null, \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"totalVolume\": 165681, \"uplinkVolume\": 165681, \"downlinkVolume\": 0, \"eventTimeStamp\": null, \"triggerTimestamp\": \"2024-01-19T13:35:01+02:00\", \"serviceSpecificUnits\": null},\"unit_rate\":0,\"error\":null,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\"}"
19:34:31.786 [info] Decoded Payload :: %{"timestamp" => "2024-01-19T11:35:01+00:00", "charged_to" => [%{"amount" => 0, "balance_name" => "uncapped", "qty" => 165681}], "id" => "\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035", "cost" => 0.0, "status" => 400, "quantity" => 165681, "primary_service" => "5G Home X", "allocated_qty" => 165681, "type" => 100, "service_id" => "a72e5f19-6245-4d24-8f69-3bf4bf215895", "connection_surcharge" => 0, "inserted_at" => "2024-01-19T11:35:32+00:00", "updated_at" => "2024-01-19T11:35:32+00:00", "end_time" => "2024-01-19T11:35:00+00:00", "meta" => %{"chargingId" => 375767394, "consumed" => %{"6000" => %{"allocated_cost" => 0, "allocated_qty" => 0, "cost" => 0, "end_time" => "2024-01-19T13:35:00+02:00", "quantity" => 165681, "session_status" => 300, "start_time" => "2024-01-19T13:25:17+02:00", "uncharged" => 0}}, "ipv4_addr" => "10.209.0.26", "oneTimeEvent" => false, "ratType" => "NR", "requestor" => "satest", "resource_id" => "imei-861935050829590", "service_id" => "msisdn-27816699304", "userLocationinfo" => %{"eutraLocation" => nil, "n3gaLocation" => nil, "nrLocation" => %{"ageOfLocationInformation" => nil, "geodeticInformation" => nil, "geographicalInformation" => nil, "globalGnbId" => nil, "ignoreNcgi" => nil, "ncgi" => %{"nid" => nil, "nrCellId" => "0d1414033", "plmnId" => %{"mcc" => "655", "mnc" => "73"}}, "tai" => %{"nid" => nil, "plmnId" => %{"mcc" => "655", "mnc" => "73"}, "tac" => "07F394"}, "ueLocationTimestamp" => "2024-01-19T13:25:15+02:00"}}}, "rating_group" => 6000, "uncharged" => nil, "charged_for" => "Unlimited home 5G Premium", "rg_meta" => %{"mode" => "ONLINE", "sessionFailover" => "FAILOVER_NOT_SUPPORTED"}, "start_time" => "2024-01-19T11:25:18+00:00", "c_id" => "20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2", "rounding_policy" => "1.110000", "unit_rate" => 0, "sub_id" => "imsi-655730000598400", "cr_id" => "20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2", "tp_meta" => %{"default_quota" => %{"name" => "totalVolume", "quota" => 57982058496}, "final_unit" => %{"finalUnitAction" => "TERMINATE"}, "model" => "POST-PAID", "neg_balances" => false, "policy_states" => ["High Speed", "RICA", "Device", "Payment", "PAYMENT_HOLD"], "quota_calc" => "default", "quota_rules" => [], "unit_info" => %{"quotaHoldingTime" => 0, "timeQuotaThreshold" => 70, "triggers" => [%{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_THRESHOLD"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_EXHAUSTED"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QHT"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "VALIDITY_TIME"}], "unitQuotaThreshold" => 80, "validityTime" => 43200}, "vqt_percentage" => 0.4}, "requestor_node_id" => "trc_udg_upf_01", "requestor_service_id" => nil, "item_seq_num" => 1, "applies_to" => %{"balances" => ["uncapped"], "service_type" => "mobile_data"}, "description" => nil, "unit" => %{"downlinkVolume" => 0, "eventTimeStamp" => nil, "serviceSpecificUnits" => nil, "time" => nil, "totalVolume" => 165681, "triggerTimestamp" => "2024-01-19T13:35:01+02:00", "triggers" => [%{"maxNumberOfccc" => nil, "timeLimit" => nil, "triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "FINAL", "volumeLimit" => nil, "volumeLimit64" => nil}], "uplinkVolume" => 165681}, "post_surcharge" => 0, "tariff_plan" => "5G Home X", "taxes" => %{"fixed" => 0, "gl" => "9500A030", "name" => "VAT", "percentage" => 15, "tax_amount" => 0.0, "tax_inclusive_amount" => 0.0, "taxable_amount" => 0}, "allocated_cost" => 0.0, "error" => nil}
19:34:31.981 [info]     :supervisor: {#PID<0.373.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.582.0>,
  id: "kafka-topic-test",
  mfargs: {:supervisor3, :start_link,
   [
     :brod_producers_sup,
     {:brod_producers_sup2, #PID<0.253.0>, "kafka-topic-test",
      [
        required_acks: 1,
        ack_timeout: 1000,
        partition_buffer_limit: 512,
        partition_onwire_limit: 1,
        max_batch_size: 1048576,
        max_retries: 5,
        retry_backoff_ms: 100,
        compression: :gzip,
        min_compression_batch_size: 1024
      ]}
   ]},
  restart_type: {:permanent, 10},
  shutdown: :infinity,
  child_type: :supervisor
]
19:34:31.991 [info]     :supervisor: {#PID<0.582.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.583.0>,
  id: 0,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     0,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :gzip,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
19:34:31.992 [info]     :supervisor: {#PID<0.582.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.584.0>,
  id: 1,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     1,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :gzip,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
19:34:31.993 [info]     :supervisor: {#PID<0.582.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.585.0>,
  id: 2,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     2,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :gzip,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
19:34:33.240 [error] client :kaffe_producer_client failed to connect to kafka3:9092
reason:{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:34:33.241 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:34:33.529 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:34:33.529 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:34:33.811 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:34:33.812 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:34:34.094 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:34:34.094 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:34:35.498 [error] client :kaffe_producer_client failed to connect to kafka3:9092
reason:{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:34:35.499 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:34:35.786 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:34:35.787 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:34:35.788 [error] GenServer #PID<0.583.0> terminating
** (stop) {:reached_max_retries, :no_leader_connection}
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer_buffer.erl:312: :brod_producer_buffer.rebuffer_or_crash/3
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer_buffer.erl:296: :brod_producer_buffer.do_send/4
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer.erl:525: :brod_producer.maybe_produce/1
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer.erl:325: :brod_producer.handle_info/2
    (stdlib 5.1.1) gen_server.erl:1077: :gen_server.try_handle_info/3
    (stdlib 5.1.1) gen_server.erl:1165: :gen_server.handle_msg/6
    (stdlib 5.1.1) proc_lib.erl:241: :proc_lib.init_p_do_apply/3
Last message: :retry
State: {:state, #PID<0.253.0>, "kafka-topic-test", 0, :undefined, :undefined, {:buf, 512, 1, 1048576, 5, 0, 0, {&:brod_producer.do_send_fun/4, {"kafka-topic-test", 0, 1, 1000, :gzip}}, 1, 0, {[], []}, {[], []}, []}, 100, #Reference<0.215834250.2619867137.156221>, :undefined, {:default, 0}}
19:34:35.801 [info] Sent 1 messages to topic kafka-topic-test in 4004 ms
19:34:35.802 [info] Sent messages to topic kafka-topic-test in "{\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"charged_to\":[{\"amount\":0,\"balance_name\":\"uncapped\",\"qty\":165681}],\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"cost\":0.0,\"status\":400,\"quantity\":165681,\"primary_service\":\"5G Home X\",\"allocated_qty\":165681,\"type\":100,\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\",\"connection_surcharge\":0,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"end_time\":\"2024-01-19T11:35:00+00:00\",\"meta\":{\"chargingId\":375767394,\"consumed\":{\"6000\":{\"allocated_cost\":0,\"allocated_qty\":0,\"cost\":0,\"end_time\":\"2024-01-19T13:35:00+02:00\",\"quantity\":165681,\"session_status\":300,\"start_time\":\"2024-01-19T13:25:17+02:00\",\"uncharged\":0}},\"ipv4_addr\":\"10.209.0.26\",\"oneTimeEvent\":false,\"ratType\":\"NR\",\"requestor\":\"satest\",\"resource_id\":\"imei-861935050829590\",\"service_id\":\"msisdn-27816699304\",\"userLocationinfo\":{\"eutraLocation\":null,\"n3gaLocation\":null,\"nrLocation\":{\"ageOfLocationInformation\":null,\"geodeticInformation\":null,\"geographicalInformation\":null,\"globalGnbId\":null,\"ignoreNcgi\":null,\"ncgi\":{\"nid\":null,\"nrCellId\":\"0d1414033\",\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"}},\"tai\":{\"nid\":null,\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"},\"tac\":\"07F394\"},\"ueLocationTimestamp\":\"2024-01-19T13:25:15+02:00\"}}},\"rating_group\":6000,\"uncharged\":null,\"charged_for\":\"Unlimited home 5G Premium\",\"rg_meta\":{\"mode\":\"ONLINE\",\"sessionFailover\":\"FAILOVER_NOT_SUPPORTED\"},\"start_time\":\"2024-01-19T11:25:18+00:00\",\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"rounding_policy\":\"1.110000\",\"unit_rate\":0,\"sub_id\":\"imsi-655730000598400\",\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"tp_meta\":{\"default_quota\":{\"name\":\"totalVolume\",\"quota\":57982058496},\"final_unit\":{\"finalUnitAction\":\"TERMINATE\"},\"model\":\"POST-PAID\",\"neg_balances\":false,\"policy_states\":[\"High Speed\",\"RICA\",\"Device\",\"Payment\",\"PAYMENT_HOLD\"],\"quota_calc\":\"default\",\"quota_rules\":[],\"unit_info\":{\"quotaHoldingTime\":0,\"timeQuotaThreshold\":70,\"triggers\":[{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_THRESHOLD\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_EXHAUSTED\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QHT\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"VALIDITY_TIME\"}],\"unitQuotaThreshold\":80,\"validityTime\":43200},\"vqt_percentage\":0.4},\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"item_seq_num\":1,\"applies_to\":{\"balances\":[\"uncapped\"],\"service_type\":\"mobile_data\"},\"description\":null,\"unit\":{\"downlinkVolume\":0,\"eventTimeStamp\":null,\"serviceSpecificUnits\":null,\"time\":null,\"totalVolume\":165681,\"triggerTimestamp\":\"2024-01-19T13:35:01+02:00\",\"triggers\":[{\"maxNumberOfccc\":null,\"timeLimit\":null,\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"FINAL\",\"volumeLimit\":null,\"volumeLimit64\":null}],\"uplinkVolume\":165681},\"post_surcharge\":0,\"tariff_plan\":\"5G Home X\",\"taxes\":{\"fixed\":0,\"gl\":\"9500A030\",\"name\":\"VAT\",\"percentage\":15,\"tax_amount\":0.0,\"tax_inclusive_amount\":0.0,\"taxable_amount\":0},\"allocated_cost\":0.0,\"error\":null}"
19:34:35.802 [info] Sent 1 messages to topic kafka-topic-test in 4004 ms
19:34:40.801 [info]     :supervisor: {#PID<0.582.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.594.0>,
  id: 0,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     0,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :gzip,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
19:34:53.100 [info] Payload :: "{\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"allocated_cost\":0.0,\"uncharged\":null,\"allocated_qty\":165681,\"applies_to\":{\"balances\": [\"uncapped\"], \"service_type\": \"mobile_data\"},\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"charged_for\":\"Unlimited home 5G Premium\",\"charged_to\":[{\"qty\": 165681, \"amount\": 0, \"balance_name\": \"uncapped\"}],\"connection_surcharge\":0,\"cost\":0.0,\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"description\":null,\"end_time\":\"2024-01-19T11:35:00+00:00\",\"item_seq_num\":1,\"meta\":{\"ratType\": \"NR\", \"consumed\": {\"6000\": {\"cost\": 0, \"end_time\": \"2024-01-19T13:35:00+02:00\", \"quantity\": 165681, \"uncharged\": 0, \"start_time\": \"2024-01-19T13:25:17+02:00\", \"allocated_qty\": 0, \"allocated_cost\": 0, \"session_status\": 300}}, \"ipv4_addr\": \"10.209.0.26\", \"requestor\": \"satest\", \"chargingId\": 375767394, \"service_id\": \"msisdn-27816699304\", \"resource_id\": \"imei-861935050829590\", \"oneTimeEvent\": false, \"userLocationinfo\": {\"nrLocation\": {\"tai\": {\"nid\": null, \"tac\": \"07F394\", \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}}, \"ncgi\": {\"nid\": null, \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}, \"nrCellId\": \"0d1414033\"}, \"ignoreNcgi\": null, \"globalGnbId\": null, \"geodeticInformation\": null, \"ueLocationTimestamp\": \"2024-01-19T13:25:15+02:00\", \"geographicalInformation\": null, \"ageOfLocationInformation\": null}, \"n3gaLocation\": null, \"eutraLocation\": null}},\"post_surcharge\":0,\"primary_service\":\"5G Home X\",\"quantity\":165681,\"rating_group\":6000,\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"rg_meta\":{\"mode\": \"ONLINE\", \"sessionFailover\": \"FAILOVER_NOT_SUPPORTED\"},\"rounding_policy\":\"1.110000\",\"start_time\":\"2024-01-19T11:25:18+00:00\",\"status\":400,\"sub_id\":\"imsi-655730000598400\",\"tariff_plan\":\"5G Home X\",\"taxes\":{\"gl\": \"9500A030\", \"name\": \"VAT\", \"fixed\": 0, \"percentage\": 15, \"tax_amount\": 0.0, \"taxable_amount\": 0, \"tax_inclusive_amount\": 0.0},\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"tp_meta\":{\"model\": \"POST-PAID\", \"unit_info\": {\"triggers\": [{\"triggerType\": \"QUOTA_THRESHOLD\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QUOTA_EXHAUSTED\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QHT\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"VALIDITY_TIME\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"validityTime\": 43200, \"quotaHoldingTime\": 0, \"timeQuotaThreshold\": 70, \"unitQuotaThreshold\": 80}, \"final_unit\": {\"finalUnitAction\": \"TERMINATE\"}, \"quota_calc\": \"default\", \"quota_rules\": [], \"neg_balances\": false, \"default_quota\": {\"name\": \"totalVolume\", \"quota\": 57982058496}, \"policy_states\": [\"High Speed\", \"RICA\", \"Device\", \"Payment\", \"PAYMENT_HOLD\"], \"vqt_percentage\": 0.4},\"type\":100,\"unit\":{\"time\": null, \"triggers\": [{\"timeLimit\": null, \"triggerType\": \"FINAL\", \"volumeLimit\": null, \"volumeLimit64\": null, \"maxNumberOfccc\": null, \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"totalVolume\": 165681, \"uplinkVolume\": 165681, \"downlinkVolume\": 0, \"eventTimeStamp\": null, \"triggerTimestamp\": \"2024-01-19T13:35:01+02:00\", \"serviceSpecificUnits\": null},\"unit_rate\":0,\"error\":null,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\"}"
19:34:53.100 [info] Decoded Payload :: %{"timestamp" => "2024-01-19T11:35:01+00:00", "charged_to" => [%{"amount" => 0, "balance_name" => "uncapped", "qty" => 165681}], "id" => "\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035", "cost" => 0.0, "status" => 400, "quantity" => 165681, "primary_service" => "5G Home X", "allocated_qty" => 165681, "type" => 100, "service_id" => "a72e5f19-6245-4d24-8f69-3bf4bf215895", "connection_surcharge" => 0, "inserted_at" => "2024-01-19T11:35:32+00:00", "updated_at" => "2024-01-19T11:35:32+00:00", "end_time" => "2024-01-19T11:35:00+00:00", "meta" => %{"chargingId" => 375767394, "consumed" => %{"6000" => %{"allocated_cost" => 0, "allocated_qty" => 0, "cost" => 0, "end_time" => "2024-01-19T13:35:00+02:00", "quantity" => 165681, "session_status" => 300, "start_time" => "2024-01-19T13:25:17+02:00", "uncharged" => 0}}, "ipv4_addr" => "10.209.0.26", "oneTimeEvent" => false, "ratType" => "NR", "requestor" => "satest", "resource_id" => "imei-861935050829590", "service_id" => "msisdn-27816699304", "userLocationinfo" => %{"eutraLocation" => nil, "n3gaLocation" => nil, "nrLocation" => %{"ageOfLocationInformation" => nil, "geodeticInformation" => nil, "geographicalInformation" => nil, "globalGnbId" => nil, "ignoreNcgi" => nil, "ncgi" => %{"nid" => nil, "nrCellId" => "0d1414033", "plmnId" => %{"mcc" => "655", "mnc" => "73"}}, "tai" => %{"nid" => nil, "plmnId" => %{"mcc" => "655", "mnc" => "73"}, "tac" => "07F394"}, "ueLocationTimestamp" => "2024-01-19T13:25:15+02:00"}}}, "rating_group" => 6000, "uncharged" => nil, "charged_for" => "Unlimited home 5G Premium", "rg_meta" => %{"mode" => "ONLINE", "sessionFailover" => "FAILOVER_NOT_SUPPORTED"}, "start_time" => "2024-01-19T11:25:18+00:00", "c_id" => "20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2", "rounding_policy" => "1.110000", "unit_rate" => 0, "sub_id" => "imsi-655730000598400", "cr_id" => "20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2", "tp_meta" => %{"default_quota" => %{"name" => "totalVolume", "quota" => 57982058496}, "final_unit" => %{"finalUnitAction" => "TERMINATE"}, "model" => "POST-PAID", "neg_balances" => false, "policy_states" => ["High Speed", "RICA", "Device", "Payment", "PAYMENT_HOLD"], "quota_calc" => "default", "quota_rules" => [], "unit_info" => %{"quotaHoldingTime" => 0, "timeQuotaThreshold" => 70, "triggers" => [%{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_THRESHOLD"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_EXHAUSTED"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QHT"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "VALIDITY_TIME"}], "unitQuotaThreshold" => 80, "validityTime" => 43200}, "vqt_percentage" => 0.4}, "requestor_node_id" => "trc_udg_upf_01", "requestor_service_id" => nil, "item_seq_num" => 1, "applies_to" => %{"balances" => ["uncapped"], "service_type" => "mobile_data"}, "description" => nil, "unit" => %{"downlinkVolume" => 0, "eventTimeStamp" => nil, "serviceSpecificUnits" => nil, "time" => nil, "totalVolume" => 165681, "triggerTimestamp" => "2024-01-19T13:35:01+02:00", "triggers" => [%{"maxNumberOfccc" => nil, "timeLimit" => nil, "triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "FINAL", "volumeLimit" => nil, "volumeLimit64" => nil}], "uplinkVolume" => 165681}, "post_surcharge" => 0, "tariff_plan" => "5G Home X", "taxes" => %{"fixed" => 0, "gl" => "9500A030", "name" => "VAT", "percentage" => 15, "tax_amount" => 0.0, "tax_inclusive_amount" => 0.0, "taxable_amount" => 0}, "allocated_cost" => 0.0, "error" => nil}
19:34:54.327 [error] client :kaffe_producer_client failed to connect to kafka3:9092
reason:{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:34:54.327 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:34:54.609 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:34:54.610 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:34:54.890 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:34:54.891 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:34:55.173 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:34:55.173 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:34:56.500 [error] client :kaffe_producer_client failed to connect to kafka3:9092
reason:{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:34:56.501 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:34:56.782 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:34:56.782 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:34:56.783 [error] GenServer #PID<0.594.0> terminating
** (stop) {:reached_max_retries, :no_leader_connection}
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer_buffer.erl:312: :brod_producer_buffer.rebuffer_or_crash/3
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer_buffer.erl:296: :brod_producer_buffer.do_send/4
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer.erl:525: :brod_producer.maybe_produce/1
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer.erl:325: :brod_producer.handle_info/2
    (stdlib 5.1.1) gen_server.erl:1077: :gen_server.try_handle_info/3
    (stdlib 5.1.1) gen_server.erl:1165: :gen_server.handle_msg/6
    (stdlib 5.1.1) proc_lib.erl:241: :proc_lib.init_p_do_apply/3
Last message: :retry
State: {:state, #PID<0.253.0>, "kafka-topic-test", 0, :undefined, :undefined, {:buf, 512, 1, 1048576, 5, 0, 0, {&:brod_producer.do_send_fun/4, {"kafka-topic-test", 0, 1, 1000, :gzip}}, 1, 0, {[], []}, {[], []}, []}, 100, #Reference<0.215834250.2619867138.160112>, :undefined, {:default, 0}}
19:34:56.784 [info] Sent 1 messages to topic kafka-topic-test in 3683 ms
19:34:56.784 [info] Sent messages to topic kafka-topic-test in "{\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"charged_to\":[{\"amount\":0,\"balance_name\":\"uncapped\",\"qty\":165681}],\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"cost\":0.0,\"status\":400,\"quantity\":165681,\"primary_service\":\"5G Home X\",\"allocated_qty\":165681,\"type\":100,\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\",\"connection_surcharge\":0,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"end_time\":\"2024-01-19T11:35:00+00:00\",\"meta\":{\"chargingId\":375767394,\"consumed\":{\"6000\":{\"allocated_cost\":0,\"allocated_qty\":0,\"cost\":0,\"end_time\":\"2024-01-19T13:35:00+02:00\",\"quantity\":165681,\"session_status\":300,\"start_time\":\"2024-01-19T13:25:17+02:00\",\"uncharged\":0}},\"ipv4_addr\":\"10.209.0.26\",\"oneTimeEvent\":false,\"ratType\":\"NR\",\"requestor\":\"satest\",\"resource_id\":\"imei-861935050829590\",\"service_id\":\"msisdn-27816699304\",\"userLocationinfo\":{\"eutraLocation\":null,\"n3gaLocation\":null,\"nrLocation\":{\"ageOfLocationInformation\":null,\"geodeticInformation\":null,\"geographicalInformation\":null,\"globalGnbId\":null,\"ignoreNcgi\":null,\"ncgi\":{\"nid\":null,\"nrCellId\":\"0d1414033\",\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"}},\"tai\":{\"nid\":null,\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"},\"tac\":\"07F394\"},\"ueLocationTimestamp\":\"2024-01-19T13:25:15+02:00\"}}},\"rating_group\":6000,\"uncharged\":null,\"charged_for\":\"Unlimited home 5G Premium\",\"rg_meta\":{\"mode\":\"ONLINE\",\"sessionFailover\":\"FAILOVER_NOT_SUPPORTED\"},\"start_time\":\"2024-01-19T11:25:18+00:00\",\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"rounding_policy\":\"1.110000\",\"unit_rate\":0,\"sub_id\":\"imsi-655730000598400\",\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"tp_meta\":{\"default_quota\":{\"name\":\"totalVolume\",\"quota\":57982058496},\"final_unit\":{\"finalUnitAction\":\"TERMINATE\"},\"model\":\"POST-PAID\",\"neg_balances\":false,\"policy_states\":[\"High Speed\",\"RICA\",\"Device\",\"Payment\",\"PAYMENT_HOLD\"],\"quota_calc\":\"default\",\"quota_rules\":[],\"unit_info\":{\"quotaHoldingTime\":0,\"timeQuotaThreshold\":70,\"triggers\":[{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_THRESHOLD\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_EXHAUSTED\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QHT\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"VALIDITY_TIME\"}],\"unitQuotaThreshold\":80,\"validityTime\":43200},\"vqt_percentage\":0.4},\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"item_seq_num\":1,\"applies_to\":{\"balances\":[\"uncapped\"],\"service_type\":\"mobile_data\"},\"description\":null,\"unit\":{\"downlinkVolume\":0,\"eventTimeStamp\":null,\"serviceSpecificUnits\":null,\"time\":null,\"totalVolume\":165681,\"triggerTimestamp\":\"2024-01-19T13:35:01+02:00\",\"triggers\":[{\"maxNumberOfccc\":null,\"timeLimit\":null,\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"FINAL\",\"volumeLimit\":null,\"volumeLimit64\":null}],\"uplinkVolume\":165681},\"post_surcharge\":0,\"tariff_plan\":\"5G Home X\",\"taxes\":{\"fixed\":0,\"gl\":\"9500A030\",\"name\":\"VAT\",\"percentage\":15,\"tax_amount\":0.0,\"tax_inclusive_amount\":0.0,\"taxable_amount\":0},\"allocated_cost\":0.0,\"error\":null}"
19:34:56.785 [info] Sent 1 messages to topic kafka-topic-test in 3683 ms
19:35:01.784 [info]     :supervisor: {#PID<0.582.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.603.0>,
  id: 0,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     0,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :gzip,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
19:35:11.221 [info] Payload :: "{\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"allocated_cost\":0.0,\"uncharged\":null,\"allocated_qty\":165681,\"applies_to\":{\"balances\": [\"uncapped\"], \"service_type\": \"mobile_data\"},\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"charged_for\":\"Unlimited home 5G Premium\",\"charged_to\":[{\"qty\": 165681, \"amount\": 0, \"balance_name\": \"uncapped\"}],\"connection_surcharge\":0,\"cost\":0.0,\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"description\":null,\"end_time\":\"2024-01-19T11:35:00+00:00\",\"item_seq_num\":1,\"meta\":{\"ratType\": \"NR\", \"consumed\": {\"6000\": {\"cost\": 0, \"end_time\": \"2024-01-19T13:35:00+02:00\", \"quantity\": 165681, \"uncharged\": 0, \"start_time\": \"2024-01-19T13:25:17+02:00\", \"allocated_qty\": 0, \"allocated_cost\": 0, \"session_status\": 300}}, \"ipv4_addr\": \"10.209.0.26\", \"requestor\": \"satest\", \"chargingId\": 375767394, \"service_id\": \"msisdn-27816699304\", \"resource_id\": \"imei-861935050829590\", \"oneTimeEvent\": false, \"userLocationinfo\": {\"nrLocation\": {\"tai\": {\"nid\": null, \"tac\": \"07F394\", \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}}, \"ncgi\": {\"nid\": null, \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}, \"nrCellId\": \"0d1414033\"}, \"ignoreNcgi\": null, \"globalGnbId\": null, \"geodeticInformation\": null, \"ueLocationTimestamp\": \"2024-01-19T13:25:15+02:00\", \"geographicalInformation\": null, \"ageOfLocationInformation\": null}, \"n3gaLocation\": null, \"eutraLocation\": null}},\"post_surcharge\":0,\"primary_service\":\"5G Home X\",\"quantity\":165681,\"rating_group\":6000,\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"rg_meta\":{\"mode\": \"ONLINE\", \"sessionFailover\": \"FAILOVER_NOT_SUPPORTED\"},\"rounding_policy\":\"1.110000\",\"start_time\":\"2024-01-19T11:25:18+00:00\",\"status\":400,\"sub_id\":\"imsi-655730000598400\",\"tariff_plan\":\"5G Home X\",\"taxes\":{\"gl\": \"9500A030\", \"name\": \"VAT\", \"fixed\": 0, \"percentage\": 15, \"tax_amount\": 0.0, \"taxable_amount\": 0, \"tax_inclusive_amount\": 0.0},\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"tp_meta\":{\"model\": \"POST-PAID\", \"unit_info\": {\"triggers\": [{\"triggerType\": \"QUOTA_THRESHOLD\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QUOTA_EXHAUSTED\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QHT\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"VALIDITY_TIME\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"validityTime\": 43200, \"quotaHoldingTime\": 0, \"timeQuotaThreshold\": 70, \"unitQuotaThreshold\": 80}, \"final_unit\": {\"finalUnitAction\": \"TERMINATE\"}, \"quota_calc\": \"default\", \"quota_rules\": [], \"neg_balances\": false, \"default_quota\": {\"name\": \"totalVolume\", \"quota\": 57982058496}, \"policy_states\": [\"High Speed\", \"RICA\", \"Device\", \"Payment\", \"PAYMENT_HOLD\"], \"vqt_percentage\": 0.4},\"type\":100,\"unit\":{\"time\": null, \"triggers\": [{\"timeLimit\": null, \"triggerType\": \"FINAL\", \"volumeLimit\": null, \"volumeLimit64\": null, \"maxNumberOfccc\": null, \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"totalVolume\": 165681, \"uplinkVolume\": 165681, \"downlinkVolume\": 0, \"eventTimeStamp\": null, \"triggerTimestamp\": \"2024-01-19T13:35:01+02:00\", \"serviceSpecificUnits\": null},\"unit_rate\":0,\"error\":null,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\"}"
19:35:11.223 [info] Decoded Payload :: %{"timestamp" => "2024-01-19T11:35:01+00:00", "charged_to" => [%{"amount" => 0, "balance_name" => "uncapped", "qty" => 165681}], "id" => "\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035", "cost" => 0.0, "status" => 400, "quantity" => 165681, "primary_service" => "5G Home X", "allocated_qty" => 165681, "type" => 100, "service_id" => "a72e5f19-6245-4d24-8f69-3bf4bf215895", "connection_surcharge" => 0, "inserted_at" => "2024-01-19T11:35:32+00:00", "updated_at" => "2024-01-19T11:35:32+00:00", "end_time" => "2024-01-19T11:35:00+00:00", "meta" => %{"chargingId" => 375767394, "consumed" => %{"6000" => %{"allocated_cost" => 0, "allocated_qty" => 0, "cost" => 0, "end_time" => "2024-01-19T13:35:00+02:00", "quantity" => 165681, "session_status" => 300, "start_time" => "2024-01-19T13:25:17+02:00", "uncharged" => 0}}, "ipv4_addr" => "10.209.0.26", "oneTimeEvent" => false, "ratType" => "NR", "requestor" => "satest", "resource_id" => "imei-861935050829590", "service_id" => "msisdn-27816699304", "userLocationinfo" => %{"eutraLocation" => nil, "n3gaLocation" => nil, "nrLocation" => %{"ageOfLocationInformation" => nil, "geodeticInformation" => nil, "geographicalInformation" => nil, "globalGnbId" => nil, "ignoreNcgi" => nil, "ncgi" => %{"nid" => nil, "nrCellId" => "0d1414033", "plmnId" => %{"mcc" => "655", "mnc" => "73"}}, "tai" => %{"nid" => nil, "plmnId" => %{"mcc" => "655", "mnc" => "73"}, "tac" => "07F394"}, "ueLocationTimestamp" => "2024-01-19T13:25:15+02:00"}}}, "rating_group" => 6000, "uncharged" => nil, "charged_for" => "Unlimited home 5G Premium", "rg_meta" => %{"mode" => "ONLINE", "sessionFailover" => "FAILOVER_NOT_SUPPORTED"}, "start_time" => "2024-01-19T11:25:18+00:00", "c_id" => "20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2", "rounding_policy" => "1.110000", "unit_rate" => 0, "sub_id" => "imsi-655730000598400", "cr_id" => "20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2", "tp_meta" => %{"default_quota" => %{"name" => "totalVolume", "quota" => 57982058496}, "final_unit" => %{"finalUnitAction" => "TERMINATE"}, "model" => "POST-PAID", "neg_balances" => false, "policy_states" => ["High Speed", "RICA", "Device", "Payment", "PAYMENT_HOLD"], "quota_calc" => "default", "quota_rules" => [], "unit_info" => %{"quotaHoldingTime" => 0, "timeQuotaThreshold" => 70, "triggers" => [%{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_THRESHOLD"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_EXHAUSTED"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QHT"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "VALIDITY_TIME"}], "unitQuotaThreshold" => 80, "validityTime" => 43200}, "vqt_percentage" => 0.4}, "requestor_node_id" => "trc_udg_upf_01", "requestor_service_id" => nil, "item_seq_num" => 1, "applies_to" => %{"balances" => ["uncapped"], "service_type" => "mobile_data"}, "description" => nil, "unit" => %{"downlinkVolume" => 0, "eventTimeStamp" => nil, "serviceSpecificUnits" => nil, "time" => nil, "totalVolume" => 165681, "triggerTimestamp" => "2024-01-19T13:35:01+02:00", "triggers" => [%{"maxNumberOfccc" => nil, "timeLimit" => nil, "triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "FINAL", "volumeLimit" => nil, "volumeLimit64" => nil}], "uplinkVolume" => 165681}, "post_surcharge" => 0, "tariff_plan" => "5G Home X", "taxes" => %{"fixed" => 0, "gl" => "9500A030", "name" => "VAT", "percentage" => 15, "tax_amount" => 0.0, "tax_inclusive_amount" => 0.0, "taxable_amount" => 0}, "allocated_cost" => 0.0, "error" => nil}
19:35:12.447 [error] client :kaffe_producer_client failed to connect to kafka3:9092
reason:{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:35:12.448 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:35:12.727 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:35:12.728 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:35:13.011 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:35:13.012 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:35:13.293 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:35:13.294 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:35:14.607 [error] client :kaffe_producer_client failed to connect to kafka3:9092
reason:{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:35:14.609 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:35:14.889 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:35:14.890 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
19:35:14.891 [error] GenServer #PID<0.603.0> terminating
** (stop) {:reached_max_retries, :no_leader_connection}
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer_buffer.erl:312: :brod_producer_buffer.rebuffer_or_crash/3
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer_buffer.erl:296: :brod_producer_buffer.do_send/4
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer.erl:525: :brod_producer.maybe_produce/1
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer.erl:325: :brod_producer.handle_info/2
    (stdlib 5.1.1) gen_server.erl:1077: :gen_server.try_handle_info/3
    (stdlib 5.1.1) gen_server.erl:1165: :gen_server.handle_msg/6
    (stdlib 5.1.1) proc_lib.erl:241: :proc_lib.init_p_do_apply/3
Last message: :retry
State: {:state, #PID<0.253.0>, "kafka-topic-test", 0, :undefined, :undefined, {:buf, 512, 1, 1048576, 5, 0, 0, {&:brod_producer.do_send_fun/4, {"kafka-topic-test", 0, 1, 1000, :gzip}}, 1, 0, {[], []}, {[], []}, []}, 100, #Reference<0.215834250.2619867137.156532>, :undefined, {:default, 0}}
19:35:14.892 [info] Sent 1 messages to topic kafka-topic-test in 3669 ms
19:35:14.893 [info] Sent messages to topic kafka-topic-test in "{\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"charged_to\":[{\"amount\":0,\"balance_name\":\"uncapped\",\"qty\":165681}],\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"cost\":0.0,\"status\":400,\"quantity\":165681,\"primary_service\":\"5G Home X\",\"allocated_qty\":165681,\"type\":100,\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\",\"connection_surcharge\":0,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"end_time\":\"2024-01-19T11:35:00+00:00\",\"meta\":{\"chargingId\":375767394,\"consumed\":{\"6000\":{\"allocated_cost\":0,\"allocated_qty\":0,\"cost\":0,\"end_time\":\"2024-01-19T13:35:00+02:00\",\"quantity\":165681,\"session_status\":300,\"start_time\":\"2024-01-19T13:25:17+02:00\",\"uncharged\":0}},\"ipv4_addr\":\"10.209.0.26\",\"oneTimeEvent\":false,\"ratType\":\"NR\",\"requestor\":\"satest\",\"resource_id\":\"imei-861935050829590\",\"service_id\":\"msisdn-27816699304\",\"userLocationinfo\":{\"eutraLocation\":null,\"n3gaLocation\":null,\"nrLocation\":{\"ageOfLocationInformation\":null,\"geodeticInformation\":null,\"geographicalInformation\":null,\"globalGnbId\":null,\"ignoreNcgi\":null,\"ncgi\":{\"nid\":null,\"nrCellId\":\"0d1414033\",\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"}},\"tai\":{\"nid\":null,\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"},\"tac\":\"07F394\"},\"ueLocationTimestamp\":\"2024-01-19T13:25:15+02:00\"}}},\"rating_group\":6000,\"uncharged\":null,\"charged_for\":\"Unlimited home 5G Premium\",\"rg_meta\":{\"mode\":\"ONLINE\",\"sessionFailover\":\"FAILOVER_NOT_SUPPORTED\"},\"start_time\":\"2024-01-19T11:25:18+00:00\",\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"rounding_policy\":\"1.110000\",\"unit_rate\":0,\"sub_id\":\"imsi-655730000598400\",\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"tp_meta\":{\"default_quota\":{\"name\":\"totalVolume\",\"quota\":57982058496},\"final_unit\":{\"finalUnitAction\":\"TERMINATE\"},\"model\":\"POST-PAID\",\"neg_balances\":false,\"policy_states\":[\"High Speed\",\"RICA\",\"Device\",\"Payment\",\"PAYMENT_HOLD\"],\"quota_calc\":\"default\",\"quota_rules\":[],\"unit_info\":{\"quotaHoldingTime\":0,\"timeQuotaThreshold\":70,\"triggers\":[{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_THRESHOLD\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_EXHAUSTED\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QHT\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"VALIDITY_TIME\"}],\"unitQuotaThreshold\":80,\"validityTime\":43200},\"vqt_percentage\":0.4},\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"item_seq_num\":1,\"applies_to\":{\"balances\":[\"uncapped\"],\"service_type\":\"mobile_data\"},\"description\":null,\"unit\":{\"downlinkVolume\":0,\"eventTimeStamp\":null,\"serviceSpecificUnits\":null,\"time\":null,\"totalVolume\":165681,\"triggerTimestamp\":\"2024-01-19T13:35:01+02:00\",\"triggers\":[{\"maxNumberOfccc\":null,\"timeLimit\":null,\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"FINAL\",\"volumeLimit\":null,\"volumeLimit64\":null}],\"uplinkVolume\":165681},\"post_surcharge\":0,\"tariff_plan\":\"5G Home X\",\"taxes\":{\"fixed\":0,\"gl\":\"9500A030\",\"name\":\"VAT\",\"percentage\":15,\"tax_amount\":0.0,\"tax_inclusive_amount\":0.0,\"taxable_amount\":0},\"allocated_cost\":0.0,\"error\":null}"
19:35:14.893 [info] Sent 1 messages to topic kafka-topic-test in 3669 ms
19:35:19.893 [info]     :supervisor: {#PID<0.582.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.612.0>,
  id: 0,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     0,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :gzip,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
19:54:22.639 [info]     :supervisor: {:local, :brod_sup}
    :started: [
  pid: #PID<0.253.0>,
  id: :kaffe_producer_client,
  mfargs: {:brod_client, :start_link,
   [
     [{~c"13.40.7.67", 9092}],
     :kaffe_producer_client,
     [
       auto_start_producers: true,
       allow_topic_auto_creation: false,
       default_producer_config: [
         required_acks: 1,
         ack_timeout: 1000,
         partition_buffer_limit: 512,
         partition_onwire_limit: 1,
         max_batch_size: 1048576,
         max_retries: 5,
         retry_backoff_ms: 100,
         compression: :gzip,
         min_compression_batch_size: 1024
       ]
     ]
   ]},
  restart_type: {:permanent, 10},
  shutdown: 5000,
  child_type: :worker
]
19:54:23.858 [info] Running KafkaClusterWeb.Endpoint with cowboy 2.12.0 at 0.0.0.0:4080 (http)
19:54:23.865 [info] Access KafkaClusterWeb.Endpoint at http://localhost:4080
19:54:23.955 [info] Thoma
19:54:32.820 [info] Payload :: "{\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"allocated_cost\":0.0,\"uncharged\":null,\"allocated_qty\":165681,\"applies_to\":{\"balances\": [\"uncapped\"], \"service_type\": \"mobile_data\"},\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"charged_for\":\"Unlimited home 5G Premium\",\"charged_to\":[{\"qty\": 165681, \"amount\": 0, \"balance_name\": \"uncapped\"}],\"connection_surcharge\":0,\"cost\":0.0,\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"description\":null,\"end_time\":\"2024-01-19T11:35:00+00:00\",\"item_seq_num\":1,\"meta\":{\"ratType\": \"NR\", \"consumed\": {\"6000\": {\"cost\": 0, \"end_time\": \"2024-01-19T13:35:00+02:00\", \"quantity\": 165681, \"uncharged\": 0, \"start_time\": \"2024-01-19T13:25:17+02:00\", \"allocated_qty\": 0, \"allocated_cost\": 0, \"session_status\": 300}}, \"ipv4_addr\": \"10.209.0.26\", \"requestor\": \"satest\", \"chargingId\": 375767394, \"service_id\": \"msisdn-27816699304\", \"resource_id\": \"imei-861935050829590\", \"oneTimeEvent\": false, \"userLocationinfo\": {\"nrLocation\": {\"tai\": {\"nid\": null, \"tac\": \"07F394\", \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}}, \"ncgi\": {\"nid\": null, \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}, \"nrCellId\": \"0d1414033\"}, \"ignoreNcgi\": null, \"globalGnbId\": null, \"geodeticInformation\": null, \"ueLocationTimestamp\": \"2024-01-19T13:25:15+02:00\", \"geographicalInformation\": null, \"ageOfLocationInformation\": null}, \"n3gaLocation\": null, \"eutraLocation\": null}},\"post_surcharge\":0,\"primary_service\":\"5G Home X\",\"quantity\":165681,\"rating_group\":6000,\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"rg_meta\":{\"mode\": \"ONLINE\", \"sessionFailover\": \"FAILOVER_NOT_SUPPORTED\"},\"rounding_policy\":\"1.110000\",\"start_time\":\"2024-01-19T11:25:18+00:00\",\"status\":400,\"sub_id\":\"imsi-655730000598400\",\"tariff_plan\":\"5G Home X\",\"taxes\":{\"gl\": \"9500A030\", \"name\": \"VAT\", \"fixed\": 0, \"percentage\": 15, \"tax_amount\": 0.0, \"taxable_amount\": 0, \"tax_inclusive_amount\": 0.0},\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"tp_meta\":{\"model\": \"POST-PAID\", \"unit_info\": {\"triggers\": [{\"triggerType\": \"QUOTA_THRESHOLD\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QUOTA_EXHAUSTED\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QHT\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"VALIDITY_TIME\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"validityTime\": 43200, \"quotaHoldingTime\": 0, \"timeQuotaThreshold\": 70, \"unitQuotaThreshold\": 80}, \"final_unit\": {\"finalUnitAction\": \"TERMINATE\"}, \"quota_calc\": \"default\", \"quota_rules\": [], \"neg_balances\": false, \"default_quota\": {\"name\": \"totalVolume\", \"quota\": 57982058496}, \"policy_states\": [\"High Speed\", \"RICA\", \"Device\", \"Payment\", \"PAYMENT_HOLD\"], \"vqt_percentage\": 0.4},\"type\":100,\"unit\":{\"time\": null, \"triggers\": [{\"timeLimit\": null, \"triggerType\": \"FINAL\", \"volumeLimit\": null, \"volumeLimit64\": null, \"maxNumberOfccc\": null, \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"totalVolume\": 165681, \"uplinkVolume\": 165681, \"downlinkVolume\": 0, \"eventTimeStamp\": null, \"triggerTimestamp\": \"2024-01-19T13:35:01+02:00\", \"serviceSpecificUnits\": null},\"unit_rate\":0,\"error\":null,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\"}"
19:54:32.821 [info] Decoded Payload :: %{"timestamp" => "2024-01-19T11:35:01+00:00", "charged_to" => [%{"amount" => 0, "balance_name" => "uncapped", "qty" => 165681}], "id" => "\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035", "cost" => 0.0, "status" => 400, "quantity" => 165681, "primary_service" => "5G Home X", "allocated_qty" => 165681, "type" => 100, "service_id" => "a72e5f19-6245-4d24-8f69-3bf4bf215895", "connection_surcharge" => 0, "inserted_at" => "2024-01-19T11:35:32+00:00", "updated_at" => "2024-01-19T11:35:32+00:00", "end_time" => "2024-01-19T11:35:00+00:00", "meta" => %{"chargingId" => 375767394, "consumed" => %{"6000" => %{"allocated_cost" => 0, "allocated_qty" => 0, "cost" => 0, "end_time" => "2024-01-19T13:35:00+02:00", "quantity" => 165681, "session_status" => 300, "start_time" => "2024-01-19T13:25:17+02:00", "uncharged" => 0}}, "ipv4_addr" => "10.209.0.26", "oneTimeEvent" => false, "ratType" => "NR", "requestor" => "satest", "resource_id" => "imei-861935050829590", "service_id" => "msisdn-27816699304", "userLocationinfo" => %{"eutraLocation" => nil, "n3gaLocation" => nil, "nrLocation" => %{"ageOfLocationInformation" => nil, "geodeticInformation" => nil, "geographicalInformation" => nil, "globalGnbId" => nil, "ignoreNcgi" => nil, "ncgi" => %{"nid" => nil, "nrCellId" => "0d1414033", "plmnId" => %{"mcc" => "655", "mnc" => "73"}}, "tai" => %{"nid" => nil, "plmnId" => %{"mcc" => "655", "mnc" => "73"}, "tac" => "07F394"}, "ueLocationTimestamp" => "2024-01-19T13:25:15+02:00"}}}, "rating_group" => 6000, "uncharged" => nil, "charged_for" => "Unlimited home 5G Premium", "rg_meta" => %{"mode" => "ONLINE", "sessionFailover" => "FAILOVER_NOT_SUPPORTED"}, "start_time" => "2024-01-19T11:25:18+00:00", "c_id" => "20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2", "rounding_policy" => "1.110000", "unit_rate" => 0, "sub_id" => "imsi-655730000598400", "cr_id" => "20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2", "tp_meta" => %{"default_quota" => %{"name" => "totalVolume", "quota" => 57982058496}, "final_unit" => %{"finalUnitAction" => "TERMINATE"}, "model" => "POST-PAID", "neg_balances" => false, "policy_states" => ["High Speed", "RICA", "Device", "Payment", "PAYMENT_HOLD"], "quota_calc" => "default", "quota_rules" => [], "unit_info" => %{"quotaHoldingTime" => 0, "timeQuotaThreshold" => 70, "triggers" => [%{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_THRESHOLD"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_EXHAUSTED"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QHT"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "VALIDITY_TIME"}], "unitQuotaThreshold" => 80, "validityTime" => 43200}, "vqt_percentage" => 0.4}, "requestor_node_id" => "trc_udg_upf_01", "requestor_service_id" => nil, "item_seq_num" => 1, "applies_to" => %{"balances" => ["uncapped"], "service_type" => "mobile_data"}, "description" => nil, "unit" => %{"downlinkVolume" => 0, "eventTimeStamp" => nil, "serviceSpecificUnits" => nil, "time" => nil, "totalVolume" => 165681, "triggerTimestamp" => "2024-01-19T13:35:01+02:00", "triggers" => [%{"maxNumberOfccc" => nil, "timeLimit" => nil, "triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "FINAL", "volumeLimit" => nil, "volumeLimit64" => nil}], "uplinkVolume" => 165681}, "post_surcharge" => 0, "tariff_plan" => "5G Home X", "taxes" => %{"fixed" => 0, "gl" => "9500A030", "name" => "VAT", "percentage" => 15, "tax_amount" => 0.0, "tax_inclusive_amount" => 0.0, "taxable_amount" => 0}, "allocated_cost" => 0.0, "error" => nil}
19:54:33.066 [error] GenServer KafkaCluster.Kaffe.ChargeListener terminating
** (FunctionClauseError) no function clause matching in Kaffe.Producer.choose_partition/5
    (kaffe 1.25.0) lib/kaffe/producer.ex:212: Kaffe.Producer.choose_partition("kafka-topic-test", 3, "charge_key", "{\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"charged_to\":[{\"amount\":0,\"balance_name\":\"uncapped\",\"qty\":165681}],\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"cost\":0.0,\"status\":400,\"quantity\":165681,\"primary_service\":\"5G Home X\",\"allocated_qty\":165681,\"type\":100,\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\",\"connection_surcharge\":0,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"end_time\":\"2024-01-19T11:35:00+00:00\",\"meta\":{\"chargingId\":375767394,\"consumed\":{\"6000\":{\"allocated_cost\":0,\"allocated_qty\":0,\"cost\":0,\"end_time\":\"2024-01-19T13:35:00+02:00\",\"quantity\":165681,\"session_status\":300,\"start_time\":\"2024-01-19T13:25:17+02:00\",\"uncharged\":0}},\"ipv4_addr\":\"10.209.0.26\",\"oneTimeEvent\":false,\"ratType\":\"NR\",\"requestor\":\"satest\",\"resource_id\":\"imei-861935050829590\",\"service_id\":\"msisdn-27816699304\",\"userLocationinfo\":{\"eutraLocation\":null,\"n3gaLocation\":null,\"nrLocation\":{\"ageOfLocationInformation\":null,\"geodeticInformation\":null,\"geographicalInformation\":null,\"globalGnbId\":null,\"ignoreNcgi\":null,\"ncgi\":{\"nid\":null,\"nrCellId\":\"0d1414033\",\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"}},\"tai\":{\"nid\":null,\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"},\"tac\":\"07F394\"},\"ueLocationTimestamp\":\"2024-01-19T13:25:15+02:00\"}}},\"rating_group\":6000,\"uncharged\":null,\"charged_for\":\"Unlimited home 5G Premium\",\"rg_meta\":{\"mode\":\"ONLINE\",\"sessionFailover\":\"FAILOVER_NOT_SUPPORTED\"},\"start_time\":\"2024-01-19T11:25:18+00:00\",\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"rounding_policy\":\"1.110000\",\"unit_rate\":0,\"sub_id\":\"imsi-655730000598400\",\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"tp_meta\":{\"default_quota\":{\"name\":\"totalVolume\",\"quota\":57982058496},\"final_unit\":{\"finalUnitAction\":\"TERMINATE\"},\"model\":\"POST-PAID\",\"neg_balances\":false,\"policy_states\":[\"High Speed\",\"RICA\",\"Device\",\"Payment\",\"PAYMENT_HOLD\"],\"quota_calc\":\"default\",\"quota_rules\":[],\"unit_info\":{\"quotaHoldingTime\":0,\"timeQuotaThreshold\":70,\"triggers\":[{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_THRESHOLD\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_EXHAUSTED\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QHT\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"VALIDITY_TIME\"}],\"unitQuotaThreshold\":80,\"validityTime\":43200},\"vqt_percentage\":0.4},\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"item_seq_num\":1,\"applies_to\":{\"balances\":[\"uncapped\"],\"service_type\":\"mobile_data\"},\"description\":null,\"unit\":{\"downlinkVolume\":0,\"eventTimeStamp\":null,\"serviceSpecificUnits\":null,\"time\":null,\"totalVolume\":165681,\"triggerTimestamp\":\"2024-01-19T13:35:01+02:00\",\"triggers\":[{\"maxNumberOfccc\":null,\"timeLimit\":null,\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"FINAL\",\"volumeLimit\":null,\"volumeLimit64\":null}],\"uplinkVolume\":165681},\"post_surcharge\":0,\"tariff_plan\":\"5G Home X\",\"taxes\":{\"fixed\":0,\"gl\":\"9500A030\",\"name\":\"VAT\",\"percentage\":15,\"tax_amount\":0.0,\"tax_inclusive_amount\":0.0,\"taxable_amount\":0},\"allocated_cost\":0.0,\"error\":null}", :round_robin)
    (elixir 1.16.0-rc.0) lib/enum.ex:1414: anonymous fn/4 in Enum.group_by/3
    (elixir 1.16.0-rc.0) lib/enum.ex:2528: Enum."-group_by/3-lists^foldl/2-0-"/3
    (kaffe 1.25.0) lib/kaffe/producer.ex:140: Kaffe.Producer.produce_list/3
    (elixir 1.16.0-rc.0) lib/enum.ex:992: anonymous fn/3 in Enum.each/2
    (elixir 1.16.0-rc.0) lib/enum.ex:4391: Enum.reduce_range/5
    (elixir 1.16.0-rc.0) lib/enum.ex:2532: Enum.each/2
    (kafka_cluster 0.1.0) lib/kafka_cluster/kaffe/producer.ex:12: KafkaCluster.Kaffe.Producer.send_my_message/3
    (kafka_cluster 0.1.0) lib/kafka_cluster/kaffe/charge_listener.ex:33: KafkaCluster.Kaffe.ChargeListener.handle_info/2
    (stdlib 5.1.1) gen_server.erl:1077: :gen_server.try_handle_info/3
    (stdlib 5.1.1) gen_server.erl:1165: :gen_server.handle_msg/6
    (stdlib 5.1.1) proc_lib.erl:241: :proc_lib.init_p_do_apply/3
Last message: {:notification, #PID<0.567.0>, #Reference<0.3350587998.1817444354.15793>, "new_charge", "{\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"allocated_cost\":0.0,\"uncharged\":null,\"allocated_qty\":165681,\"applies_to\":{\"balances\": [\"uncapped\"], \"service_type\": \"mobile_data\"},\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"charged_for\":\"Unlimited home 5G Premium\",\"charged_to\":[{\"qty\": 165681, \"amount\": 0, \"balance_name\": \"uncapped\"}],\"connection_surcharge\":0,\"cost\":0.0,\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"description\":null,\"end_time\":\"2024-01-19T11:35:00+00:00\",\"item_seq_num\":1,\"meta\":{\"ratType\": \"NR\", \"consumed\": {\"6000\": {\"cost\": 0, \"end_time\": \"2024-01-19T13:35:00+02:00\", \"quantity\": 165681, \"uncharged\": 0, \"start_time\": \"2024-01-19T13:25:17+02:00\", \"allocated_qty\": 0, \"allocated_cost\": 0, \"session_status\": 300}}, \"ipv4_addr\": \"10.209.0.26\", \"requestor\": \"satest\", \"chargingId\": 375767394, \"service_id\": \"msisdn-27816699304\", \"resource_id\": \"imei-861935050829590\", \"oneTimeEvent\": false, \"userLocationinfo\": {\"nrLocation\": {\"tai\": {\"nid\": null, \"tac\": \"07F394\", \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}}, \"ncgi\": {\"nid\": null, \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}, \"nrCellId\": \"0d1414033\"}, \"ignoreNcgi\": null, \"globalGnbId\": null, \"geodeticInformation\": null, \"ueLocationTimestamp\": \"2024-01-19T13:25:15+02:00\", \"geographicalInformation\": null, \"ageOfLocationInformation\": null}, \"n3gaLocation\": null, \"eutraLocation\": null}},\"post_surcharge\":0,\"primary_service\":\"5G Home X\",\"quantity\":165681,\"rating_group\":6000,\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"rg_meta\":{\"mode\": \"ONLINE\", \"sessionFailover\": \"FAILOVER_NOT_SUPPORTED\"},\"rounding_policy\":\"1.110000\",\"start_time\":\"2024-01-19T11:25:18+00:00\",\"status\":400,\"sub_id\":\"imsi-655730000598400\",\"tariff_plan\":\"5G Home X\",\"taxes\":{\"gl\": \"9500A030\", \"name\": \"VAT\", \"fixed\": 0, \"percentage\": 15, \"tax_amount\": 0.0, \"taxable_amount\": 0, \"tax_inclusive_amount\": 0.0},\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"tp_meta\":{\"model\": \"POST-PAID\", \"unit_info\": {\"triggers\": [{\"triggerType\": \"QUOTA_THRESHOLD\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QUOTA_EXHAUSTED\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QHT\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"VALIDITY_TIME\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"validityTime\": 43200, \"quotaHoldingTime\": 0, \"timeQuotaThreshold\": 70, \"unitQuotaThreshold\": 80}, \"final_unit\": {\"finalUnitAction\": \"TERMINATE\"}, \"quota_calc\": \"default\", \"quota_rules\": [], \"neg_balances\": false, \"default_quota\": {\"name\": \"totalVolume\", \"quota\": 57982058496}, \"policy_states\": [\"High Speed\", \"RICA\", \"Device\", \"Payment\", \"PAYMENT_HOLD\"], \"vqt_percentage\": 0.4},\"type\":100,\"unit\":{\"time\": null, \"triggers\": [{\"timeLimit\": null, \"triggerType\": \"FINAL\", \"volumeLimit\": null, \"volumeLimit64\": null, \"maxNumberOfccc\": null, \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"totalVolume\": 165681, \"uplinkVolume\": 165681, \"downlinkVolume\": 0, \"eventTimeStamp\": null, \"triggerTimestamp\": \"2024-01-19T13:35:01+02:00\", \"serviceSpecificUnits\": null},\"unit_rate\":0,\"error\":nul (truncated)
19:54:33.567 [info] Thoma
21:48:34.333 [info]     :supervisor: {:local, :brod_sup}
    :started: [
  pid: #PID<0.253.0>,
  id: :kaffe_producer_client,
  mfargs: {:brod_client, :start_link,
   [
     [{~c"13.40.7.67", 9092}],
     :kaffe_producer_client,
     [
       auto_start_producers: true,
       allow_topic_auto_creation: false,
       default_producer_config: [
         required_acks: 1,
         ack_timeout: 1000,
         partition_buffer_limit: 512,
         partition_onwire_limit: 1,
         max_batch_size: 1048576,
         max_retries: 5,
         retry_backoff_ms: 100,
         compression: :gzip,
         min_compression_batch_size: 1024
       ]
     ]
   ]},
  restart_type: {:permanent, 10},
  shutdown: 5000,
  child_type: :worker
]
21:48:37.127 [info] Running KafkaClusterWeb.Endpoint with cowboy 2.12.0 at 0.0.0.0:4080 (http)
21:48:37.138 [info] Access KafkaClusterWeb.Endpoint at http://localhost:4080
21:48:37.355 [info] Thoma
21:48:44.558 [info] Payload :: "{\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"allocated_cost\":0.0,\"uncharged\":null,\"allocated_qty\":165681,\"applies_to\":{\"balances\": [\"uncapped\"], \"service_type\": \"mobile_data\"},\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"charged_for\":\"Unlimited home 5G Premium\",\"charged_to\":[{\"qty\": 165681, \"amount\": 0, \"balance_name\": \"uncapped\"}],\"connection_surcharge\":0,\"cost\":0.0,\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"description\":null,\"end_time\":\"2024-01-19T11:35:00+00:00\",\"item_seq_num\":1,\"meta\":{\"ratType\": \"NR\", \"consumed\": {\"6000\": {\"cost\": 0, \"end_time\": \"2024-01-19T13:35:00+02:00\", \"quantity\": 165681, \"uncharged\": 0, \"start_time\": \"2024-01-19T13:25:17+02:00\", \"allocated_qty\": 0, \"allocated_cost\": 0, \"session_status\": 300}}, \"ipv4_addr\": \"10.209.0.26\", \"requestor\": \"satest\", \"chargingId\": 375767394, \"service_id\": \"msisdn-27816699304\", \"resource_id\": \"imei-861935050829590\", \"oneTimeEvent\": false, \"userLocationinfo\": {\"nrLocation\": {\"tai\": {\"nid\": null, \"tac\": \"07F394\", \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}}, \"ncgi\": {\"nid\": null, \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}, \"nrCellId\": \"0d1414033\"}, \"ignoreNcgi\": null, \"globalGnbId\": null, \"geodeticInformation\": null, \"ueLocationTimestamp\": \"2024-01-19T13:25:15+02:00\", \"geographicalInformation\": null, \"ageOfLocationInformation\": null}, \"n3gaLocation\": null, \"eutraLocation\": null}},\"post_surcharge\":0,\"primary_service\":\"5G Home X\",\"quantity\":165681,\"rating_group\":6000,\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"rg_meta\":{\"mode\": \"ONLINE\", \"sessionFailover\": \"FAILOVER_NOT_SUPPORTED\"},\"rounding_policy\":\"1.110000\",\"start_time\":\"2024-01-19T11:25:18+00:00\",\"status\":400,\"sub_id\":\"imsi-655730000598400\",\"tariff_plan\":\"5G Home X\",\"taxes\":{\"gl\": \"9500A030\", \"name\": \"VAT\", \"fixed\": 0, \"percentage\": 15, \"tax_amount\": 0.0, \"taxable_amount\": 0, \"tax_inclusive_amount\": 0.0},\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"tp_meta\":{\"model\": \"POST-PAID\", \"unit_info\": {\"triggers\": [{\"triggerType\": \"QUOTA_THRESHOLD\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QUOTA_EXHAUSTED\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QHT\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"VALIDITY_TIME\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"validityTime\": 43200, \"quotaHoldingTime\": 0, \"timeQuotaThreshold\": 70, \"unitQuotaThreshold\": 80}, \"final_unit\": {\"finalUnitAction\": \"TERMINATE\"}, \"quota_calc\": \"default\", \"quota_rules\": [], \"neg_balances\": false, \"default_quota\": {\"name\": \"totalVolume\", \"quota\": 57982058496}, \"policy_states\": [\"High Speed\", \"RICA\", \"Device\", \"Payment\", \"PAYMENT_HOLD\"], \"vqt_percentage\": 0.4},\"type\":100,\"unit\":{\"time\": null, \"triggers\": [{\"timeLimit\": null, \"triggerType\": \"FINAL\", \"volumeLimit\": null, \"volumeLimit64\": null, \"maxNumberOfccc\": null, \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"totalVolume\": 165681, \"uplinkVolume\": 165681, \"downlinkVolume\": 0, \"eventTimeStamp\": null, \"triggerTimestamp\": \"2024-01-19T13:35:01+02:00\", \"serviceSpecificUnits\": null},\"unit_rate\":0,\"error\":null,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\"}"
21:48:44.560 [info] Decoded Payload :: %{"timestamp" => "2024-01-19T11:35:01+00:00", "charged_to" => [%{"amount" => 0, "balance_name" => "uncapped", "qty" => 165681}], "id" => "\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035", "cost" => 0.0, "status" => 400, "quantity" => 165681, "primary_service" => "5G Home X", "allocated_qty" => 165681, "type" => 100, "service_id" => "a72e5f19-6245-4d24-8f69-3bf4bf215895", "connection_surcharge" => 0, "inserted_at" => "2024-01-19T11:35:32+00:00", "updated_at" => "2024-01-19T11:35:32+00:00", "end_time" => "2024-01-19T11:35:00+00:00", "meta" => %{"chargingId" => 375767394, "consumed" => %{"6000" => %{"allocated_cost" => 0, "allocated_qty" => 0, "cost" => 0, "end_time" => "2024-01-19T13:35:00+02:00", "quantity" => 165681, "session_status" => 300, "start_time" => "2024-01-19T13:25:17+02:00", "uncharged" => 0}}, "ipv4_addr" => "10.209.0.26", "oneTimeEvent" => false, "ratType" => "NR", "requestor" => "satest", "resource_id" => "imei-861935050829590", "service_id" => "msisdn-27816699304", "userLocationinfo" => %{"eutraLocation" => nil, "n3gaLocation" => nil, "nrLocation" => %{"ageOfLocationInformation" => nil, "geodeticInformation" => nil, "geographicalInformation" => nil, "globalGnbId" => nil, "ignoreNcgi" => nil, "ncgi" => %{"nid" => nil, "nrCellId" => "0d1414033", "plmnId" => %{"mcc" => "655", "mnc" => "73"}}, "tai" => %{"nid" => nil, "plmnId" => %{"mcc" => "655", "mnc" => "73"}, "tac" => "07F394"}, "ueLocationTimestamp" => "2024-01-19T13:25:15+02:00"}}}, "rating_group" => 6000, "uncharged" => nil, "charged_for" => "Unlimited home 5G Premium", "rg_meta" => %{"mode" => "ONLINE", "sessionFailover" => "FAILOVER_NOT_SUPPORTED"}, "start_time" => "2024-01-19T11:25:18+00:00", "c_id" => "20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2", "rounding_policy" => "1.110000", "unit_rate" => 0, "sub_id" => "imsi-655730000598400", "cr_id" => "20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2", "tp_meta" => %{"default_quota" => %{"name" => "totalVolume", "quota" => 57982058496}, "final_unit" => %{"finalUnitAction" => "TERMINATE"}, "model" => "POST-PAID", "neg_balances" => false, "policy_states" => ["High Speed", "RICA", "Device", "Payment", "PAYMENT_HOLD"], "quota_calc" => "default", "quota_rules" => [], "unit_info" => %{"quotaHoldingTime" => 0, "timeQuotaThreshold" => 70, "triggers" => [%{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_THRESHOLD"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_EXHAUSTED"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QHT"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "VALIDITY_TIME"}], "unitQuotaThreshold" => 80, "validityTime" => 43200}, "vqt_percentage" => 0.4}, "requestor_node_id" => "trc_udg_upf_01", "requestor_service_id" => nil, "item_seq_num" => 1, "applies_to" => %{"balances" => ["uncapped"], "service_type" => "mobile_data"}, "description" => nil, "unit" => %{"downlinkVolume" => 0, "eventTimeStamp" => nil, "serviceSpecificUnits" => nil, "time" => nil, "totalVolume" => 165681, "triggerTimestamp" => "2024-01-19T13:35:01+02:00", "triggers" => [%{"maxNumberOfccc" => nil, "timeLimit" => nil, "triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "FINAL", "volumeLimit" => nil, "volumeLimit64" => nil}], "uplinkVolume" => 165681}, "post_surcharge" => 0, "tariff_plan" => "5G Home X", "taxes" => %{"fixed" => 0, "gl" => "9500A030", "name" => "VAT", "percentage" => 15, "tax_amount" => 0.0, "tax_inclusive_amount" => 0.0, "taxable_amount" => 0}, "allocated_cost" => 0.0, "error" => nil}
21:48:44.794 [info]     :supervisor: {#PID<0.360.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.582.0>,
  id: "kafka-topic-test",
  mfargs: {:supervisor3, :start_link,
   [
     :brod_producers_sup,
     {:brod_producers_sup2, #PID<0.253.0>, "kafka-topic-test",
      [
        required_acks: 1,
        ack_timeout: 1000,
        partition_buffer_limit: 512,
        partition_onwire_limit: 1,
        max_batch_size: 1048576,
        max_retries: 5,
        retry_backoff_ms: 100,
        compression: :gzip,
        min_compression_batch_size: 1024
      ]}
   ]},
  restart_type: {:permanent, 10},
  shutdown: :infinity,
  child_type: :supervisor
]
21:48:44.825 [info]     :supervisor: {#PID<0.582.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.583.0>,
  id: 0,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     0,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :gzip,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
21:48:44.827 [info]     :supervisor: {#PID<0.582.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.584.0>,
  id: 1,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     1,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :gzip,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
21:48:44.829 [info]     :supervisor: {#PID<0.582.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.585.0>,
  id: 2,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     2,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :gzip,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
21:48:46.097 [error] client :kaffe_producer_client failed to connect to kafka3:9092
reason:{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:48:46.102 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:48:46.441 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:48:46.442 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:48:46.767 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:48:46.768 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:48:47.053 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:48:47.055 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:48:48.396 [error] client :kaffe_producer_client failed to connect to kafka3:9092
reason:{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:48:48.401 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:48:48.688 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:48:48.689 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:48:48.690 [error] GenServer #PID<0.583.0> terminating
** (stop) {:reached_max_retries, :no_leader_connection}
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer_buffer.erl:312: :brod_producer_buffer.rebuffer_or_crash/3
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer_buffer.erl:296: :brod_producer_buffer.do_send/4
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer.erl:525: :brod_producer.maybe_produce/1
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer.erl:325: :brod_producer.handle_info/2
    (stdlib 5.1.1) gen_server.erl:1077: :gen_server.try_handle_info/3
    (stdlib 5.1.1) gen_server.erl:1165: :gen_server.handle_msg/6
    (stdlib 5.1.1) proc_lib.erl:241: :proc_lib.init_p_do_apply/3
Last message: :retry
State: {:state, #PID<0.253.0>, "kafka-topic-test", 0, :undefined, :undefined, {:buf, 512, 1, 1048576, 5, 0, 0, {&:brod_producer.do_send_fun/4, {"kafka-topic-test", 0, 1, 1000, :gzip}}, 1, 0, {[], []}, {[], []}, []}, 100, #Reference<0.3808617262.2103967745.215944>, :undefined, {:default, 0}}
21:48:48.709 [info] Sent 1 messages to topic kafka-topic-test in 4127 ms
21:48:48.711 [info] Sent messages to topic kafka-topic-test in "{\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"charged_to\":[{\"amount\":0,\"balance_name\":\"uncapped\",\"qty\":165681}],\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"cost\":0.0,\"status\":400,\"quantity\":165681,\"primary_service\":\"5G Home X\",\"allocated_qty\":165681,\"type\":100,\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\",\"connection_surcharge\":0,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"end_time\":\"2024-01-19T11:35:00+00:00\",\"meta\":{\"chargingId\":375767394,\"consumed\":{\"6000\":{\"allocated_cost\":0,\"allocated_qty\":0,\"cost\":0,\"end_time\":\"2024-01-19T13:35:00+02:00\",\"quantity\":165681,\"session_status\":300,\"start_time\":\"2024-01-19T13:25:17+02:00\",\"uncharged\":0}},\"ipv4_addr\":\"10.209.0.26\",\"oneTimeEvent\":false,\"ratType\":\"NR\",\"requestor\":\"satest\",\"resource_id\":\"imei-861935050829590\",\"service_id\":\"msisdn-27816699304\",\"userLocationinfo\":{\"eutraLocation\":null,\"n3gaLocation\":null,\"nrLocation\":{\"ageOfLocationInformation\":null,\"geodeticInformation\":null,\"geographicalInformation\":null,\"globalGnbId\":null,\"ignoreNcgi\":null,\"ncgi\":{\"nid\":null,\"nrCellId\":\"0d1414033\",\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"}},\"tai\":{\"nid\":null,\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"},\"tac\":\"07F394\"},\"ueLocationTimestamp\":\"2024-01-19T13:25:15+02:00\"}}},\"rating_group\":6000,\"uncharged\":null,\"charged_for\":\"Unlimited home 5G Premium\",\"rg_meta\":{\"mode\":\"ONLINE\",\"sessionFailover\":\"FAILOVER_NOT_SUPPORTED\"},\"start_time\":\"2024-01-19T11:25:18+00:00\",\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"rounding_policy\":\"1.110000\",\"unit_rate\":0,\"sub_id\":\"imsi-655730000598400\",\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"tp_meta\":{\"default_quota\":{\"name\":\"totalVolume\",\"quota\":57982058496},\"final_unit\":{\"finalUnitAction\":\"TERMINATE\"},\"model\":\"POST-PAID\",\"neg_balances\":false,\"policy_states\":[\"High Speed\",\"RICA\",\"Device\",\"Payment\",\"PAYMENT_HOLD\"],\"quota_calc\":\"default\",\"quota_rules\":[],\"unit_info\":{\"quotaHoldingTime\":0,\"timeQuotaThreshold\":70,\"triggers\":[{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_THRESHOLD\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_EXHAUSTED\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QHT\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"VALIDITY_TIME\"}],\"unitQuotaThreshold\":80,\"validityTime\":43200},\"vqt_percentage\":0.4},\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"item_seq_num\":1,\"applies_to\":{\"balances\":[\"uncapped\"],\"service_type\":\"mobile_data\"},\"description\":null,\"unit\":{\"downlinkVolume\":0,\"eventTimeStamp\":null,\"serviceSpecificUnits\":null,\"time\":null,\"totalVolume\":165681,\"triggerTimestamp\":\"2024-01-19T13:35:01+02:00\",\"triggers\":[{\"maxNumberOfccc\":null,\"timeLimit\":null,\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"FINAL\",\"volumeLimit\":null,\"volumeLimit64\":null}],\"uplinkVolume\":165681},\"post_surcharge\":0,\"tariff_plan\":\"5G Home X\",\"taxes\":{\"fixed\":0,\"gl\":\"9500A030\",\"name\":\"VAT\",\"percentage\":15,\"tax_amount\":0.0,\"tax_inclusive_amount\":0.0,\"taxable_amount\":0},\"allocated_cost\":0.0,\"error\":null}"
21:48:48.711 [info] Sent 1 messages to topic kafka-topic-test in 4127 ms
21:48:53.710 [info]     :supervisor: {#PID<0.582.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.594.0>,
  id: 0,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     0,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :gzip,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
21:49:11.721 [info] Payload :: "{\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"allocated_cost\":0.0,\"uncharged\":null,\"allocated_qty\":165681,\"applies_to\":{\"balances\": [\"uncapped\"], \"service_type\": \"mobile_data\"},\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"charged_for\":\"Unlimited home 5G Premium\",\"charged_to\":[{\"qty\": 165681, \"amount\": 0, \"balance_name\": \"uncapped\"}],\"connection_surcharge\":0,\"cost\":0.0,\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"description\":null,\"end_time\":\"2024-01-19T11:35:00+00:00\",\"item_seq_num\":1,\"meta\":{\"ratType\": \"NR\", \"consumed\": {\"6000\": {\"cost\": 0, \"end_time\": \"2024-01-19T13:35:00+02:00\", \"quantity\": 165681, \"uncharged\": 0, \"start_time\": \"2024-01-19T13:25:17+02:00\", \"allocated_qty\": 0, \"allocated_cost\": 0, \"session_status\": 300}}, \"ipv4_addr\": \"10.209.0.26\", \"requestor\": \"satest\", \"chargingId\": 375767394, \"service_id\": \"msisdn-27816699304\", \"resource_id\": \"imei-861935050829590\", \"oneTimeEvent\": false, \"userLocationinfo\": {\"nrLocation\": {\"tai\": {\"nid\": null, \"tac\": \"07F394\", \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}}, \"ncgi\": {\"nid\": null, \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}, \"nrCellId\": \"0d1414033\"}, \"ignoreNcgi\": null, \"globalGnbId\": null, \"geodeticInformation\": null, \"ueLocationTimestamp\": \"2024-01-19T13:25:15+02:00\", \"geographicalInformation\": null, \"ageOfLocationInformation\": null}, \"n3gaLocation\": null, \"eutraLocation\": null}},\"post_surcharge\":0,\"primary_service\":\"5G Home X\",\"quantity\":165681,\"rating_group\":6000,\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"rg_meta\":{\"mode\": \"ONLINE\", \"sessionFailover\": \"FAILOVER_NOT_SUPPORTED\"},\"rounding_policy\":\"1.110000\",\"start_time\":\"2024-01-19T11:25:18+00:00\",\"status\":400,\"sub_id\":\"imsi-655730000598400\",\"tariff_plan\":\"5G Home X\",\"taxes\":{\"gl\": \"9500A030\", \"name\": \"VAT\", \"fixed\": 0, \"percentage\": 15, \"tax_amount\": 0.0, \"taxable_amount\": 0, \"tax_inclusive_amount\": 0.0},\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"tp_meta\":{\"model\": \"POST-PAID\", \"unit_info\": {\"triggers\": [{\"triggerType\": \"QUOTA_THRESHOLD\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QUOTA_EXHAUSTED\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QHT\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"VALIDITY_TIME\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"validityTime\": 43200, \"quotaHoldingTime\": 0, \"timeQuotaThreshold\": 70, \"unitQuotaThreshold\": 80}, \"final_unit\": {\"finalUnitAction\": \"TERMINATE\"}, \"quota_calc\": \"default\", \"quota_rules\": [], \"neg_balances\": false, \"default_quota\": {\"name\": \"totalVolume\", \"quota\": 57982058496}, \"policy_states\": [\"High Speed\", \"RICA\", \"Device\", \"Payment\", \"PAYMENT_HOLD\"], \"vqt_percentage\": 0.4},\"type\":100,\"unit\":{\"time\": null, \"triggers\": [{\"timeLimit\": null, \"triggerType\": \"FINAL\", \"volumeLimit\": null, \"volumeLimit64\": null, \"maxNumberOfccc\": null, \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"totalVolume\": 165681, \"uplinkVolume\": 165681, \"downlinkVolume\": 0, \"eventTimeStamp\": null, \"triggerTimestamp\": \"2024-01-19T13:35:01+02:00\", \"serviceSpecificUnits\": null},\"unit_rate\":0,\"error\":null,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\"}"
21:49:11.724 [info] Decoded Payload :: %{"timestamp" => "2024-01-19T11:35:01+00:00", "charged_to" => [%{"amount" => 0, "balance_name" => "uncapped", "qty" => 165681}], "id" => "\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035", "cost" => 0.0, "status" => 400, "quantity" => 165681, "primary_service" => "5G Home X", "allocated_qty" => 165681, "type" => 100, "service_id" => "a72e5f19-6245-4d24-8f69-3bf4bf215895", "connection_surcharge" => 0, "inserted_at" => "2024-01-19T11:35:32+00:00", "updated_at" => "2024-01-19T11:35:32+00:00", "end_time" => "2024-01-19T11:35:00+00:00", "meta" => %{"chargingId" => 375767394, "consumed" => %{"6000" => %{"allocated_cost" => 0, "allocated_qty" => 0, "cost" => 0, "end_time" => "2024-01-19T13:35:00+02:00", "quantity" => 165681, "session_status" => 300, "start_time" => "2024-01-19T13:25:17+02:00", "uncharged" => 0}}, "ipv4_addr" => "10.209.0.26", "oneTimeEvent" => false, "ratType" => "NR", "requestor" => "satest", "resource_id" => "imei-861935050829590", "service_id" => "msisdn-27816699304", "userLocationinfo" => %{"eutraLocation" => nil, "n3gaLocation" => nil, "nrLocation" => %{"ageOfLocationInformation" => nil, "geodeticInformation" => nil, "geographicalInformation" => nil, "globalGnbId" => nil, "ignoreNcgi" => nil, "ncgi" => %{"nid" => nil, "nrCellId" => "0d1414033", "plmnId" => %{"mcc" => "655", "mnc" => "73"}}, "tai" => %{"nid" => nil, "plmnId" => %{"mcc" => "655", "mnc" => "73"}, "tac" => "07F394"}, "ueLocationTimestamp" => "2024-01-19T13:25:15+02:00"}}}, "rating_group" => 6000, "uncharged" => nil, "charged_for" => "Unlimited home 5G Premium", "rg_meta" => %{"mode" => "ONLINE", "sessionFailover" => "FAILOVER_NOT_SUPPORTED"}, "start_time" => "2024-01-19T11:25:18+00:00", "c_id" => "20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2", "rounding_policy" => "1.110000", "unit_rate" => 0, "sub_id" => "imsi-655730000598400", "cr_id" => "20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2", "tp_meta" => %{"default_quota" => %{"name" => "totalVolume", "quota" => 57982058496}, "final_unit" => %{"finalUnitAction" => "TERMINATE"}, "model" => "POST-PAID", "neg_balances" => false, "policy_states" => ["High Speed", "RICA", "Device", "Payment", "PAYMENT_HOLD"], "quota_calc" => "default", "quota_rules" => [], "unit_info" => %{"quotaHoldingTime" => 0, "timeQuotaThreshold" => 70, "triggers" => [%{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_THRESHOLD"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_EXHAUSTED"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QHT"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "VALIDITY_TIME"}], "unitQuotaThreshold" => 80, "validityTime" => 43200}, "vqt_percentage" => 0.4}, "requestor_node_id" => "trc_udg_upf_01", "requestor_service_id" => nil, "item_seq_num" => 1, "applies_to" => %{"balances" => ["uncapped"], "service_type" => "mobile_data"}, "description" => nil, "unit" => %{"downlinkVolume" => 0, "eventTimeStamp" => nil, "serviceSpecificUnits" => nil, "time" => nil, "totalVolume" => 165681, "triggerTimestamp" => "2024-01-19T13:35:01+02:00", "triggers" => [%{"maxNumberOfccc" => nil, "timeLimit" => nil, "triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "FINAL", "volumeLimit" => nil, "volumeLimit64" => nil}], "uplinkVolume" => 165681}, "post_surcharge" => 0, "tariff_plan" => "5G Home X", "taxes" => %{"fixed" => 0, "gl" => "9500A030", "name" => "VAT", "percentage" => 15, "tax_amount" => 0.0, "tax_inclusive_amount" => 0.0, "taxable_amount" => 0}, "allocated_cost" => 0.0, "error" => nil}
21:49:12.973 [error] client :kaffe_producer_client failed to connect to kafka3:9092
reason:{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:49:12.976 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:49:13.267 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:49:13.269 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:49:13.580 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:49:13.582 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:49:13.869 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:49:13.870 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:49:15.185 [error] client :kaffe_producer_client failed to connect to kafka3:9092
reason:{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:49:15.187 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:49:15.477 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:49:15.479 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:49:15.480 [error] GenServer #PID<0.594.0> terminating
** (stop) {:reached_max_retries, :no_leader_connection}
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer_buffer.erl:312: :brod_producer_buffer.rebuffer_or_crash/3
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer_buffer.erl:296: :brod_producer_buffer.do_send/4
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer.erl:525: :brod_producer.maybe_produce/1
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer.erl:325: :brod_producer.handle_info/2
    (stdlib 5.1.1) gen_server.erl:1077: :gen_server.try_handle_info/3
    (stdlib 5.1.1) gen_server.erl:1165: :gen_server.handle_msg/6
    (stdlib 5.1.1) proc_lib.erl:241: :proc_lib.init_p_do_apply/3
Last message: :retry
State: {:state, #PID<0.253.0>, "kafka-topic-test", 0, :undefined, :undefined, {:buf, 512, 1, 1048576, 5, 0, 0, {&:brod_producer.do_send_fun/4, {"kafka-topic-test", 0, 1, 1000, :gzip}}, 1, 0, {[], []}, {[], []}, []}, 100, #Reference<0.3808617262.2103967749.212451>, :undefined, {:default, 0}}
21:49:15.482 [info] Sent 1 messages to topic kafka-topic-test in 3758 ms
21:49:15.483 [info] Sent messages to topic kafka-topic-test in "{\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"charged_to\":[{\"amount\":0,\"balance_name\":\"uncapped\",\"qty\":165681}],\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"cost\":0.0,\"status\":400,\"quantity\":165681,\"primary_service\":\"5G Home X\",\"allocated_qty\":165681,\"type\":100,\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\",\"connection_surcharge\":0,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"end_time\":\"2024-01-19T11:35:00+00:00\",\"meta\":{\"chargingId\":375767394,\"consumed\":{\"6000\":{\"allocated_cost\":0,\"allocated_qty\":0,\"cost\":0,\"end_time\":\"2024-01-19T13:35:00+02:00\",\"quantity\":165681,\"session_status\":300,\"start_time\":\"2024-01-19T13:25:17+02:00\",\"uncharged\":0}},\"ipv4_addr\":\"10.209.0.26\",\"oneTimeEvent\":false,\"ratType\":\"NR\",\"requestor\":\"satest\",\"resource_id\":\"imei-861935050829590\",\"service_id\":\"msisdn-27816699304\",\"userLocationinfo\":{\"eutraLocation\":null,\"n3gaLocation\":null,\"nrLocation\":{\"ageOfLocationInformation\":null,\"geodeticInformation\":null,\"geographicalInformation\":null,\"globalGnbId\":null,\"ignoreNcgi\":null,\"ncgi\":{\"nid\":null,\"nrCellId\":\"0d1414033\",\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"}},\"tai\":{\"nid\":null,\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"},\"tac\":\"07F394\"},\"ueLocationTimestamp\":\"2024-01-19T13:25:15+02:00\"}}},\"rating_group\":6000,\"uncharged\":null,\"charged_for\":\"Unlimited home 5G Premium\",\"rg_meta\":{\"mode\":\"ONLINE\",\"sessionFailover\":\"FAILOVER_NOT_SUPPORTED\"},\"start_time\":\"2024-01-19T11:25:18+00:00\",\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"rounding_policy\":\"1.110000\",\"unit_rate\":0,\"sub_id\":\"imsi-655730000598400\",\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"tp_meta\":{\"default_quota\":{\"name\":\"totalVolume\",\"quota\":57982058496},\"final_unit\":{\"finalUnitAction\":\"TERMINATE\"},\"model\":\"POST-PAID\",\"neg_balances\":false,\"policy_states\":[\"High Speed\",\"RICA\",\"Device\",\"Payment\",\"PAYMENT_HOLD\"],\"quota_calc\":\"default\",\"quota_rules\":[],\"unit_info\":{\"quotaHoldingTime\":0,\"timeQuotaThreshold\":70,\"triggers\":[{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_THRESHOLD\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_EXHAUSTED\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QHT\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"VALIDITY_TIME\"}],\"unitQuotaThreshold\":80,\"validityTime\":43200},\"vqt_percentage\":0.4},\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"item_seq_num\":1,\"applies_to\":{\"balances\":[\"uncapped\"],\"service_type\":\"mobile_data\"},\"description\":null,\"unit\":{\"downlinkVolume\":0,\"eventTimeStamp\":null,\"serviceSpecificUnits\":null,\"time\":null,\"totalVolume\":165681,\"triggerTimestamp\":\"2024-01-19T13:35:01+02:00\",\"triggers\":[{\"maxNumberOfccc\":null,\"timeLimit\":null,\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"FINAL\",\"volumeLimit\":null,\"volumeLimit64\":null}],\"uplinkVolume\":165681},\"post_surcharge\":0,\"tariff_plan\":\"5G Home X\",\"taxes\":{\"fixed\":0,\"gl\":\"9500A030\",\"name\":\"VAT\",\"percentage\":15,\"tax_amount\":0.0,\"tax_inclusive_amount\":0.0,\"taxable_amount\":0},\"allocated_cost\":0.0,\"error\":null}"
21:49:15.483 [info] Sent 1 messages to topic kafka-topic-test in 3758 ms
21:49:20.483 [info]     :supervisor: {#PID<0.582.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.603.0>,
  id: 0,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     0,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :gzip,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
21:50:47.351 [info]     :supervisor: {:local, :brod_sup}
    :started: [
  pid: #PID<0.253.0>,
  id: :kaffe_producer_client,
  mfargs: {:brod_client, :start_link,
   [
     [{~c"13.40.7.67", 9092}],
     :kaffe_producer_client,
     [
       auto_start_producers: true,
       allow_topic_auto_creation: false,
       default_producer_config: [
         required_acks: -1,
         ack_timeout: 1000,
         partition_buffer_limit: 512,
         partition_onwire_limit: 1,
         max_batch_size: 1048576,
         max_retries: 3,
         retry_backoff_ms: 500,
         compression: :no_compression,
         min_compression_batch_size: 1024
       ]
     ]
   ]},
  restart_type: {:permanent, 10},
  shutdown: 5000,
  child_type: :worker
]
21:50:54.353 [info] Running KafkaClusterWeb.Endpoint with cowboy 2.12.0 at 0.0.0.0:4080 (http)
21:50:54.394 [info] Access KafkaClusterWeb.Endpoint at http://localhost:4080
21:50:54.548 [info] Thoma
21:52:09.085 [info] Payload :: "{\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"allocated_cost\":0.0,\"uncharged\":null,\"allocated_qty\":165681,\"applies_to\":{\"balances\": [\"uncapped\"], \"service_type\": \"mobile_data\"},\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"charged_for\":\"Unlimited home 5G Premium\",\"charged_to\":[{\"qty\": 165681, \"amount\": 0, \"balance_name\": \"uncapped\"}],\"connection_surcharge\":0,\"cost\":0.0,\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"description\":null,\"end_time\":\"2024-01-19T11:35:00+00:00\",\"item_seq_num\":1,\"meta\":{\"ratType\": \"NR\", \"consumed\": {\"6000\": {\"cost\": 0, \"end_time\": \"2024-01-19T13:35:00+02:00\", \"quantity\": 165681, \"uncharged\": 0, \"start_time\": \"2024-01-19T13:25:17+02:00\", \"allocated_qty\": 0, \"allocated_cost\": 0, \"session_status\": 300}}, \"ipv4_addr\": \"10.209.0.26\", \"requestor\": \"satest\", \"chargingId\": 375767394, \"service_id\": \"msisdn-27816699304\", \"resource_id\": \"imei-861935050829590\", \"oneTimeEvent\": false, \"userLocationinfo\": {\"nrLocation\": {\"tai\": {\"nid\": null, \"tac\": \"07F394\", \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}}, \"ncgi\": {\"nid\": null, \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}, \"nrCellId\": \"0d1414033\"}, \"ignoreNcgi\": null, \"globalGnbId\": null, \"geodeticInformation\": null, \"ueLocationTimestamp\": \"2024-01-19T13:25:15+02:00\", \"geographicalInformation\": null, \"ageOfLocationInformation\": null}, \"n3gaLocation\": null, \"eutraLocation\": null}},\"post_surcharge\":0,\"primary_service\":\"5G Home X\",\"quantity\":165681,\"rating_group\":6000,\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"rg_meta\":{\"mode\": \"ONLINE\", \"sessionFailover\": \"FAILOVER_NOT_SUPPORTED\"},\"rounding_policy\":\"1.110000\",\"start_time\":\"2024-01-19T11:25:18+00:00\",\"status\":400,\"sub_id\":\"imsi-655730000598400\",\"tariff_plan\":\"5G Home X\",\"taxes\":{\"gl\": \"9500A030\", \"name\": \"VAT\", \"fixed\": 0, \"percentage\": 15, \"tax_amount\": 0.0, \"taxable_amount\": 0, \"tax_inclusive_amount\": 0.0},\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"tp_meta\":{\"model\": \"POST-PAID\", \"unit_info\": {\"triggers\": [{\"triggerType\": \"QUOTA_THRESHOLD\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QUOTA_EXHAUSTED\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QHT\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"VALIDITY_TIME\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"validityTime\": 43200, \"quotaHoldingTime\": 0, \"timeQuotaThreshold\": 70, \"unitQuotaThreshold\": 80}, \"final_unit\": {\"finalUnitAction\": \"TERMINATE\"}, \"quota_calc\": \"default\", \"quota_rules\": [], \"neg_balances\": false, \"default_quota\": {\"name\": \"totalVolume\", \"quota\": 57982058496}, \"policy_states\": [\"High Speed\", \"RICA\", \"Device\", \"Payment\", \"PAYMENT_HOLD\"], \"vqt_percentage\": 0.4},\"type\":100,\"unit\":{\"time\": null, \"triggers\": [{\"timeLimit\": null, \"triggerType\": \"FINAL\", \"volumeLimit\": null, \"volumeLimit64\": null, \"maxNumberOfccc\": null, \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"totalVolume\": 165681, \"uplinkVolume\": 165681, \"downlinkVolume\": 0, \"eventTimeStamp\": null, \"triggerTimestamp\": \"2024-01-19T13:35:01+02:00\", \"serviceSpecificUnits\": null},\"unit_rate\":0,\"error\":null,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\"}"
21:52:09.087 [info] Decoded Payload :: %{"timestamp" => "2024-01-19T11:35:01+00:00", "charged_to" => [%{"amount" => 0, "balance_name" => "uncapped", "qty" => 165681}], "id" => "\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035", "cost" => 0.0, "status" => 400, "quantity" => 165681, "primary_service" => "5G Home X", "allocated_qty" => 165681, "type" => 100, "service_id" => "a72e5f19-6245-4d24-8f69-3bf4bf215895", "connection_surcharge" => 0, "inserted_at" => "2024-01-19T11:35:32+00:00", "updated_at" => "2024-01-19T11:35:32+00:00", "end_time" => "2024-01-19T11:35:00+00:00", "meta" => %{"chargingId" => 375767394, "consumed" => %{"6000" => %{"allocated_cost" => 0, "allocated_qty" => 0, "cost" => 0, "end_time" => "2024-01-19T13:35:00+02:00", "quantity" => 165681, "session_status" => 300, "start_time" => "2024-01-19T13:25:17+02:00", "uncharged" => 0}}, "ipv4_addr" => "10.209.0.26", "oneTimeEvent" => false, "ratType" => "NR", "requestor" => "satest", "resource_id" => "imei-861935050829590", "service_id" => "msisdn-27816699304", "userLocationinfo" => %{"eutraLocation" => nil, "n3gaLocation" => nil, "nrLocation" => %{"ageOfLocationInformation" => nil, "geodeticInformation" => nil, "geographicalInformation" => nil, "globalGnbId" => nil, "ignoreNcgi" => nil, "ncgi" => %{"nid" => nil, "nrCellId" => "0d1414033", "plmnId" => %{"mcc" => "655", "mnc" => "73"}}, "tai" => %{"nid" => nil, "plmnId" => %{"mcc" => "655", "mnc" => "73"}, "tac" => "07F394"}, "ueLocationTimestamp" => "2024-01-19T13:25:15+02:00"}}}, "rating_group" => 6000, "uncharged" => nil, "charged_for" => "Unlimited home 5G Premium", "rg_meta" => %{"mode" => "ONLINE", "sessionFailover" => "FAILOVER_NOT_SUPPORTED"}, "start_time" => "2024-01-19T11:25:18+00:00", "c_id" => "20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2", "rounding_policy" => "1.110000", "unit_rate" => 0, "sub_id" => "imsi-655730000598400", "cr_id" => "20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2", "tp_meta" => %{"default_quota" => %{"name" => "totalVolume", "quota" => 57982058496}, "final_unit" => %{"finalUnitAction" => "TERMINATE"}, "model" => "POST-PAID", "neg_balances" => false, "policy_states" => ["High Speed", "RICA", "Device", "Payment", "PAYMENT_HOLD"], "quota_calc" => "default", "quota_rules" => [], "unit_info" => %{"quotaHoldingTime" => 0, "timeQuotaThreshold" => 70, "triggers" => [%{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_THRESHOLD"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_EXHAUSTED"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QHT"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "VALIDITY_TIME"}], "unitQuotaThreshold" => 80, "validityTime" => 43200}, "vqt_percentage" => 0.4}, "requestor_node_id" => "trc_udg_upf_01", "requestor_service_id" => nil, "item_seq_num" => 1, "applies_to" => %{"balances" => ["uncapped"], "service_type" => "mobile_data"}, "description" => nil, "unit" => %{"downlinkVolume" => 0, "eventTimeStamp" => nil, "serviceSpecificUnits" => nil, "time" => nil, "totalVolume" => 165681, "triggerTimestamp" => "2024-01-19T13:35:01+02:00", "triggers" => [%{"maxNumberOfccc" => nil, "timeLimit" => nil, "triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "FINAL", "volumeLimit" => nil, "volumeLimit64" => nil}], "uplinkVolume" => 165681}, "post_surcharge" => 0, "tariff_plan" => "5G Home X", "taxes" => %{"fixed" => 0, "gl" => "9500A030", "name" => "VAT", "percentage" => 15, "tax_amount" => 0.0, "tax_inclusive_amount" => 0.0, "taxable_amount" => 0}, "allocated_cost" => 0.0, "error" => nil}
21:52:09.305 [info]     :supervisor: {#PID<0.316.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.583.0>,
  id: "kafka-topic-test",
  mfargs: {:supervisor3, :start_link,
   [
     :brod_producers_sup,
     {:brod_producers_sup2, #PID<0.253.0>, "kafka-topic-test",
      [
        required_acks: -1,
        ack_timeout: 1000,
        partition_buffer_limit: 512,
        partition_onwire_limit: 1,
        max_batch_size: 1048576,
        max_retries: 3,
        retry_backoff_ms: 500,
        compression: :no_compression,
        min_compression_batch_size: 1024
      ]}
   ]},
  restart_type: {:permanent, 10},
  shutdown: :infinity,
  child_type: :supervisor
]
21:52:09.320 [info]     :supervisor: {#PID<0.583.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.584.0>,
  id: 0,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     0,
     [
       required_acks: -1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 3,
       retry_backoff_ms: 500,
       compression: :no_compression,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
21:52:09.322 [info]     :supervisor: {#PID<0.583.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.585.0>,
  id: 1,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     1,
     [
       required_acks: -1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 3,
       retry_backoff_ms: 500,
       compression: :no_compression,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
21:52:09.323 [info]     :supervisor: {#PID<0.583.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.586.0>,
  id: 2,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     2,
     [
       required_acks: -1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 3,
       retry_backoff_ms: 500,
       compression: :no_compression,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
21:52:10.551 [error] client :kaffe_producer_client failed to connect to kafka3:9092
reason:{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:52:10.552 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:52:11.415 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:52:11.416 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:52:13.273 [error] client :kaffe_producer_client failed to connect to kafka3:9092
reason:{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:52:13.274 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:52:13.996 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:52:13.998 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:52:13.999 [error] GenServer #PID<0.584.0> terminating
** (stop) {:reached_max_retries, :no_leader_connection}
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer_buffer.erl:312: :brod_producer_buffer.rebuffer_or_crash/3
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer_buffer.erl:296: :brod_producer_buffer.do_send/4
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer.erl:525: :brod_producer.maybe_produce/1
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer.erl:325: :brod_producer.handle_info/2
    (stdlib 5.1.1) gen_server.erl:1077: :gen_server.try_handle_info/3
    (stdlib 5.1.1) gen_server.erl:1165: :gen_server.handle_msg/6
    (stdlib 5.1.1) proc_lib.erl:241: :proc_lib.init_p_do_apply/3
Last message: :retry
State: {:state, #PID<0.253.0>, "kafka-topic-test", 0, :undefined, :undefined, {:buf, 512, 1, 1048576, 3, 0, 0, {&:brod_producer.do_send_fun/4, {"kafka-topic-test", 0, -1, 1000, :no_compression}}, 1, 0, {[], []}, {[], []}, []}, 500, #Reference<0.2813404284.2910060545.6330>, :undefined, {:default, 0}}
21:52:14.018 [info] Sent 1 messages to topic kafka-topic-test in 4912 ms
21:52:14.020 [info] Sent messages to topic kafka-topic-test in "{\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"charged_to\":[{\"amount\":0,\"balance_name\":\"uncapped\",\"qty\":165681}],\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"cost\":0.0,\"status\":400,\"quantity\":165681,\"primary_service\":\"5G Home X\",\"allocated_qty\":165681,\"type\":100,\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\",\"connection_surcharge\":0,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"end_time\":\"2024-01-19T11:35:00+00:00\",\"meta\":{\"chargingId\":375767394,\"consumed\":{\"6000\":{\"allocated_cost\":0,\"allocated_qty\":0,\"cost\":0,\"end_time\":\"2024-01-19T13:35:00+02:00\",\"quantity\":165681,\"session_status\":300,\"start_time\":\"2024-01-19T13:25:17+02:00\",\"uncharged\":0}},\"ipv4_addr\":\"10.209.0.26\",\"oneTimeEvent\":false,\"ratType\":\"NR\",\"requestor\":\"satest\",\"resource_id\":\"imei-861935050829590\",\"service_id\":\"msisdn-27816699304\",\"userLocationinfo\":{\"eutraLocation\":null,\"n3gaLocation\":null,\"nrLocation\":{\"ageOfLocationInformation\":null,\"geodeticInformation\":null,\"geographicalInformation\":null,\"globalGnbId\":null,\"ignoreNcgi\":null,\"ncgi\":{\"nid\":null,\"nrCellId\":\"0d1414033\",\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"}},\"tai\":{\"nid\":null,\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"},\"tac\":\"07F394\"},\"ueLocationTimestamp\":\"2024-01-19T13:25:15+02:00\"}}},\"rating_group\":6000,\"uncharged\":null,\"charged_for\":\"Unlimited home 5G Premium\",\"rg_meta\":{\"mode\":\"ONLINE\",\"sessionFailover\":\"FAILOVER_NOT_SUPPORTED\"},\"start_time\":\"2024-01-19T11:25:18+00:00\",\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"rounding_policy\":\"1.110000\",\"unit_rate\":0,\"sub_id\":\"imsi-655730000598400\",\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"tp_meta\":{\"default_quota\":{\"name\":\"totalVolume\",\"quota\":57982058496},\"final_unit\":{\"finalUnitAction\":\"TERMINATE\"},\"model\":\"POST-PAID\",\"neg_balances\":false,\"policy_states\":[\"High Speed\",\"RICA\",\"Device\",\"Payment\",\"PAYMENT_HOLD\"],\"quota_calc\":\"default\",\"quota_rules\":[],\"unit_info\":{\"quotaHoldingTime\":0,\"timeQuotaThreshold\":70,\"triggers\":[{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_THRESHOLD\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_EXHAUSTED\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QHT\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"VALIDITY_TIME\"}],\"unitQuotaThreshold\":80,\"validityTime\":43200},\"vqt_percentage\":0.4},\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"item_seq_num\":1,\"applies_to\":{\"balances\":[\"uncapped\"],\"service_type\":\"mobile_data\"},\"description\":null,\"unit\":{\"downlinkVolume\":0,\"eventTimeStamp\":null,\"serviceSpecificUnits\":null,\"time\":null,\"totalVolume\":165681,\"triggerTimestamp\":\"2024-01-19T13:35:01+02:00\",\"triggers\":[{\"maxNumberOfccc\":null,\"timeLimit\":null,\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"FINAL\",\"volumeLimit\":null,\"volumeLimit64\":null}],\"uplinkVolume\":165681},\"post_surcharge\":0,\"tariff_plan\":\"5G Home X\",\"taxes\":{\"fixed\":0,\"gl\":\"9500A030\",\"name\":\"VAT\",\"percentage\":15,\"tax_amount\":0.0,\"tax_inclusive_amount\":0.0,\"taxable_amount\":0},\"allocated_cost\":0.0,\"error\":null}"
21:52:14.020 [info] Sent 1 messages to topic kafka-topic-test in 4912 ms
21:52:19.019 [info]     :supervisor: {#PID<0.583.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.593.0>,
  id: 0,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     0,
     [
       required_acks: -1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 3,
       retry_backoff_ms: 500,
       compression: :no_compression,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
21:55:36.482 [info] Payload :: "{\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"allocated_cost\":0.0,\"uncharged\":null,\"allocated_qty\":165681,\"applies_to\":{\"balances\": [\"uncapped\"], \"service_type\": \"mobile_data\"},\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"charged_for\":\"Unlimited home 5G Premium\",\"charged_to\":[{\"qty\": 165681, \"amount\": 0, \"balance_name\": \"uncapped\"}],\"connection_surcharge\":0,\"cost\":0.0,\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"description\":null,\"end_time\":\"2024-01-19T11:35:00+00:00\",\"item_seq_num\":1,\"meta\":{\"ratType\": \"NR\", \"consumed\": {\"6000\": {\"cost\": 0, \"end_time\": \"2024-01-19T13:35:00+02:00\", \"quantity\": 165681, \"uncharged\": 0, \"start_time\": \"2024-01-19T13:25:17+02:00\", \"allocated_qty\": 0, \"allocated_cost\": 0, \"session_status\": 300}}, \"ipv4_addr\": \"10.209.0.26\", \"requestor\": \"satest\", \"chargingId\": 375767394, \"service_id\": \"msisdn-27816699304\", \"resource_id\": \"imei-861935050829590\", \"oneTimeEvent\": false, \"userLocationinfo\": {\"nrLocation\": {\"tai\": {\"nid\": null, \"tac\": \"07F394\", \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}}, \"ncgi\": {\"nid\": null, \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}, \"nrCellId\": \"0d1414033\"}, \"ignoreNcgi\": null, \"globalGnbId\": null, \"geodeticInformation\": null, \"ueLocationTimestamp\": \"2024-01-19T13:25:15+02:00\", \"geographicalInformation\": null, \"ageOfLocationInformation\": null}, \"n3gaLocation\": null, \"eutraLocation\": null}},\"post_surcharge\":0,\"primary_service\":\"5G Home X\",\"quantity\":165681,\"rating_group\":6000,\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"rg_meta\":{\"mode\": \"ONLINE\", \"sessionFailover\": \"FAILOVER_NOT_SUPPORTED\"},\"rounding_policy\":\"1.110000\",\"start_time\":\"2024-01-19T11:25:18+00:00\",\"status\":400,\"sub_id\":\"imsi-655730000598400\",\"tariff_plan\":\"5G Home X\",\"taxes\":{\"gl\": \"9500A030\", \"name\": \"VAT\", \"fixed\": 0, \"percentage\": 15, \"tax_amount\": 0.0, \"taxable_amount\": 0, \"tax_inclusive_amount\": 0.0},\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"tp_meta\":{\"model\": \"POST-PAID\", \"unit_info\": {\"triggers\": [{\"triggerType\": \"QUOTA_THRESHOLD\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QUOTA_EXHAUSTED\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QHT\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"VALIDITY_TIME\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"validityTime\": 43200, \"quotaHoldingTime\": 0, \"timeQuotaThreshold\": 70, \"unitQuotaThreshold\": 80}, \"final_unit\": {\"finalUnitAction\": \"TERMINATE\"}, \"quota_calc\": \"default\", \"quota_rules\": [], \"neg_balances\": false, \"default_quota\": {\"name\": \"totalVolume\", \"quota\": 57982058496}, \"policy_states\": [\"High Speed\", \"RICA\", \"Device\", \"Payment\", \"PAYMENT_HOLD\"], \"vqt_percentage\": 0.4},\"type\":100,\"unit\":{\"time\": null, \"triggers\": [{\"timeLimit\": null, \"triggerType\": \"FINAL\", \"volumeLimit\": null, \"volumeLimit64\": null, \"maxNumberOfccc\": null, \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"totalVolume\": 165681, \"uplinkVolume\": 165681, \"downlinkVolume\": 0, \"eventTimeStamp\": null, \"triggerTimestamp\": \"2024-01-19T13:35:01+02:00\", \"serviceSpecificUnits\": null},\"unit_rate\":0,\"error\":null,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\"}"
21:55:36.483 [info] Decoded Payload :: %{"timestamp" => "2024-01-19T11:35:01+00:00", "charged_to" => [%{"amount" => 0, "balance_name" => "uncapped", "qty" => 165681}], "id" => "\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035", "cost" => 0.0, "status" => 400, "quantity" => 165681, "primary_service" => "5G Home X", "allocated_qty" => 165681, "type" => 100, "service_id" => "a72e5f19-6245-4d24-8f69-3bf4bf215895", "connection_surcharge" => 0, "inserted_at" => "2024-01-19T11:35:32+00:00", "updated_at" => "2024-01-19T11:35:32+00:00", "end_time" => "2024-01-19T11:35:00+00:00", "meta" => %{"chargingId" => 375767394, "consumed" => %{"6000" => %{"allocated_cost" => 0, "allocated_qty" => 0, "cost" => 0, "end_time" => "2024-01-19T13:35:00+02:00", "quantity" => 165681, "session_status" => 300, "start_time" => "2024-01-19T13:25:17+02:00", "uncharged" => 0}}, "ipv4_addr" => "10.209.0.26", "oneTimeEvent" => false, "ratType" => "NR", "requestor" => "satest", "resource_id" => "imei-861935050829590", "service_id" => "msisdn-27816699304", "userLocationinfo" => %{"eutraLocation" => nil, "n3gaLocation" => nil, "nrLocation" => %{"ageOfLocationInformation" => nil, "geodeticInformation" => nil, "geographicalInformation" => nil, "globalGnbId" => nil, "ignoreNcgi" => nil, "ncgi" => %{"nid" => nil, "nrCellId" => "0d1414033", "plmnId" => %{"mcc" => "655", "mnc" => "73"}}, "tai" => %{"nid" => nil, "plmnId" => %{"mcc" => "655", "mnc" => "73"}, "tac" => "07F394"}, "ueLocationTimestamp" => "2024-01-19T13:25:15+02:00"}}}, "rating_group" => 6000, "uncharged" => nil, "charged_for" => "Unlimited home 5G Premium", "rg_meta" => %{"mode" => "ONLINE", "sessionFailover" => "FAILOVER_NOT_SUPPORTED"}, "start_time" => "2024-01-19T11:25:18+00:00", "c_id" => "20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2", "rounding_policy" => "1.110000", "unit_rate" => 0, "sub_id" => "imsi-655730000598400", "cr_id" => "20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2", "tp_meta" => %{"default_quota" => %{"name" => "totalVolume", "quota" => 57982058496}, "final_unit" => %{"finalUnitAction" => "TERMINATE"}, "model" => "POST-PAID", "neg_balances" => false, "policy_states" => ["High Speed", "RICA", "Device", "Payment", "PAYMENT_HOLD"], "quota_calc" => "default", "quota_rules" => [], "unit_info" => %{"quotaHoldingTime" => 0, "timeQuotaThreshold" => 70, "triggers" => [%{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_THRESHOLD"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_EXHAUSTED"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QHT"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "VALIDITY_TIME"}], "unitQuotaThreshold" => 80, "validityTime" => 43200}, "vqt_percentage" => 0.4}, "requestor_node_id" => "trc_udg_upf_01", "requestor_service_id" => nil, "item_seq_num" => 1, "applies_to" => %{"balances" => ["uncapped"], "service_type" => "mobile_data"}, "description" => nil, "unit" => %{"downlinkVolume" => 0, "eventTimeStamp" => nil, "serviceSpecificUnits" => nil, "time" => nil, "totalVolume" => 165681, "triggerTimestamp" => "2024-01-19T13:35:01+02:00", "triggers" => [%{"maxNumberOfccc" => nil, "timeLimit" => nil, "triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "FINAL", "volumeLimit" => nil, "volumeLimit64" => nil}], "uplinkVolume" => 165681}, "post_surcharge" => 0, "tariff_plan" => "5G Home X", "taxes" => %{"fixed" => 0, "gl" => "9500A030", "name" => "VAT", "percentage" => 15, "tax_amount" => 0.0, "tax_inclusive_amount" => 0.0, "taxable_amount" => 0}, "allocated_cost" => 0.0, "error" => nil}
21:55:37.826 [error] client :kaffe_producer_client failed to connect to kafka3:9092
reason:{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:55:37.827 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:55:38.585 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:55:38.591 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:55:40.518 [error] client :kaffe_producer_client failed to connect to kafka3:9092
reason:{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:55:40.519 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:55:41.211 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:55:41.212 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
21:55:41.216 [error] GenServer #PID<0.593.0> terminating
** (stop) {:reached_max_retries, :no_leader_connection}
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer_buffer.erl:312: :brod_producer_buffer.rebuffer_or_crash/3
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer_buffer.erl:296: :brod_producer_buffer.do_send/4
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer.erl:525: :brod_producer.maybe_produce/1
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer.erl:325: :brod_producer.handle_info/2
    (stdlib 5.1.1) gen_server.erl:1077: :gen_server.try_handle_info/3
    (stdlib 5.1.1) gen_server.erl:1165: :gen_server.handle_msg/6
    (stdlib 5.1.1) proc_lib.erl:241: :proc_lib.init_p_do_apply/3
Last message: :retry
State: {:state, #PID<0.253.0>, "kafka-topic-test", 0, :undefined, :undefined, {:buf, 512, 1, 1048576, 3, 0, 0, {&:brod_producer.do_send_fun/4, {"kafka-topic-test", 0, -1, 1000, :no_compression}}, 1, 0, {[], []}, {[], []}, []}, 500, #Reference<0.2813404284.2910060545.7091>, :undefined, {:default, 0}}
21:55:41.219 [info] Sent 1 messages to topic kafka-topic-test in 4735 ms
21:55:41.221 [info] Sent messages to topic kafka-topic-test in "{\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"charged_to\":[{\"amount\":0,\"balance_name\":\"uncapped\",\"qty\":165681}],\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"cost\":0.0,\"status\":400,\"quantity\":165681,\"primary_service\":\"5G Home X\",\"allocated_qty\":165681,\"type\":100,\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\",\"connection_surcharge\":0,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"end_time\":\"2024-01-19T11:35:00+00:00\",\"meta\":{\"chargingId\":375767394,\"consumed\":{\"6000\":{\"allocated_cost\":0,\"allocated_qty\":0,\"cost\":0,\"end_time\":\"2024-01-19T13:35:00+02:00\",\"quantity\":165681,\"session_status\":300,\"start_time\":\"2024-01-19T13:25:17+02:00\",\"uncharged\":0}},\"ipv4_addr\":\"10.209.0.26\",\"oneTimeEvent\":false,\"ratType\":\"NR\",\"requestor\":\"satest\",\"resource_id\":\"imei-861935050829590\",\"service_id\":\"msisdn-27816699304\",\"userLocationinfo\":{\"eutraLocation\":null,\"n3gaLocation\":null,\"nrLocation\":{\"ageOfLocationInformation\":null,\"geodeticInformation\":null,\"geographicalInformation\":null,\"globalGnbId\":null,\"ignoreNcgi\":null,\"ncgi\":{\"nid\":null,\"nrCellId\":\"0d1414033\",\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"}},\"tai\":{\"nid\":null,\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"},\"tac\":\"07F394\"},\"ueLocationTimestamp\":\"2024-01-19T13:25:15+02:00\"}}},\"rating_group\":6000,\"uncharged\":null,\"charged_for\":\"Unlimited home 5G Premium\",\"rg_meta\":{\"mode\":\"ONLINE\",\"sessionFailover\":\"FAILOVER_NOT_SUPPORTED\"},\"start_time\":\"2024-01-19T11:25:18+00:00\",\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"rounding_policy\":\"1.110000\",\"unit_rate\":0,\"sub_id\":\"imsi-655730000598400\",\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"tp_meta\":{\"default_quota\":{\"name\":\"totalVolume\",\"quota\":57982058496},\"final_unit\":{\"finalUnitAction\":\"TERMINATE\"},\"model\":\"POST-PAID\",\"neg_balances\":false,\"policy_states\":[\"High Speed\",\"RICA\",\"Device\",\"Payment\",\"PAYMENT_HOLD\"],\"quota_calc\":\"default\",\"quota_rules\":[],\"unit_info\":{\"quotaHoldingTime\":0,\"timeQuotaThreshold\":70,\"triggers\":[{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_THRESHOLD\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_EXHAUSTED\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QHT\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"VALIDITY_TIME\"}],\"unitQuotaThreshold\":80,\"validityTime\":43200},\"vqt_percentage\":0.4},\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"item_seq_num\":1,\"applies_to\":{\"balances\":[\"uncapped\"],\"service_type\":\"mobile_data\"},\"description\":null,\"unit\":{\"downlinkVolume\":0,\"eventTimeStamp\":null,\"serviceSpecificUnits\":null,\"time\":null,\"totalVolume\":165681,\"triggerTimestamp\":\"2024-01-19T13:35:01+02:00\",\"triggers\":[{\"maxNumberOfccc\":null,\"timeLimit\":null,\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"FINAL\",\"volumeLimit\":null,\"volumeLimit64\":null}],\"uplinkVolume\":165681},\"post_surcharge\":0,\"tariff_plan\":\"5G Home X\",\"taxes\":{\"fixed\":0,\"gl\":\"9500A030\",\"name\":\"VAT\",\"percentage\":15,\"tax_amount\":0.0,\"tax_inclusive_amount\":0.0,\"taxable_amount\":0},\"allocated_cost\":0.0,\"error\":null}"
21:55:41.221 [info] Sent 1 messages to topic kafka-topic-test in 4735 ms
21:55:46.224 [info]     :supervisor: {#PID<0.583.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.605.0>,
  id: 0,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     0,
     [
       required_acks: -1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 3,
       retry_backoff_ms: 500,
       compression: :no_compression,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
22:22:23.253 [info]     :supervisor: {:local, :brod_sup}
    :started: [
  pid: #PID<0.253.0>,
  id: :kaffe_producer_client,
  mfargs: {:brod_client, :start_link,
   [
     [{~c"13.40.7.67", 9092}],
     :kaffe_producer_client,
     [
       auto_start_producers: true,
       allow_topic_auto_creation: false,
       default_producer_config: [
         required_acks: 1,
         ack_timeout: 1000,
         partition_buffer_limit: 512,
         partition_onwire_limit: 1,
         max_batch_size: 1048576,
         max_retries: 5,
         retry_backoff_ms: 100,
         compression: :gzip,
         min_compression_batch_size: 1024
       ]
     ]
   ]},
  restart_type: {:permanent, 10},
  shutdown: 5000,
  child_type: :worker
]
22:22:27.893 [info] Running KafkaClusterWeb.Endpoint with cowboy 2.12.0 at 0.0.0.0:4080 (http)
22:22:27.968 [info] Access KafkaClusterWeb.Endpoint at http://localhost:4080
22:22:28.154 [info] Thoma
22:22:54.312 [info] Payload :: "{\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"allocated_cost\":0.0,\"uncharged\":null,\"allocated_qty\":165681,\"applies_to\":{\"balances\": [\"uncapped\"], \"service_type\": \"mobile_data\"},\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"charged_for\":\"Unlimited home 5G Premium\",\"charged_to\":[{\"qty\": 165681, \"amount\": 0, \"balance_name\": \"uncapped\"}],\"connection_surcharge\":0,\"cost\":0.0,\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"description\":null,\"end_time\":\"2024-01-19T11:35:00+00:00\",\"item_seq_num\":1,\"meta\":{\"ratType\": \"NR\", \"consumed\": {\"6000\": {\"cost\": 0, \"end_time\": \"2024-01-19T13:35:00+02:00\", \"quantity\": 165681, \"uncharged\": 0, \"start_time\": \"2024-01-19T13:25:17+02:00\", \"allocated_qty\": 0, \"allocated_cost\": 0, \"session_status\": 300}}, \"ipv4_addr\": \"10.209.0.26\", \"requestor\": \"satest\", \"chargingId\": 375767394, \"service_id\": \"msisdn-27816699304\", \"resource_id\": \"imei-861935050829590\", \"oneTimeEvent\": false, \"userLocationinfo\": {\"nrLocation\": {\"tai\": {\"nid\": null, \"tac\": \"07F394\", \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}}, \"ncgi\": {\"nid\": null, \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}, \"nrCellId\": \"0d1414033\"}, \"ignoreNcgi\": null, \"globalGnbId\": null, \"geodeticInformation\": null, \"ueLocationTimestamp\": \"2024-01-19T13:25:15+02:00\", \"geographicalInformation\": null, \"ageOfLocationInformation\": null}, \"n3gaLocation\": null, \"eutraLocation\": null}},\"post_surcharge\":0,\"primary_service\":\"5G Home X\",\"quantity\":165681,\"rating_group\":6000,\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"rg_meta\":{\"mode\": \"ONLINE\", \"sessionFailover\": \"FAILOVER_NOT_SUPPORTED\"},\"rounding_policy\":\"1.110000\",\"start_time\":\"2024-01-19T11:25:18+00:00\",\"status\":400,\"sub_id\":\"imsi-655730000598400\",\"tariff_plan\":\"5G Home X\",\"taxes\":{\"gl\": \"9500A030\", \"name\": \"VAT\", \"fixed\": 0, \"percentage\": 15, \"tax_amount\": 0.0, \"taxable_amount\": 0, \"tax_inclusive_amount\": 0.0},\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"tp_meta\":{\"model\": \"POST-PAID\", \"unit_info\": {\"triggers\": [{\"triggerType\": \"QUOTA_THRESHOLD\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QUOTA_EXHAUSTED\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QHT\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"VALIDITY_TIME\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"validityTime\": 43200, \"quotaHoldingTime\": 0, \"timeQuotaThreshold\": 70, \"unitQuotaThreshold\": 80}, \"final_unit\": {\"finalUnitAction\": \"TERMINATE\"}, \"quota_calc\": \"default\", \"quota_rules\": [], \"neg_balances\": false, \"default_quota\": {\"name\": \"totalVolume\", \"quota\": 57982058496}, \"policy_states\": [\"High Speed\", \"RICA\", \"Device\", \"Payment\", \"PAYMENT_HOLD\"], \"vqt_percentage\": 0.4},\"type\":100,\"unit\":{\"time\": null, \"triggers\": [{\"timeLimit\": null, \"triggerType\": \"FINAL\", \"volumeLimit\": null, \"volumeLimit64\": null, \"maxNumberOfccc\": null, \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"totalVolume\": 165681, \"uplinkVolume\": 165681, \"downlinkVolume\": 0, \"eventTimeStamp\": null, \"triggerTimestamp\": \"2024-01-19T13:35:01+02:00\", \"serviceSpecificUnits\": null},\"unit_rate\":0,\"error\":null,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\"}"
22:22:54.314 [info] Decoded Payload :: %{"timestamp" => "2024-01-19T11:35:01+00:00", "charged_to" => [%{"amount" => 0, "balance_name" => "uncapped", "qty" => 165681}], "id" => "\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035", "cost" => 0.0, "status" => 400, "quantity" => 165681, "primary_service" => "5G Home X", "allocated_qty" => 165681, "type" => 100, "service_id" => "a72e5f19-6245-4d24-8f69-3bf4bf215895", "connection_surcharge" => 0, "inserted_at" => "2024-01-19T11:35:32+00:00", "updated_at" => "2024-01-19T11:35:32+00:00", "end_time" => "2024-01-19T11:35:00+00:00", "meta" => %{"chargingId" => 375767394, "consumed" => %{"6000" => %{"allocated_cost" => 0, "allocated_qty" => 0, "cost" => 0, "end_time" => "2024-01-19T13:35:00+02:00", "quantity" => 165681, "session_status" => 300, "start_time" => "2024-01-19T13:25:17+02:00", "uncharged" => 0}}, "ipv4_addr" => "10.209.0.26", "oneTimeEvent" => false, "ratType" => "NR", "requestor" => "satest", "resource_id" => "imei-861935050829590", "service_id" => "msisdn-27816699304", "userLocationinfo" => %{"eutraLocation" => nil, "n3gaLocation" => nil, "nrLocation" => %{"ageOfLocationInformation" => nil, "geodeticInformation" => nil, "geographicalInformation" => nil, "globalGnbId" => nil, "ignoreNcgi" => nil, "ncgi" => %{"nid" => nil, "nrCellId" => "0d1414033", "plmnId" => %{"mcc" => "655", "mnc" => "73"}}, "tai" => %{"nid" => nil, "plmnId" => %{"mcc" => "655", "mnc" => "73"}, "tac" => "07F394"}, "ueLocationTimestamp" => "2024-01-19T13:25:15+02:00"}}}, "rating_group" => 6000, "uncharged" => nil, "charged_for" => "Unlimited home 5G Premium", "rg_meta" => %{"mode" => "ONLINE", "sessionFailover" => "FAILOVER_NOT_SUPPORTED"}, "start_time" => "2024-01-19T11:25:18+00:00", "c_id" => "20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2", "rounding_policy" => "1.110000", "unit_rate" => 0, "sub_id" => "imsi-655730000598400", "cr_id" => "20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2", "tp_meta" => %{"default_quota" => %{"name" => "totalVolume", "quota" => 57982058496}, "final_unit" => %{"finalUnitAction" => "TERMINATE"}, "model" => "POST-PAID", "neg_balances" => false, "policy_states" => ["High Speed", "RICA", "Device", "Payment", "PAYMENT_HOLD"], "quota_calc" => "default", "quota_rules" => [], "unit_info" => %{"quotaHoldingTime" => 0, "timeQuotaThreshold" => 70, "triggers" => [%{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_THRESHOLD"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_EXHAUSTED"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QHT"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "VALIDITY_TIME"}], "unitQuotaThreshold" => 80, "validityTime" => 43200}, "vqt_percentage" => 0.4}, "requestor_node_id" => "trc_udg_upf_01", "requestor_service_id" => nil, "item_seq_num" => 1, "applies_to" => %{"balances" => ["uncapped"], "service_type" => "mobile_data"}, "description" => nil, "unit" => %{"downlinkVolume" => 0, "eventTimeStamp" => nil, "serviceSpecificUnits" => nil, "time" => nil, "totalVolume" => 165681, "triggerTimestamp" => "2024-01-19T13:35:01+02:00", "triggers" => [%{"maxNumberOfccc" => nil, "timeLimit" => nil, "triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "FINAL", "volumeLimit" => nil, "volumeLimit64" => nil}], "uplinkVolume" => 165681}, "post_surcharge" => 0, "tariff_plan" => "5G Home X", "taxes" => %{"fixed" => 0, "gl" => "9500A030", "name" => "VAT", "percentage" => 15, "tax_amount" => 0.0, "tax_inclusive_amount" => 0.0, "taxable_amount" => 0}, "allocated_cost" => 0.0, "error" => nil}
22:22:54.536 [info]     :supervisor: {#PID<0.316.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.582.0>,
  id: "kafka-topic-test",
  mfargs: {:supervisor3, :start_link,
   [
     :brod_producers_sup,
     {:brod_producers_sup2, #PID<0.253.0>, "kafka-topic-test",
      [
        required_acks: 1,
        ack_timeout: 1000,
        partition_buffer_limit: 512,
        partition_onwire_limit: 1,
        max_batch_size: 1048576,
        max_retries: 5,
        retry_backoff_ms: 100,
        compression: :gzip,
        min_compression_batch_size: 1024
      ]}
   ]},
  restart_type: {:permanent, 10},
  shutdown: :infinity,
  child_type: :supervisor
]
22:22:54.576 [info]     :supervisor: {#PID<0.582.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.583.0>,
  id: 0,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     0,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :gzip,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
22:22:54.579 [info]     :supervisor: {#PID<0.582.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.584.0>,
  id: 1,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     1,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :gzip,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
22:22:54.580 [info]     :supervisor: {#PID<0.582.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.585.0>,
  id: 2,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     2,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :gzip,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
22:22:55.893 [error] client :kaffe_producer_client failed to connect to kafka3:9092
reason:{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
22:22:55.897 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
22:22:56.220 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
22:22:56.222 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
22:22:56.509 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
22:22:56.511 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
22:22:56.798 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
22:22:56.801 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
22:22:58.192 [error] client :kaffe_producer_client failed to connect to kafka3:9092
reason:{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
22:22:58.193 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
22:22:58.502 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
22:22:58.503 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
22:22:58.504 [error] GenServer #PID<0.583.0> terminating
** (stop) {:reached_max_retries, :no_leader_connection}
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer_buffer.erl:312: :brod_producer_buffer.rebuffer_or_crash/3
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer_buffer.erl:296: :brod_producer_buffer.do_send/4
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer.erl:525: :brod_producer.maybe_produce/1
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer.erl:325: :brod_producer.handle_info/2
    (stdlib 5.1.1) gen_server.erl:1077: :gen_server.try_handle_info/3
    (stdlib 5.1.1) gen_server.erl:1165: :gen_server.handle_msg/6
    (stdlib 5.1.1) proc_lib.erl:241: :proc_lib.init_p_do_apply/3
Last message: :retry
State: {:state, #PID<0.253.0>, "kafka-topic-test", 0, :undefined, :undefined, {:buf, 512, 1, 1048576, 5, 0, 0, {&:brod_producer.do_send_fun/4, {"kafka-topic-test", 0, 1, 1000, :gzip}}, 1, 0, {[], []}, {[], []}, []}, 100, #Reference<0.429255963.1304166402.93750>, :undefined, {:default, 0}}
22:22:58.526 [info] Sent 1 messages to topic kafka-topic-test in 4192 ms
22:22:58.527 [info] Sent messages to topic kafka-topic-test in "{\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"charged_to\":[{\"amount\":0,\"balance_name\":\"uncapped\",\"qty\":165681}],\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"cost\":0.0,\"status\":400,\"quantity\":165681,\"primary_service\":\"5G Home X\",\"allocated_qty\":165681,\"type\":100,\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\",\"connection_surcharge\":0,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"end_time\":\"2024-01-19T11:35:00+00:00\",\"meta\":{\"chargingId\":375767394,\"consumed\":{\"6000\":{\"allocated_cost\":0,\"allocated_qty\":0,\"cost\":0,\"end_time\":\"2024-01-19T13:35:00+02:00\",\"quantity\":165681,\"session_status\":300,\"start_time\":\"2024-01-19T13:25:17+02:00\",\"uncharged\":0}},\"ipv4_addr\":\"10.209.0.26\",\"oneTimeEvent\":false,\"ratType\":\"NR\",\"requestor\":\"satest\",\"resource_id\":\"imei-861935050829590\",\"service_id\":\"msisdn-27816699304\",\"userLocationinfo\":{\"eutraLocation\":null,\"n3gaLocation\":null,\"nrLocation\":{\"ageOfLocationInformation\":null,\"geodeticInformation\":null,\"geographicalInformation\":null,\"globalGnbId\":null,\"ignoreNcgi\":null,\"ncgi\":{\"nid\":null,\"nrCellId\":\"0d1414033\",\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"}},\"tai\":{\"nid\":null,\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"},\"tac\":\"07F394\"},\"ueLocationTimestamp\":\"2024-01-19T13:25:15+02:00\"}}},\"rating_group\":6000,\"uncharged\":null,\"charged_for\":\"Unlimited home 5G Premium\",\"rg_meta\":{\"mode\":\"ONLINE\",\"sessionFailover\":\"FAILOVER_NOT_SUPPORTED\"},\"start_time\":\"2024-01-19T11:25:18+00:00\",\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"rounding_policy\":\"1.110000\",\"unit_rate\":0,\"sub_id\":\"imsi-655730000598400\",\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"tp_meta\":{\"default_quota\":{\"name\":\"totalVolume\",\"quota\":57982058496},\"final_unit\":{\"finalUnitAction\":\"TERMINATE\"},\"model\":\"POST-PAID\",\"neg_balances\":false,\"policy_states\":[\"High Speed\",\"RICA\",\"Device\",\"Payment\",\"PAYMENT_HOLD\"],\"quota_calc\":\"default\",\"quota_rules\":[],\"unit_info\":{\"quotaHoldingTime\":0,\"timeQuotaThreshold\":70,\"triggers\":[{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_THRESHOLD\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_EXHAUSTED\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QHT\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"VALIDITY_TIME\"}],\"unitQuotaThreshold\":80,\"validityTime\":43200},\"vqt_percentage\":0.4},\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"item_seq_num\":1,\"applies_to\":{\"balances\":[\"uncapped\"],\"service_type\":\"mobile_data\"},\"description\":null,\"unit\":{\"downlinkVolume\":0,\"eventTimeStamp\":null,\"serviceSpecificUnits\":null,\"time\":null,\"totalVolume\":165681,\"triggerTimestamp\":\"2024-01-19T13:35:01+02:00\",\"triggers\":[{\"maxNumberOfccc\":null,\"timeLimit\":null,\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"FINAL\",\"volumeLimit\":null,\"volumeLimit64\":null}],\"uplinkVolume\":165681},\"post_surcharge\":0,\"tariff_plan\":\"5G Home X\",\"taxes\":{\"fixed\":0,\"gl\":\"9500A030\",\"name\":\"VAT\",\"percentage\":15,\"tax_amount\":0.0,\"tax_inclusive_amount\":0.0,\"taxable_amount\":0},\"allocated_cost\":0.0,\"error\":null}"
22:22:58.527 [info] Sent 1 messages to topic kafka-topic-test in 4192 ms
22:23:03.527 [info]     :supervisor: {#PID<0.582.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.594.0>,
  id: 0,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     0,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :gzip,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
22:24:23.452 [info]     :supervisor: {:local, :brod_sup}
    :started: [
  pid: #PID<0.253.0>,
  id: :kaffe_producer_client,
  mfargs: {:brod_client, :start_link,
   [
     [{~c"13.40.7.67", 9092}],
     :kaffe_producer_client,
     [
       auto_start_producers: true,
       allow_topic_auto_creation: false,
       default_producer_config: [
         required_acks: 1,
         ack_timeout: 1000,
         partition_buffer_limit: 512,
         partition_onwire_limit: 1,
         max_batch_size: 1048576,
         max_retries: 5,
         retry_backoff_ms: 100,
         compression: :no_compression,
         min_compression_batch_size: 1024
       ]
     ]
   ]},
  restart_type: {:permanent, 10},
  shutdown: 5000,
  child_type: :worker
]
22:24:26.740 [info] Running KafkaClusterWeb.Endpoint with cowboy 2.12.0 at 0.0.0.0:4080 (http)
22:24:26.753 [info] Access KafkaClusterWeb.Endpoint at http://localhost:4080
22:24:26.920 [info] Thoma
22:24:29.537 [info] Payload :: "{\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"allocated_cost\":0.0,\"uncharged\":null,\"allocated_qty\":165681,\"applies_to\":{\"balances\": [\"uncapped\"], \"service_type\": \"mobile_data\"},\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"charged_for\":\"Unlimited home 5G Premium\",\"charged_to\":[{\"qty\": 165681, \"amount\": 0, \"balance_name\": \"uncapped\"}],\"connection_surcharge\":0,\"cost\":0.0,\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"description\":null,\"end_time\":\"2024-01-19T11:35:00+00:00\",\"item_seq_num\":1,\"meta\":{\"ratType\": \"NR\", \"consumed\": {\"6000\": {\"cost\": 0, \"end_time\": \"2024-01-19T13:35:00+02:00\", \"quantity\": 165681, \"uncharged\": 0, \"start_time\": \"2024-01-19T13:25:17+02:00\", \"allocated_qty\": 0, \"allocated_cost\": 0, \"session_status\": 300}}, \"ipv4_addr\": \"10.209.0.26\", \"requestor\": \"satest\", \"chargingId\": 375767394, \"service_id\": \"msisdn-27816699304\", \"resource_id\": \"imei-861935050829590\", \"oneTimeEvent\": false, \"userLocationinfo\": {\"nrLocation\": {\"tai\": {\"nid\": null, \"tac\": \"07F394\", \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}}, \"ncgi\": {\"nid\": null, \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}, \"nrCellId\": \"0d1414033\"}, \"ignoreNcgi\": null, \"globalGnbId\": null, \"geodeticInformation\": null, \"ueLocationTimestamp\": \"2024-01-19T13:25:15+02:00\", \"geographicalInformation\": null, \"ageOfLocationInformation\": null}, \"n3gaLocation\": null, \"eutraLocation\": null}},\"post_surcharge\":0,\"primary_service\":\"5G Home X\",\"quantity\":165681,\"rating_group\":6000,\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"rg_meta\":{\"mode\": \"ONLINE\", \"sessionFailover\": \"FAILOVER_NOT_SUPPORTED\"},\"rounding_policy\":\"1.110000\",\"start_time\":\"2024-01-19T11:25:18+00:00\",\"status\":400,\"sub_id\":\"imsi-655730000598400\",\"tariff_plan\":\"5G Home X\",\"taxes\":{\"gl\": \"9500A030\", \"name\": \"VAT\", \"fixed\": 0, \"percentage\": 15, \"tax_amount\": 0.0, \"taxable_amount\": 0, \"tax_inclusive_amount\": 0.0},\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"tp_meta\":{\"model\": \"POST-PAID\", \"unit_info\": {\"triggers\": [{\"triggerType\": \"QUOTA_THRESHOLD\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QUOTA_EXHAUSTED\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QHT\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"VALIDITY_TIME\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"validityTime\": 43200, \"quotaHoldingTime\": 0, \"timeQuotaThreshold\": 70, \"unitQuotaThreshold\": 80}, \"final_unit\": {\"finalUnitAction\": \"TERMINATE\"}, \"quota_calc\": \"default\", \"quota_rules\": [], \"neg_balances\": false, \"default_quota\": {\"name\": \"totalVolume\", \"quota\": 57982058496}, \"policy_states\": [\"High Speed\", \"RICA\", \"Device\", \"Payment\", \"PAYMENT_HOLD\"], \"vqt_percentage\": 0.4},\"type\":100,\"unit\":{\"time\": null, \"triggers\": [{\"timeLimit\": null, \"triggerType\": \"FINAL\", \"volumeLimit\": null, \"volumeLimit64\": null, \"maxNumberOfccc\": null, \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"totalVolume\": 165681, \"uplinkVolume\": 165681, \"downlinkVolume\": 0, \"eventTimeStamp\": null, \"triggerTimestamp\": \"2024-01-19T13:35:01+02:00\", \"serviceSpecificUnits\": null},\"unit_rate\":0,\"error\":null,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\"}"
22:24:29.540 [info] Decoded Payload :: %{"timestamp" => "2024-01-19T11:35:01+00:00", "charged_to" => [%{"amount" => 0, "balance_name" => "uncapped", "qty" => 165681}], "id" => "\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035", "cost" => 0.0, "status" => 400, "quantity" => 165681, "primary_service" => "5G Home X", "allocated_qty" => 165681, "type" => 100, "service_id" => "a72e5f19-6245-4d24-8f69-3bf4bf215895", "connection_surcharge" => 0, "inserted_at" => "2024-01-19T11:35:32+00:00", "updated_at" => "2024-01-19T11:35:32+00:00", "end_time" => "2024-01-19T11:35:00+00:00", "meta" => %{"chargingId" => 375767394, "consumed" => %{"6000" => %{"allocated_cost" => 0, "allocated_qty" => 0, "cost" => 0, "end_time" => "2024-01-19T13:35:00+02:00", "quantity" => 165681, "session_status" => 300, "start_time" => "2024-01-19T13:25:17+02:00", "uncharged" => 0}}, "ipv4_addr" => "10.209.0.26", "oneTimeEvent" => false, "ratType" => "NR", "requestor" => "satest", "resource_id" => "imei-861935050829590", "service_id" => "msisdn-27816699304", "userLocationinfo" => %{"eutraLocation" => nil, "n3gaLocation" => nil, "nrLocation" => %{"ageOfLocationInformation" => nil, "geodeticInformation" => nil, "geographicalInformation" => nil, "globalGnbId" => nil, "ignoreNcgi" => nil, "ncgi" => %{"nid" => nil, "nrCellId" => "0d1414033", "plmnId" => %{"mcc" => "655", "mnc" => "73"}}, "tai" => %{"nid" => nil, "plmnId" => %{"mcc" => "655", "mnc" => "73"}, "tac" => "07F394"}, "ueLocationTimestamp" => "2024-01-19T13:25:15+02:00"}}}, "rating_group" => 6000, "uncharged" => nil, "charged_for" => "Unlimited home 5G Premium", "rg_meta" => %{"mode" => "ONLINE", "sessionFailover" => "FAILOVER_NOT_SUPPORTED"}, "start_time" => "2024-01-19T11:25:18+00:00", "c_id" => "20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2", "rounding_policy" => "1.110000", "unit_rate" => 0, "sub_id" => "imsi-655730000598400", "cr_id" => "20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2", "tp_meta" => %{"default_quota" => %{"name" => "totalVolume", "quota" => 57982058496}, "final_unit" => %{"finalUnitAction" => "TERMINATE"}, "model" => "POST-PAID", "neg_balances" => false, "policy_states" => ["High Speed", "RICA", "Device", "Payment", "PAYMENT_HOLD"], "quota_calc" => "default", "quota_rules" => [], "unit_info" => %{"quotaHoldingTime" => 0, "timeQuotaThreshold" => 70, "triggers" => [%{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_THRESHOLD"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_EXHAUSTED"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QHT"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "VALIDITY_TIME"}], "unitQuotaThreshold" => 80, "validityTime" => 43200}, "vqt_percentage" => 0.4}, "requestor_node_id" => "trc_udg_upf_01", "requestor_service_id" => nil, "item_seq_num" => 1, "applies_to" => %{"balances" => ["uncapped"], "service_type" => "mobile_data"}, "description" => nil, "unit" => %{"downlinkVolume" => 0, "eventTimeStamp" => nil, "serviceSpecificUnits" => nil, "time" => nil, "totalVolume" => 165681, "triggerTimestamp" => "2024-01-19T13:35:01+02:00", "triggers" => [%{"maxNumberOfccc" => nil, "timeLimit" => nil, "triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "FINAL", "volumeLimit" => nil, "volumeLimit64" => nil}], "uplinkVolume" => 165681}, "post_surcharge" => 0, "tariff_plan" => "5G Home X", "taxes" => %{"fixed" => 0, "gl" => "9500A030", "name" => "VAT", "percentage" => 15, "tax_amount" => 0.0, "tax_inclusive_amount" => 0.0, "taxable_amount" => 0}, "allocated_cost" => 0.0, "error" => nil}
22:24:29.763 [info]     :supervisor: {#PID<0.329.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.582.0>,
  id: "kafka-topic-test",
  mfargs: {:supervisor3, :start_link,
   [
     :brod_producers_sup,
     {:brod_producers_sup2, #PID<0.253.0>, "kafka-topic-test",
      [
        required_acks: 1,
        ack_timeout: 1000,
        partition_buffer_limit: 512,
        partition_onwire_limit: 1,
        max_batch_size: 1048576,
        max_retries: 5,
        retry_backoff_ms: 100,
        compression: :no_compression,
        min_compression_batch_size: 1024
      ]}
   ]},
  restart_type: {:permanent, 10},
  shutdown: :infinity,
  child_type: :supervisor
]
22:24:29.789 [info]     :supervisor: {#PID<0.582.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.583.0>,
  id: 0,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     0,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :no_compression,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
22:24:29.791 [info]     :supervisor: {#PID<0.582.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.584.0>,
  id: 1,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     1,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :no_compression,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
22:24:29.792 [info]     :supervisor: {#PID<0.582.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.585.0>,
  id: 2,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     2,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :no_compression,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
22:24:31.115 [error] client :kaffe_producer_client failed to connect to kafka3:9092
reason:{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
22:24:31.118 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
22:24:31.420 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
22:24:31.420 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
22:24:31.711 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
22:24:31.713 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
22:24:31.999 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
22:24:32.000 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
22:24:33.343 [error] client :kaffe_producer_client failed to connect to kafka3:9092
reason:{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
22:24:33.344 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
22:24:33.629 [error] :kaffe_producer_client (re)connect to kafka3:9092 aborted.
last failure: {:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
22:24:33.630 [warning] Failed to (re)init connection, reason:
{:nxdomain,
 [
   {:kpro_connection, :connect, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 207
    ]},
   {:kpro_connection, :init, 4,
    [
      file: ~c"/home/hataluli/TauSpace/2024/july/kafka_cluster/deps/kafka_protocol/src/kpro_connection.erl",
      line: 170
    ]},
   {:proc_lib, :init_p_do_apply, 3, [file: ~c"proc_lib.erl", line: 241]}
 ]}
22:24:33.632 [error] GenServer #PID<0.583.0> terminating
** (stop) {:reached_max_retries, :no_leader_connection}
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer_buffer.erl:312: :brod_producer_buffer.rebuffer_or_crash/3
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer_buffer.erl:296: :brod_producer_buffer.do_send/4
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer.erl:525: :brod_producer.maybe_produce/1
    (brod 3.15.6) /home/hataluli/TauSpace/2024/july/kafka_cluster/deps/brod/src/brod_producer.erl:325: :brod_producer.handle_info/2
    (stdlib 5.1.1) gen_server.erl:1077: :gen_server.try_handle_info/3
    (stdlib 5.1.1) gen_server.erl:1165: :gen_server.handle_msg/6
    (stdlib 5.1.1) proc_lib.erl:241: :proc_lib.init_p_do_apply/3
Last message: :retry
State: {:state, #PID<0.253.0>, "kafka-topic-test", 0, :undefined, :undefined, {:buf, 512, 1, 1048576, 5, 0, 0, {&:brod_producer.do_send_fun/4, {"kafka-topic-test", 0, 1, 1000, :no_compression}}, 1, 0, {[], []}, {[], []}, []}, 100, #Reference<0.3078122929.3451912197.231236>, :undefined, {:default, 0}}
22:24:33.648 [info] Sent 1 messages to topic kafka-topic-test in 4083 ms
22:24:33.649 [info] Sent messages to topic kafka-topic-test in "{\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"charged_to\":[{\"amount\":0,\"balance_name\":\"uncapped\",\"qty\":165681}],\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"cost\":0.0,\"status\":400,\"quantity\":165681,\"primary_service\":\"5G Home X\",\"allocated_qty\":165681,\"type\":100,\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\",\"connection_surcharge\":0,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"end_time\":\"2024-01-19T11:35:00+00:00\",\"meta\":{\"chargingId\":375767394,\"consumed\":{\"6000\":{\"allocated_cost\":0,\"allocated_qty\":0,\"cost\":0,\"end_time\":\"2024-01-19T13:35:00+02:00\",\"quantity\":165681,\"session_status\":300,\"start_time\":\"2024-01-19T13:25:17+02:00\",\"uncharged\":0}},\"ipv4_addr\":\"10.209.0.26\",\"oneTimeEvent\":false,\"ratType\":\"NR\",\"requestor\":\"satest\",\"resource_id\":\"imei-861935050829590\",\"service_id\":\"msisdn-27816699304\",\"userLocationinfo\":{\"eutraLocation\":null,\"n3gaLocation\":null,\"nrLocation\":{\"ageOfLocationInformation\":null,\"geodeticInformation\":null,\"geographicalInformation\":null,\"globalGnbId\":null,\"ignoreNcgi\":null,\"ncgi\":{\"nid\":null,\"nrCellId\":\"0d1414033\",\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"}},\"tai\":{\"nid\":null,\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"},\"tac\":\"07F394\"},\"ueLocationTimestamp\":\"2024-01-19T13:25:15+02:00\"}}},\"rating_group\":6000,\"uncharged\":null,\"charged_for\":\"Unlimited home 5G Premium\",\"rg_meta\":{\"mode\":\"ONLINE\",\"sessionFailover\":\"FAILOVER_NOT_SUPPORTED\"},\"start_time\":\"2024-01-19T11:25:18+00:00\",\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"rounding_policy\":\"1.110000\",\"unit_rate\":0,\"sub_id\":\"imsi-655730000598400\",\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"tp_meta\":{\"default_quota\":{\"name\":\"totalVolume\",\"quota\":57982058496},\"final_unit\":{\"finalUnitAction\":\"TERMINATE\"},\"model\":\"POST-PAID\",\"neg_balances\":false,\"policy_states\":[\"High Speed\",\"RICA\",\"Device\",\"Payment\",\"PAYMENT_HOLD\"],\"quota_calc\":\"default\",\"quota_rules\":[],\"unit_info\":{\"quotaHoldingTime\":0,\"timeQuotaThreshold\":70,\"triggers\":[{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_THRESHOLD\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_EXHAUSTED\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QHT\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"VALIDITY_TIME\"}],\"unitQuotaThreshold\":80,\"validityTime\":43200},\"vqt_percentage\":0.4},\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"item_seq_num\":1,\"applies_to\":{\"balances\":[\"uncapped\"],\"service_type\":\"mobile_data\"},\"description\":null,\"unit\":{\"downlinkVolume\":0,\"eventTimeStamp\":null,\"serviceSpecificUnits\":null,\"time\":null,\"totalVolume\":165681,\"triggerTimestamp\":\"2024-01-19T13:35:01+02:00\",\"triggers\":[{\"maxNumberOfccc\":null,\"timeLimit\":null,\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"FINAL\",\"volumeLimit\":null,\"volumeLimit64\":null}],\"uplinkVolume\":165681},\"post_surcharge\":0,\"tariff_plan\":\"5G Home X\",\"taxes\":{\"fixed\":0,\"gl\":\"9500A030\",\"name\":\"VAT\",\"percentage\":15,\"tax_amount\":0.0,\"tax_inclusive_amount\":0.0,\"taxable_amount\":0},\"allocated_cost\":0.0,\"error\":null}"
22:24:33.649 [info] Sent 1 messages to topic kafka-topic-test in 4083 ms
22:24:38.649 [info]     :supervisor: {#PID<0.582.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.594.0>,
  id: 0,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     0,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :no_compression,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
22:45:15.126 [info]     :supervisor: {:local, :brod_sup}
    :started: [
  pid: #PID<0.247.0>,
  id: :kaffe_producer_client,
  mfargs: {:brod_client, :start_link,
   [
     [{~c"13.40.7.67", 9092}],
     :kaffe_producer_client,
     [
       auto_start_producers: true,
       allow_topic_auto_creation: false,
       default_producer_config: [
         required_acks: 1,
         ack_timeout: 1000,
         partition_buffer_limit: 512,
         partition_onwire_limit: 1,
         max_batch_size: 1048576,
         max_retries: 5,
         retry_backoff_ms: 100,
         compression: :no_compression,
         min_compression_batch_size: 1024
       ]
     ]
   ]},
  restart_type: {:permanent, 10},
  shutdown: 5000,
  child_type: :worker
]
22:45:18.081 [info] Running KafkaClusterWeb.Endpoint with cowboy 2.12.0 at 0.0.0.0:4080 (http)
22:45:18.130 [info] Access KafkaClusterWeb.Endpoint at http://localhost:4080
22:45:18.247 [info] Thoma
05:23:16.544 [info] Payload :: "{\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"allocated_cost\":0.0,\"uncharged\":null,\"allocated_qty\":165681,\"applies_to\":{\"balances\": [\"uncapped\"], \"service_type\": \"mobile_data\"},\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"charged_for\":\"Unlimited home 5G Premium\",\"charged_to\":[{\"qty\": 165681, \"amount\": 0, \"balance_name\": \"uncapped\"}],\"connection_surcharge\":0,\"cost\":0.0,\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"description\":null,\"end_time\":\"2024-01-19T11:35:00+00:00\",\"item_seq_num\":1,\"meta\":{\"ratType\": \"NR\", \"consumed\": {\"6000\": {\"cost\": 0, \"end_time\": \"2024-01-19T13:35:00+02:00\", \"quantity\": 165681, \"uncharged\": 0, \"start_time\": \"2024-01-19T13:25:17+02:00\", \"allocated_qty\": 0, \"allocated_cost\": 0, \"session_status\": 300}}, \"ipv4_addr\": \"10.209.0.26\", \"requestor\": \"satest\", \"chargingId\": 375767394, \"service_id\": \"msisdn-27816699304\", \"resource_id\": \"imei-861935050829590\", \"oneTimeEvent\": false, \"userLocationinfo\": {\"nrLocation\": {\"tai\": {\"nid\": null, \"tac\": \"07F394\", \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}}, \"ncgi\": {\"nid\": null, \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}, \"nrCellId\": \"0d1414033\"}, \"ignoreNcgi\": null, \"globalGnbId\": null, \"geodeticInformation\": null, \"ueLocationTimestamp\": \"2024-01-19T13:25:15+02:00\", \"geographicalInformation\": null, \"ageOfLocationInformation\": null}, \"n3gaLocation\": null, \"eutraLocation\": null}},\"post_surcharge\":0,\"primary_service\":\"5G Home X\",\"quantity\":165681,\"rating_group\":6000,\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"rg_meta\":{\"mode\": \"ONLINE\", \"sessionFailover\": \"FAILOVER_NOT_SUPPORTED\"},\"rounding_policy\":\"1.110000\",\"start_time\":\"2024-01-19T11:25:18+00:00\",\"status\":400,\"sub_id\":\"imsi-655730000598400\",\"tariff_plan\":\"5G Home X\",\"taxes\":{\"gl\": \"9500A030\", \"name\": \"VAT\", \"fixed\": 0, \"percentage\": 15, \"tax_amount\": 0.0, \"taxable_amount\": 0, \"tax_inclusive_amount\": 0.0},\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"tp_meta\":{\"model\": \"POST-PAID\", \"unit_info\": {\"triggers\": [{\"triggerType\": \"QUOTA_THRESHOLD\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QUOTA_EXHAUSTED\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QHT\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"VALIDITY_TIME\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"validityTime\": 43200, \"quotaHoldingTime\": 0, \"timeQuotaThreshold\": 70, \"unitQuotaThreshold\": 80}, \"final_unit\": {\"finalUnitAction\": \"TERMINATE\"}, \"quota_calc\": \"default\", \"quota_rules\": [], \"neg_balances\": false, \"default_quota\": {\"name\": \"totalVolume\", \"quota\": 57982058496}, \"policy_states\": [\"High Speed\", \"RICA\", \"Device\", \"Payment\", \"PAYMENT_HOLD\"], \"vqt_percentage\": 0.4},\"type\":100,\"unit\":{\"time\": null, \"triggers\": [{\"timeLimit\": null, \"triggerType\": \"FINAL\", \"volumeLimit\": null, \"volumeLimit64\": null, \"maxNumberOfccc\": null, \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"totalVolume\": 165681, \"uplinkVolume\": 165681, \"downlinkVolume\": 0, \"eventTimeStamp\": null, \"triggerTimestamp\": \"2024-01-19T13:35:01+02:00\", \"serviceSpecificUnits\": null},\"unit_rate\":0,\"error\":null,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\"}"
05:23:16.552 [info] Decoded Payload :: %{"timestamp" => "2024-01-19T11:35:01+00:00", "charged_to" => [%{"amount" => 0, "balance_name" => "uncapped", "qty" => 165681}], "id" => "\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035", "cost" => 0.0, "status" => 400, "quantity" => 165681, "primary_service" => "5G Home X", "allocated_qty" => 165681, "type" => 100, "service_id" => "a72e5f19-6245-4d24-8f69-3bf4bf215895", "connection_surcharge" => 0, "inserted_at" => "2024-01-19T11:35:32+00:00", "updated_at" => "2024-01-19T11:35:32+00:00", "end_time" => "2024-01-19T11:35:00+00:00", "meta" => %{"chargingId" => 375767394, "consumed" => %{"6000" => %{"allocated_cost" => 0, "allocated_qty" => 0, "cost" => 0, "end_time" => "2024-01-19T13:35:00+02:00", "quantity" => 165681, "session_status" => 300, "start_time" => "2024-01-19T13:25:17+02:00", "uncharged" => 0}}, "ipv4_addr" => "10.209.0.26", "oneTimeEvent" => false, "ratType" => "NR", "requestor" => "satest", "resource_id" => "imei-861935050829590", "service_id" => "msisdn-27816699304", "userLocationinfo" => %{"eutraLocation" => nil, "n3gaLocation" => nil, "nrLocation" => %{"ageOfLocationInformation" => nil, "geodeticInformation" => nil, "geographicalInformation" => nil, "globalGnbId" => nil, "ignoreNcgi" => nil, "ncgi" => %{"nid" => nil, "nrCellId" => "0d1414033", "plmnId" => %{"mcc" => "655", "mnc" => "73"}}, "tai" => %{"nid" => nil, "plmnId" => %{"mcc" => "655", "mnc" => "73"}, "tac" => "07F394"}, "ueLocationTimestamp" => "2024-01-19T13:25:15+02:00"}}}, "rating_group" => 6000, "uncharged" => nil, "charged_for" => "Unlimited home 5G Premium", "rg_meta" => %{"mode" => "ONLINE", "sessionFailover" => "FAILOVER_NOT_SUPPORTED"}, "start_time" => "2024-01-19T11:25:18+00:00", "c_id" => "20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2", "rounding_policy" => "1.110000", "unit_rate" => 0, "sub_id" => "imsi-655730000598400", "cr_id" => "20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2", "tp_meta" => %{"default_quota" => %{"name" => "totalVolume", "quota" => 57982058496}, "final_unit" => %{"finalUnitAction" => "TERMINATE"}, "model" => "POST-PAID", "neg_balances" => false, "policy_states" => ["High Speed", "RICA", "Device", "Payment", "PAYMENT_HOLD"], "quota_calc" => "default", "quota_rules" => [], "unit_info" => %{"quotaHoldingTime" => 0, "timeQuotaThreshold" => 70, "triggers" => [%{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_THRESHOLD"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_EXHAUSTED"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QHT"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "VALIDITY_TIME"}], "unitQuotaThreshold" => 80, "validityTime" => 43200}, "vqt_percentage" => 0.4}, "requestor_node_id" => "trc_udg_upf_01", "requestor_service_id" => nil, "item_seq_num" => 1, "applies_to" => %{"balances" => ["uncapped"], "service_type" => "mobile_data"}, "description" => nil, "unit" => %{"downlinkVolume" => 0, "eventTimeStamp" => nil, "serviceSpecificUnits" => nil, "time" => nil, "totalVolume" => 165681, "triggerTimestamp" => "2024-01-19T13:35:01+02:00", "triggers" => [%{"maxNumberOfccc" => nil, "timeLimit" => nil, "triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "FINAL", "volumeLimit" => nil, "volumeLimit64" => nil}], "uplinkVolume" => 165681}, "post_surcharge" => 0, "tariff_plan" => "5G Home X", "taxes" => %{"fixed" => 0, "gl" => "9500A030", "name" => "VAT", "percentage" => 15, "tax_amount" => 0.0, "tax_inclusive_amount" => 0.0, "taxable_amount" => 0}, "allocated_cost" => 0.0, "error" => nil}
05:23:17.222 [info]     :supervisor: {#PID<0.354.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.786.0>,
  id: "kafka-topic-test",
  mfargs: {:supervisor3, :start_link,
   [
     :brod_producers_sup,
     {:brod_producers_sup2, #PID<0.247.0>, "kafka-topic-test",
      [
        required_acks: 1,
        ack_timeout: 1000,
        partition_buffer_limit: 512,
        partition_onwire_limit: 1,
        max_batch_size: 1048576,
        max_retries: 5,
        retry_backoff_ms: 100,
        compression: :no_compression,
        min_compression_batch_size: 1024
      ]}
   ]},
  restart_type: {:permanent, 10},
  shutdown: :infinity,
  child_type: :supervisor
]
05:23:17.248 [info]     :supervisor: {#PID<0.786.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.787.0>,
  id: 0,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.247.0>,
     "kafka-topic-test",
     0,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :no_compression,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
05:23:17.250 [info]     :supervisor: {#PID<0.786.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.788.0>,
  id: 1,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.247.0>,
     "kafka-topic-test",
     1,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :no_compression,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
05:23:17.251 [info]     :supervisor: {#PID<0.786.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.789.0>,
  id: 2,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.247.0>,
     "kafka-topic-test",
     2,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :no_compression,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
05:23:17.799 [info] client :kaffe_producer_client connected to kafka3:9092

05:23:18.066 [info] Sent 1 messages to topic kafka-topic-test in 1447 ms
05:23:18.067 [info] Sent messages to topic kafka-topic-test in "{\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"charged_to\":[{\"amount\":0,\"balance_name\":\"uncapped\",\"qty\":165681}],\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"cost\":0.0,\"status\":400,\"quantity\":165681,\"primary_service\":\"5G Home X\",\"allocated_qty\":165681,\"type\":100,\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\",\"connection_surcharge\":0,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"end_time\":\"2024-01-19T11:35:00+00:00\",\"meta\":{\"chargingId\":375767394,\"consumed\":{\"6000\":{\"allocated_cost\":0,\"allocated_qty\":0,\"cost\":0,\"end_time\":\"2024-01-19T13:35:00+02:00\",\"quantity\":165681,\"session_status\":300,\"start_time\":\"2024-01-19T13:25:17+02:00\",\"uncharged\":0}},\"ipv4_addr\":\"10.209.0.26\",\"oneTimeEvent\":false,\"ratType\":\"NR\",\"requestor\":\"satest\",\"resource_id\":\"imei-861935050829590\",\"service_id\":\"msisdn-27816699304\",\"userLocationinfo\":{\"eutraLocation\":null,\"n3gaLocation\":null,\"nrLocation\":{\"ageOfLocationInformation\":null,\"geodeticInformation\":null,\"geographicalInformation\":null,\"globalGnbId\":null,\"ignoreNcgi\":null,\"ncgi\":{\"nid\":null,\"nrCellId\":\"0d1414033\",\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"}},\"tai\":{\"nid\":null,\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"},\"tac\":\"07F394\"},\"ueLocationTimestamp\":\"2024-01-19T13:25:15+02:00\"}}},\"rating_group\":6000,\"uncharged\":null,\"charged_for\":\"Unlimited home 5G Premium\",\"rg_meta\":{\"mode\":\"ONLINE\",\"sessionFailover\":\"FAILOVER_NOT_SUPPORTED\"},\"start_time\":\"2024-01-19T11:25:18+00:00\",\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"rounding_policy\":\"1.110000\",\"unit_rate\":0,\"sub_id\":\"imsi-655730000598400\",\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"tp_meta\":{\"default_quota\":{\"name\":\"totalVolume\",\"quota\":57982058496},\"final_unit\":{\"finalUnitAction\":\"TERMINATE\"},\"model\":\"POST-PAID\",\"neg_balances\":false,\"policy_states\":[\"High Speed\",\"RICA\",\"Device\",\"Payment\",\"PAYMENT_HOLD\"],\"quota_calc\":\"default\",\"quota_rules\":[],\"unit_info\":{\"quotaHoldingTime\":0,\"timeQuotaThreshold\":70,\"triggers\":[{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_THRESHOLD\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_EXHAUSTED\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QHT\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"VALIDITY_TIME\"}],\"unitQuotaThreshold\":80,\"validityTime\":43200},\"vqt_percentage\":0.4},\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"item_seq_num\":1,\"applies_to\":{\"balances\":[\"uncapped\"],\"service_type\":\"mobile_data\"},\"description\":null,\"unit\":{\"downlinkVolume\":0,\"eventTimeStamp\":null,\"serviceSpecificUnits\":null,\"time\":null,\"totalVolume\":165681,\"triggerTimestamp\":\"2024-01-19T13:35:01+02:00\",\"triggers\":[{\"maxNumberOfccc\":null,\"timeLimit\":null,\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"FINAL\",\"volumeLimit\":null,\"volumeLimit64\":null}],\"uplinkVolume\":165681},\"post_surcharge\":0,\"tariff_plan\":\"5G Home X\",\"taxes\":{\"fixed\":0,\"gl\":\"9500A030\",\"name\":\"VAT\",\"percentage\":15,\"tax_amount\":0.0,\"tax_inclusive_amount\":0.0,\"taxable_amount\":0},\"allocated_cost\":0.0,\"error\":null}"
05:23:18.067 [info] Sent 1 messages to topic kafka-topic-test in 1447 ms
05:25:05.382 [info]     :supervisor: {:local, :brod_sup}
    :started: [
  pid: #PID<0.253.0>,
  id: :kaffe_producer_client,
  mfargs: {:brod_client, :start_link,
   [
     [{~c"13.40.7.67", 9092}],
     :kaffe_producer_client,
     [
       auto_start_producers: true,
       allow_topic_auto_creation: false,
       default_producer_config: [
         required_acks: 1,
         ack_timeout: 1000,
         partition_buffer_limit: 512,
         partition_onwire_limit: 1,
         max_batch_size: 1048576,
         max_retries: 5,
         retry_backoff_ms: 100,
         compression: :gzip,
         min_compression_batch_size: 1024
       ]
     ]
   ]},
  restart_type: {:permanent, 10},
  shutdown: 5000,
  child_type: :worker
]
05:25:08.202 [info] Running KafkaClusterWeb.Endpoint with cowboy 2.12.0 at 0.0.0.0:4080 (http)
05:25:08.215 [info] Access KafkaClusterWeb.Endpoint at http://localhost:4080
05:25:08.362 [info] Thoma
05:25:26.846 [info] Payload :: "{\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"allocated_cost\":0.0,\"uncharged\":null,\"allocated_qty\":165681,\"applies_to\":{\"balances\": [\"uncapped\"], \"service_type\": \"mobile_data\"},\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"charged_for\":\"Unlimited home 5G Premium\",\"charged_to\":[{\"qty\": 165681, \"amount\": 0, \"balance_name\": \"uncapped\"}],\"connection_surcharge\":0,\"cost\":0.0,\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"description\":null,\"end_time\":\"2024-01-19T11:35:00+00:00\",\"item_seq_num\":1,\"meta\":{\"ratType\": \"NR\", \"consumed\": {\"6000\": {\"cost\": 0, \"end_time\": \"2024-01-19T13:35:00+02:00\", \"quantity\": 165681, \"uncharged\": 0, \"start_time\": \"2024-01-19T13:25:17+02:00\", \"allocated_qty\": 0, \"allocated_cost\": 0, \"session_status\": 300}}, \"ipv4_addr\": \"10.209.0.26\", \"requestor\": \"satest\", \"chargingId\": 375767394, \"service_id\": \"msisdn-27816699304\", \"resource_id\": \"imei-861935050829590\", \"oneTimeEvent\": false, \"userLocationinfo\": {\"nrLocation\": {\"tai\": {\"nid\": null, \"tac\": \"07F394\", \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}}, \"ncgi\": {\"nid\": null, \"plmnId\": {\"mcc\": \"655\", \"mnc\": \"73\"}, \"nrCellId\": \"0d1414033\"}, \"ignoreNcgi\": null, \"globalGnbId\": null, \"geodeticInformation\": null, \"ueLocationTimestamp\": \"2024-01-19T13:25:15+02:00\", \"geographicalInformation\": null, \"ageOfLocationInformation\": null}, \"n3gaLocation\": null, \"eutraLocation\": null}},\"post_surcharge\":0,\"primary_service\":\"5G Home X\",\"quantity\":165681,\"rating_group\":6000,\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"rg_meta\":{\"mode\": \"ONLINE\", \"sessionFailover\": \"FAILOVER_NOT_SUPPORTED\"},\"rounding_policy\":\"1.110000\",\"start_time\":\"2024-01-19T11:25:18+00:00\",\"status\":400,\"sub_id\":\"imsi-655730000598400\",\"tariff_plan\":\"5G Home X\",\"taxes\":{\"gl\": \"9500A030\", \"name\": \"VAT\", \"fixed\": 0, \"percentage\": 15, \"tax_amount\": 0.0, \"taxable_amount\": 0, \"tax_inclusive_amount\": 0.0},\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"tp_meta\":{\"model\": \"POST-PAID\", \"unit_info\": {\"triggers\": [{\"triggerType\": \"QUOTA_THRESHOLD\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QUOTA_EXHAUSTED\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"QHT\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}, {\"triggerType\": \"VALIDITY_TIME\", \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"validityTime\": 43200, \"quotaHoldingTime\": 0, \"timeQuotaThreshold\": 70, \"unitQuotaThreshold\": 80}, \"final_unit\": {\"finalUnitAction\": \"TERMINATE\"}, \"quota_calc\": \"default\", \"quota_rules\": [], \"neg_balances\": false, \"default_quota\": {\"name\": \"totalVolume\", \"quota\": 57982058496}, \"policy_states\": [\"High Speed\", \"RICA\", \"Device\", \"Payment\", \"PAYMENT_HOLD\"], \"vqt_percentage\": 0.4},\"type\":100,\"unit\":{\"time\": null, \"triggers\": [{\"timeLimit\": null, \"triggerType\": \"FINAL\", \"volumeLimit\": null, \"volumeLimit64\": null, \"maxNumberOfccc\": null, \"triggerCategory\": \"IMMEDIATE_REPORT\"}], \"totalVolume\": 165681, \"uplinkVolume\": 165681, \"downlinkVolume\": 0, \"eventTimeStamp\": null, \"triggerTimestamp\": \"2024-01-19T13:35:01+02:00\", \"serviceSpecificUnits\": null},\"unit_rate\":0,\"error\":null,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\"}"
05:25:26.848 [info] Decoded Payload :: %{"timestamp" => "2024-01-19T11:35:01+00:00", "charged_to" => [%{"amount" => 0, "balance_name" => "uncapped", "qty" => 165681}], "id" => "\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035", "cost" => 0.0, "status" => 400, "quantity" => 165681, "primary_service" => "5G Home X", "allocated_qty" => 165681, "type" => 100, "service_id" => "a72e5f19-6245-4d24-8f69-3bf4bf215895", "connection_surcharge" => 0, "inserted_at" => "2024-01-19T11:35:32+00:00", "updated_at" => "2024-01-19T11:35:32+00:00", "end_time" => "2024-01-19T11:35:00+00:00", "meta" => %{"chargingId" => 375767394, "consumed" => %{"6000" => %{"allocated_cost" => 0, "allocated_qty" => 0, "cost" => 0, "end_time" => "2024-01-19T13:35:00+02:00", "quantity" => 165681, "session_status" => 300, "start_time" => "2024-01-19T13:25:17+02:00", "uncharged" => 0}}, "ipv4_addr" => "10.209.0.26", "oneTimeEvent" => false, "ratType" => "NR", "requestor" => "satest", "resource_id" => "imei-861935050829590", "service_id" => "msisdn-27816699304", "userLocationinfo" => %{"eutraLocation" => nil, "n3gaLocation" => nil, "nrLocation" => %{"ageOfLocationInformation" => nil, "geodeticInformation" => nil, "geographicalInformation" => nil, "globalGnbId" => nil, "ignoreNcgi" => nil, "ncgi" => %{"nid" => nil, "nrCellId" => "0d1414033", "plmnId" => %{"mcc" => "655", "mnc" => "73"}}, "tai" => %{"nid" => nil, "plmnId" => %{"mcc" => "655", "mnc" => "73"}, "tac" => "07F394"}, "ueLocationTimestamp" => "2024-01-19T13:25:15+02:00"}}}, "rating_group" => 6000, "uncharged" => nil, "charged_for" => "Unlimited home 5G Premium", "rg_meta" => %{"mode" => "ONLINE", "sessionFailover" => "FAILOVER_NOT_SUPPORTED"}, "start_time" => "2024-01-19T11:25:18+00:00", "c_id" => "20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2", "rounding_policy" => "1.110000", "unit_rate" => 0, "sub_id" => "imsi-655730000598400", "cr_id" => "20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2", "tp_meta" => %{"default_quota" => %{"name" => "totalVolume", "quota" => 57982058496}, "final_unit" => %{"finalUnitAction" => "TERMINATE"}, "model" => "POST-PAID", "neg_balances" => false, "policy_states" => ["High Speed", "RICA", "Device", "Payment", "PAYMENT_HOLD"], "quota_calc" => "default", "quota_rules" => [], "unit_info" => %{"quotaHoldingTime" => 0, "timeQuotaThreshold" => 70, "triggers" => [%{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_THRESHOLD"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_EXHAUSTED"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QHT"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "VALIDITY_TIME"}], "unitQuotaThreshold" => 80, "validityTime" => 43200}, "vqt_percentage" => 0.4}, "requestor_node_id" => "trc_udg_upf_01", "requestor_service_id" => nil, "item_seq_num" => 1, "applies_to" => %{"balances" => ["uncapped"], "service_type" => "mobile_data"}, "description" => nil, "unit" => %{"downlinkVolume" => 0, "eventTimeStamp" => nil, "serviceSpecificUnits" => nil, "time" => nil, "totalVolume" => 165681, "triggerTimestamp" => "2024-01-19T13:35:01+02:00", "triggers" => [%{"maxNumberOfccc" => nil, "timeLimit" => nil, "triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "FINAL", "volumeLimit" => nil, "volumeLimit64" => nil}], "uplinkVolume" => 165681}, "post_surcharge" => 0, "tariff_plan" => "5G Home X", "taxes" => %{"fixed" => 0, "gl" => "9500A030", "name" => "VAT", "percentage" => 15, "tax_amount" => 0.0, "tax_inclusive_amount" => 0.0, "taxable_amount" => 0}, "allocated_cost" => 0.0, "error" => nil}
05:25:27.064 [info]     :supervisor: {#PID<0.360.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.582.0>,
  id: "kafka-topic-test",
  mfargs: {:supervisor3, :start_link,
   [
     :brod_producers_sup,
     {:brod_producers_sup2, #PID<0.253.0>, "kafka-topic-test",
      [
        required_acks: 1,
        ack_timeout: 1000,
        partition_buffer_limit: 512,
        partition_onwire_limit: 1,
        max_batch_size: 1048576,
        max_retries: 5,
        retry_backoff_ms: 100,
        compression: :gzip,
        min_compression_batch_size: 1024
      ]}
   ]},
  restart_type: {:permanent, 10},
  shutdown: :infinity,
  child_type: :supervisor
]
05:25:27.081 [info]     :supervisor: {#PID<0.582.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.583.0>,
  id: 0,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     0,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :gzip,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
05:25:27.083 [info]     :supervisor: {#PID<0.582.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.584.0>,
  id: 1,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     1,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :gzip,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
05:25:27.083 [info]     :supervisor: {#PID<0.582.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.585.0>,
  id: 2,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.253.0>,
     "kafka-topic-test",
     2,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :gzip,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
05:25:27.635 [info] client :kaffe_producer_client connected to kafka3:9092

05:25:27.888 [info] Sent 1 messages to topic kafka-topic-test in 1020 ms
05:25:27.889 [info] Sent messages to topic kafka-topic-test in "{\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"charged_to\":[{\"amount\":0,\"balance_name\":\"uncapped\",\"qty\":165681}],\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"cost\":0.0,\"status\":400,\"quantity\":165681,\"primary_service\":\"5G Home X\",\"allocated_qty\":165681,\"type\":100,\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\",\"connection_surcharge\":0,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"end_time\":\"2024-01-19T11:35:00+00:00\",\"meta\":{\"chargingId\":375767394,\"consumed\":{\"6000\":{\"allocated_cost\":0,\"allocated_qty\":0,\"cost\":0,\"end_time\":\"2024-01-19T13:35:00+02:00\",\"quantity\":165681,\"session_status\":300,\"start_time\":\"2024-01-19T13:25:17+02:00\",\"uncharged\":0}},\"ipv4_addr\":\"10.209.0.26\",\"oneTimeEvent\":false,\"ratType\":\"NR\",\"requestor\":\"satest\",\"resource_id\":\"imei-861935050829590\",\"service_id\":\"msisdn-27816699304\",\"userLocationinfo\":{\"eutraLocation\":null,\"n3gaLocation\":null,\"nrLocation\":{\"ageOfLocationInformation\":null,\"geodeticInformation\":null,\"geographicalInformation\":null,\"globalGnbId\":null,\"ignoreNcgi\":null,\"ncgi\":{\"nid\":null,\"nrCellId\":\"0d1414033\",\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"}},\"tai\":{\"nid\":null,\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"},\"tac\":\"07F394\"},\"ueLocationTimestamp\":\"2024-01-19T13:25:15+02:00\"}}},\"rating_group\":6000,\"uncharged\":null,\"charged_for\":\"Unlimited home 5G Premium\",\"rg_meta\":{\"mode\":\"ONLINE\",\"sessionFailover\":\"FAILOVER_NOT_SUPPORTED\"},\"start_time\":\"2024-01-19T11:25:18+00:00\",\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"rounding_policy\":\"1.110000\",\"unit_rate\":0,\"sub_id\":\"imsi-655730000598400\",\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"tp_meta\":{\"default_quota\":{\"name\":\"totalVolume\",\"quota\":57982058496},\"final_unit\":{\"finalUnitAction\":\"TERMINATE\"},\"model\":\"POST-PAID\",\"neg_balances\":false,\"policy_states\":[\"High Speed\",\"RICA\",\"Device\",\"Payment\",\"PAYMENT_HOLD\"],\"quota_calc\":\"default\",\"quota_rules\":[],\"unit_info\":{\"quotaHoldingTime\":0,\"timeQuotaThreshold\":70,\"triggers\":[{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_THRESHOLD\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_EXHAUSTED\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QHT\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"VALIDITY_TIME\"}],\"unitQuotaThreshold\":80,\"validityTime\":43200},\"vqt_percentage\":0.4},\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"item_seq_num\":1,\"applies_to\":{\"balances\":[\"uncapped\"],\"service_type\":\"mobile_data\"},\"description\":null,\"unit\":{\"downlinkVolume\":0,\"eventTimeStamp\":null,\"serviceSpecificUnits\":null,\"time\":null,\"totalVolume\":165681,\"triggerTimestamp\":\"2024-01-19T13:35:01+02:00\",\"triggers\":[{\"maxNumberOfccc\":null,\"timeLimit\":null,\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"FINAL\",\"volumeLimit\":null,\"volumeLimit64\":null}],\"uplinkVolume\":165681},\"post_surcharge\":0,\"tariff_plan\":\"5G Home X\",\"taxes\":{\"fixed\":0,\"gl\":\"9500A030\",\"name\":\"VAT\",\"percentage\":15,\"tax_amount\":0.0,\"tax_inclusive_amount\":0.0,\"taxable_amount\":0},\"allocated_cost\":0.0,\"error\":null}"
05:25:27.889 [info] Sent 1 messages to topic kafka-topic-test in 1020 ms
05:35:28.009 [info] client :kaffe_producer_client: payload connection down kafka3:9092
reason:{:shutdown, :tcp_closed}
05:52:41.756 [info]     :supervisor: {:local, :brod_sup}
    :started: [
  pid: #PID<0.257.0>,
  id: :kaffe_producer_client,
  mfargs: {:brod_client, :start_link,
   [
     [{~c"13.40.7.67", 9092}],
     :kaffe_producer_client,
     [
       auto_start_producers: true,
       allow_topic_auto_creation: false,
       default_producer_config: [
         required_acks: 1,
         ack_timeout: 1000,
         partition_buffer_limit: 512,
         partition_onwire_limit: 1,
         max_batch_size: 1048576,
         max_retries: 5,
         retry_backoff_ms: 100,
         compression: :gzip,
         min_compression_batch_size: 1024
       ]
     ]
   ]},
  restart_type: {:permanent, 10},
  shutdown: 5000,
  child_type: :worker
]
05:52:45.174 [info] Running KafkaClusterWeb.Endpoint with cowboy 2.12.0 at 0.0.0.0:4080 (http)
05:52:45.196 [info] Access KafkaClusterWeb.Endpoint at http://localhost:4080
05:52:45.304 [info] ChargeListener started and listening for new_charge notifications
05:52:45.329 [info] Application kafka_cluster exited: KafkaCluster.Application.start(:normal, []) returned an error: shutdown: failed to start child: KafkaCluster.Kaffe.ChargeListener
    ** (EXIT) an exception was raised:
        ** (CaseClauseError) no case clause matching: {:ok, #Reference<0.1318013000.4058251268.184648>}
            (kafka_cluster 0.1.0) lib/kafka_cluster/kaffe/charge_listener.ex:20: KafkaCluster.Kaffe.ChargeListener.init/1
            (stdlib 5.1.1) gen_server.erl:962: :gen_server.init_it/2
            (stdlib 5.1.1) gen_server.erl:917: :gen_server.init_it/6
            (stdlib 5.1.1) proc_lib.erl:241: :proc_lib.init_p_do_apply/3
05:52:45.407 [info] Application logger_file_backend exited: :stopped
05:52:45.409 [info] Application gettext exited: :stopped
05:52:45.409 [info] Application expo exited: :stopped
05:52:45.411 [info] Application telemetry_poller exited: :stopped
05:52:45.414 [info] Application swoosh exited: :stopped
05:52:45.414 [info] Application finch exited: :stopped
05:52:45.414 [info] Application nimble_options exited: :stopped
05:52:45.422 [info] Application nimble_pool exited: :stopped
05:52:45.423 [info] Application mint exited: :stopped
05:52:45.424 [info] Application hpax exited: :stopped
05:52:45.424 [info] Application xmerl exited: :stopped
05:52:45.432 [info] Application tailwind exited: :stopped
05:52:45.437 [info] Application esbuild exited: :stopped
05:52:45.439 [info] Application phoenix_live_dashboard exited: :stopped
05:52:45.440 [info] Application telemetry_metrics exited: :stopped
05:52:45.443 [info] Application phoenix_live_view exited: :stopped
05:52:45.456 [info] Application phoenix_live_reload exited: :stopped
05:52:45.474 [info] Application file_system exited: :stopped
05:52:45.488 [info] Application ecto_sql exited: :stopped
05:52:45.490 [info] Application phoenix_ecto exited: :stopped
05:52:45.500 [info] Application postgrex exited: :stopped
05:52:45.706 [info] Application db_connection exited: :stopped
05:52:45.708 [info] Application ecto exited: :stopped
05:52:45.710 [info] Application phoenix exited: :stopped
05:52:45.711 [info] Application jason exited: :stopped
05:52:45.711 [info] Application decimal exited: :stopped
05:52:45.711 [info] Application castore exited: :stopped
05:52:45.712 [info] Application websock_adapter exited: :stopped
05:52:45.718 [info] Application plug_cowboy exited: :stopped
05:52:45.718 [info] Application cowboy_telemetry exited: :stopped
05:52:45.720 [info] Application cowboy exited: :stopped
05:52:45.727 [info] Application ranch exited: :stopped
05:52:45.728 [info] Application cowlib exited: :stopped
05:52:45.728 [info] Application websock exited: :stopped
05:52:45.728 [info] Application phoenix_template exited: :stopped
05:52:45.728 [info] Application phoenix_html exited: :stopped
05:52:45.730 [info] Application phoenix_pubsub exited: :stopped
05:52:45.731 [info] Application plug exited: :stopped
05:52:45.733 [info] Application telemetry exited: :stopped
05:52:45.735 [info] Application plug_crypto exited: :stopped
05:52:45.736 [info] Application mime exited: :stopped
05:52:45.736 [info] Application eex exited: :stopped
05:52:45.755 [info] Application kaffe exited: :stopped
05:52:45.758 [info] Application retry exited: :stopped
05:52:45.764 [info] Application brod exited: :stopped
05:52:45.765 [info] Application supervisor3 exited: :stopped
05:52:45.766 [info] Application kafka_protocol exited: :stopped
05:52:45.767 [info] Application crc32cer exited: :stopped
05:52:45.767 [info] Application snappyer exited: :stopped
05:52:45.769 [info] Application runtime_tools exited: :stopped
05:53:31.396 [info]     :supervisor: {:local, :brod_sup}
    :started: [
  pid: #PID<0.227.0>,
  id: :kaffe_producer_client,
  mfargs: {:brod_client, :start_link,
   [
     [{~c"13.40.7.67", 9092}],
     :kaffe_producer_client,
     [
       auto_start_producers: true,
       allow_topic_auto_creation: false,
       default_producer_config: [
         required_acks: 1,
         ack_timeout: 1000,
         partition_buffer_limit: 512,
         partition_onwire_limit: 1,
         max_batch_size: 1048576,
         max_retries: 5,
         retry_backoff_ms: 100,
         compression: :gzip,
         min_compression_batch_size: 1024
       ]
     ]
   ]},
  restart_type: {:permanent, 10},
  shutdown: 5000,
  child_type: :worker
]
05:53:34.269 [info] Running KafkaClusterWeb.Endpoint with cowboy 2.12.0 at 0.0.0.0:4080 (http)
05:53:34.310 [info] Access KafkaClusterWeb.Endpoint at http://localhost:4080
05:53:34.446 [info] ChargeListener started and listening for new_charge notifications
05:53:34.456 [info] Successfully listening to the new_charge channel
05:53:41.624 [info] Received notification with payload :: %{"timestamp" => "2024-01-19T11:35:01+00:00", "charged_to" => [%{"amount" => 0, "balance_name" => "uncapped", "qty" => 165681}], "id" => "\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035", "cost" => 0.0, "status" => 400, "quantity" => 165681, "primary_service" => "5G Home X", "allocated_qty" => 165681, "type" => 100, "service_id" => "a72e5f19-6245-4d24-8f69-3bf4bf215895", "connection_surcharge" => 0, "inserted_at" => "2024-01-19T11:35:32+00:00", "updated_at" => "2024-01-19T11:35:32+00:00", "end_time" => "2024-01-19T11:35:00+00:00", "meta" => %{"chargingId" => 375767394, "consumed" => %{"6000" => %{"allocated_cost" => 0, "allocated_qty" => 0, "cost" => 0, "end_time" => "2024-01-19T13:35:00+02:00", "quantity" => 165681, "session_status" => 300, "start_time" => "2024-01-19T13:25:17+02:00", "uncharged" => 0}}, "ipv4_addr" => "10.209.0.26", "oneTimeEvent" => false, "ratType" => "NR", "requestor" => "satest", "resource_id" => "imei-861935050829590", "service_id" => "msisdn-27816699304", "userLocationinfo" => %{"eutraLocation" => nil, "n3gaLocation" => nil, "nrLocation" => %{"ageOfLocationInformation" => nil, "geodeticInformation" => nil, "geographicalInformation" => nil, "globalGnbId" => nil, "ignoreNcgi" => nil, "ncgi" => %{"nid" => nil, "nrCellId" => "0d1414033", "plmnId" => %{"mcc" => "655", "mnc" => "73"}}, "tai" => %{"nid" => nil, "plmnId" => %{"mcc" => "655", "mnc" => "73"}, "tac" => "07F394"}, "ueLocationTimestamp" => "2024-01-19T13:25:15+02:00"}}}, "rating_group" => 6000, "uncharged" => nil, "charged_for" => "Unlimited home 5G Premium", "rg_meta" => %{"mode" => "ONLINE", "sessionFailover" => "FAILOVER_NOT_SUPPORTED"}, "start_time" => "2024-01-19T11:25:18+00:00", "c_id" => "20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2", "rounding_policy" => "1.110000", "unit_rate" => 0, "sub_id" => "imsi-655730000598400", "cr_id" => "20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2", "tp_meta" => %{"default_quota" => %{"name" => "totalVolume", "quota" => 57982058496}, "final_unit" => %{"finalUnitAction" => "TERMINATE"}, "model" => "POST-PAID", "neg_balances" => false, "policy_states" => ["High Speed", "RICA", "Device", "Payment", "PAYMENT_HOLD"], "quota_calc" => "default", "quota_rules" => [], "unit_info" => %{"quotaHoldingTime" => 0, "timeQuotaThreshold" => 70, "triggers" => [%{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_THRESHOLD"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_EXHAUSTED"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QHT"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "VALIDITY_TIME"}], "unitQuotaThreshold" => 80, "validityTime" => 43200}, "vqt_percentage" => 0.4}, "requestor_node_id" => "trc_udg_upf_01", "requestor_service_id" => nil, "item_seq_num" => 1, "applies_to" => %{"balances" => ["uncapped"], "service_type" => "mobile_data"}, "description" => nil, "unit" => %{"downlinkVolume" => 0, "eventTimeStamp" => nil, "serviceSpecificUnits" => nil, "time" => nil, "totalVolume" => 165681, "triggerTimestamp" => "2024-01-19T13:35:01+02:00", "triggers" => [%{"maxNumberOfccc" => nil, "timeLimit" => nil, "triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "FINAL", "volumeLimit" => nil, "volumeLimit64" => nil}], "uplinkVolume" => 165681}, "post_surcharge" => 0, "tariff_plan" => "5G Home X", "taxes" => %{"fixed" => 0, "gl" => "9500A030", "name" => "VAT", "percentage" => 15, "tax_amount" => 0.0, "tax_inclusive_amount" => 0.0, "taxable_amount" => 0}, "allocated_cost" => 0.0, "error" => nil}
05:53:41.624 [info] Notification count: 1
05:53:41.852 [info]     :supervisor: {#PID<0.346.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.555.0>,
  id: "kafka-topic-test",
  mfargs: {:supervisor3, :start_link,
   [
     :brod_producers_sup,
     {:brod_producers_sup2, #PID<0.227.0>, "kafka-topic-test",
      [
        required_acks: 1,
        ack_timeout: 1000,
        partition_buffer_limit: 512,
        partition_onwire_limit: 1,
        max_batch_size: 1048576,
        max_retries: 5,
        retry_backoff_ms: 100,
        compression: :gzip,
        min_compression_batch_size: 1024
      ]}
   ]},
  restart_type: {:permanent, 10},
  shutdown: :infinity,
  child_type: :supervisor
]
05:53:41.874 [info]     :supervisor: {#PID<0.555.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.556.0>,
  id: 0,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.227.0>,
     "kafka-topic-test",
     0,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :gzip,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
05:53:41.875 [info]     :supervisor: {#PID<0.555.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.557.0>,
  id: 1,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.227.0>,
     "kafka-topic-test",
     1,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :gzip,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
05:53:41.876 [info]     :supervisor: {#PID<0.555.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.558.0>,
  id: 2,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.227.0>,
     "kafka-topic-test",
     2,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :gzip,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
05:53:42.430 [info] client :kaffe_producer_client connected to kafka3:9092

05:53:42.660 [info] Sent 1 messages to topic kafka-topic-test in 1026 ms
05:53:42.661 [info] Sent messages to topic kafka-topic-test in "{\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"charged_to\":[{\"amount\":0,\"balance_name\":\"uncapped\",\"qty\":165681}],\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"cost\":0.0,\"status\":400,\"quantity\":165681,\"primary_service\":\"5G Home X\",\"allocated_qty\":165681,\"type\":100,\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\",\"connection_surcharge\":0,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"end_time\":\"2024-01-19T11:35:00+00:00\",\"meta\":{\"chargingId\":375767394,\"consumed\":{\"6000\":{\"allocated_cost\":0,\"allocated_qty\":0,\"cost\":0,\"end_time\":\"2024-01-19T13:35:00+02:00\",\"quantity\":165681,\"session_status\":300,\"start_time\":\"2024-01-19T13:25:17+02:00\",\"uncharged\":0}},\"ipv4_addr\":\"10.209.0.26\",\"oneTimeEvent\":false,\"ratType\":\"NR\",\"requestor\":\"satest\",\"resource_id\":\"imei-861935050829590\",\"service_id\":\"msisdn-27816699304\",\"userLocationinfo\":{\"eutraLocation\":null,\"n3gaLocation\":null,\"nrLocation\":{\"ageOfLocationInformation\":null,\"geodeticInformation\":null,\"geographicalInformation\":null,\"globalGnbId\":null,\"ignoreNcgi\":null,\"ncgi\":{\"nid\":null,\"nrCellId\":\"0d1414033\",\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"}},\"tai\":{\"nid\":null,\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"},\"tac\":\"07F394\"},\"ueLocationTimestamp\":\"2024-01-19T13:25:15+02:00\"}}},\"rating_group\":6000,\"uncharged\":null,\"charged_for\":\"Unlimited home 5G Premium\",\"rg_meta\":{\"mode\":\"ONLINE\",\"sessionFailover\":\"FAILOVER_NOT_SUPPORTED\"},\"start_time\":\"2024-01-19T11:25:18+00:00\",\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"rounding_policy\":\"1.110000\",\"unit_rate\":0,\"sub_id\":\"imsi-655730000598400\",\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"tp_meta\":{\"default_quota\":{\"name\":\"totalVolume\",\"quota\":57982058496},\"final_unit\":{\"finalUnitAction\":\"TERMINATE\"},\"model\":\"POST-PAID\",\"neg_balances\":false,\"policy_states\":[\"High Speed\",\"RICA\",\"Device\",\"Payment\",\"PAYMENT_HOLD\"],\"quota_calc\":\"default\",\"quota_rules\":[],\"unit_info\":{\"quotaHoldingTime\":0,\"timeQuotaThreshold\":70,\"triggers\":[{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_THRESHOLD\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_EXHAUSTED\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QHT\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"VALIDITY_TIME\"}],\"unitQuotaThreshold\":80,\"validityTime\":43200},\"vqt_percentage\":0.4},\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"item_seq_num\":1,\"applies_to\":{\"balances\":[\"uncapped\"],\"service_type\":\"mobile_data\"},\"description\":null,\"unit\":{\"downlinkVolume\":0,\"eventTimeStamp\":null,\"serviceSpecificUnits\":null,\"time\":null,\"totalVolume\":165681,\"triggerTimestamp\":\"2024-01-19T13:35:01+02:00\",\"triggers\":[{\"maxNumberOfccc\":null,\"timeLimit\":null,\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"FINAL\",\"volumeLimit\":null,\"volumeLimit64\":null}],\"uplinkVolume\":165681},\"post_surcharge\":0,\"tariff_plan\":\"5G Home X\",\"taxes\":{\"fixed\":0,\"gl\":\"9500A030\",\"name\":\"VAT\",\"percentage\":15,\"tax_amount\":0.0,\"tax_inclusive_amount\":0.0,\"taxable_amount\":0},\"allocated_cost\":0.0,\"error\":null}"
05:53:42.661 [info] Sent 1 messages to topic kafka-topic-test in 1026 ms
05:54:22.986 [info] Received notification with payload :: %{"timestamp" => "2024-01-19T11:35:01+00:00", "charged_to" => [%{"amount" => 0, "balance_name" => "uncapped", "qty" => 165681}], "id" => "\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035", "cost" => 0.0, "status" => 400, "quantity" => 165681, "primary_service" => "5G Home X", "allocated_qty" => 165681, "type" => 100, "service_id" => "a72e5f19-6245-4d24-8f69-3bf4bf215895", "connection_surcharge" => 0, "inserted_at" => "2024-01-19T11:35:32+00:00", "updated_at" => "2024-01-19T11:35:32+00:00", "end_time" => "2024-01-19T11:35:00+00:00", "meta" => %{"chargingId" => 375767394, "consumed" => %{"6000" => %{"allocated_cost" => 0, "allocated_qty" => 0, "cost" => 0, "end_time" => "2024-01-19T13:35:00+02:00", "quantity" => 165681, "session_status" => 300, "start_time" => "2024-01-19T13:25:17+02:00", "uncharged" => 0}}, "ipv4_addr" => "10.209.0.26", "oneTimeEvent" => false, "ratType" => "NR", "requestor" => "satest", "resource_id" => "imei-861935050829590", "service_id" => "msisdn-27816699304", "userLocationinfo" => %{"eutraLocation" => nil, "n3gaLocation" => nil, "nrLocation" => %{"ageOfLocationInformation" => nil, "geodeticInformation" => nil, "geographicalInformation" => nil, "globalGnbId" => nil, "ignoreNcgi" => nil, "ncgi" => %{"nid" => nil, "nrCellId" => "0d1414033", "plmnId" => %{"mcc" => "655", "mnc" => "73"}}, "tai" => %{"nid" => nil, "plmnId" => %{"mcc" => "655", "mnc" => "73"}, "tac" => "07F394"}, "ueLocationTimestamp" => "2024-01-19T13:25:15+02:00"}}}, "rating_group" => 6000, "uncharged" => nil, "charged_for" => "Unlimited home 5G Premium", "rg_meta" => %{"mode" => "ONLINE", "sessionFailover" => "FAILOVER_NOT_SUPPORTED"}, "start_time" => "2024-01-19T11:25:18+00:00", "c_id" => "20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2", "rounding_policy" => "1.110000", "unit_rate" => 0, "sub_id" => "imsi-655730000598400", "cr_id" => "20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2", "tp_meta" => %{"default_quota" => %{"name" => "totalVolume", "quota" => 57982058496}, "final_unit" => %{"finalUnitAction" => "TERMINATE"}, "model" => "POST-PAID", "neg_balances" => false, "policy_states" => ["High Speed", "RICA", "Device", "Payment", "PAYMENT_HOLD"], "quota_calc" => "default", "quota_rules" => [], "unit_info" => %{"quotaHoldingTime" => 0, "timeQuotaThreshold" => 70, "triggers" => [%{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_THRESHOLD"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_EXHAUSTED"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QHT"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "VALIDITY_TIME"}], "unitQuotaThreshold" => 80, "validityTime" => 43200}, "vqt_percentage" => 0.4}, "requestor_node_id" => "trc_udg_upf_01", "requestor_service_id" => nil, "item_seq_num" => 1, "applies_to" => %{"balances" => ["uncapped"], "service_type" => "mobile_data"}, "description" => nil, "unit" => %{"downlinkVolume" => 0, "eventTimeStamp" => nil, "serviceSpecificUnits" => nil, "time" => nil, "totalVolume" => 165681, "triggerTimestamp" => "2024-01-19T13:35:01+02:00", "triggers" => [%{"maxNumberOfccc" => nil, "timeLimit" => nil, "triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "FINAL", "volumeLimit" => nil, "volumeLimit64" => nil}], "uplinkVolume" => 165681}, "post_surcharge" => 0, "tariff_plan" => "5G Home X", "taxes" => %{"fixed" => 0, "gl" => "9500A030", "name" => "VAT", "percentage" => 15, "tax_amount" => 0.0, "tax_inclusive_amount" => 0.0, "taxable_amount" => 0}, "allocated_cost" => 0.0, "error" => nil}
05:54:22.987 [info] Notification count: 2
05:54:23.173 [info] Sent 1 messages to topic kafka-topic-test in 186 ms
05:54:23.174 [info] Sent messages to topic kafka-topic-test in "{\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"charged_to\":[{\"amount\":0,\"balance_name\":\"uncapped\",\"qty\":165681}],\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"cost\":0.0,\"status\":400,\"quantity\":165681,\"primary_service\":\"5G Home X\",\"allocated_qty\":165681,\"type\":100,\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\",\"connection_surcharge\":0,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"end_time\":\"2024-01-19T11:35:00+00:00\",\"meta\":{\"chargingId\":375767394,\"consumed\":{\"6000\":{\"allocated_cost\":0,\"allocated_qty\":0,\"cost\":0,\"end_time\":\"2024-01-19T13:35:00+02:00\",\"quantity\":165681,\"session_status\":300,\"start_time\":\"2024-01-19T13:25:17+02:00\",\"uncharged\":0}},\"ipv4_addr\":\"10.209.0.26\",\"oneTimeEvent\":false,\"ratType\":\"NR\",\"requestor\":\"satest\",\"resource_id\":\"imei-861935050829590\",\"service_id\":\"msisdn-27816699304\",\"userLocationinfo\":{\"eutraLocation\":null,\"n3gaLocation\":null,\"nrLocation\":{\"ageOfLocationInformation\":null,\"geodeticInformation\":null,\"geographicalInformation\":null,\"globalGnbId\":null,\"ignoreNcgi\":null,\"ncgi\":{\"nid\":null,\"nrCellId\":\"0d1414033\",\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"}},\"tai\":{\"nid\":null,\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"},\"tac\":\"07F394\"},\"ueLocationTimestamp\":\"2024-01-19T13:25:15+02:00\"}}},\"rating_group\":6000,\"uncharged\":null,\"charged_for\":\"Unlimited home 5G Premium\",\"rg_meta\":{\"mode\":\"ONLINE\",\"sessionFailover\":\"FAILOVER_NOT_SUPPORTED\"},\"start_time\":\"2024-01-19T11:25:18+00:00\",\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"rounding_policy\":\"1.110000\",\"unit_rate\":0,\"sub_id\":\"imsi-655730000598400\",\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"tp_meta\":{\"default_quota\":{\"name\":\"totalVolume\",\"quota\":57982058496},\"final_unit\":{\"finalUnitAction\":\"TERMINATE\"},\"model\":\"POST-PAID\",\"neg_balances\":false,\"policy_states\":[\"High Speed\",\"RICA\",\"Device\",\"Payment\",\"PAYMENT_HOLD\"],\"quota_calc\":\"default\",\"quota_rules\":[],\"unit_info\":{\"quotaHoldingTime\":0,\"timeQuotaThreshold\":70,\"triggers\":[{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_THRESHOLD\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_EXHAUSTED\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QHT\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"VALIDITY_TIME\"}],\"unitQuotaThreshold\":80,\"validityTime\":43200},\"vqt_percentage\":0.4},\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"item_seq_num\":1,\"applies_to\":{\"balances\":[\"uncapped\"],\"service_type\":\"mobile_data\"},\"description\":null,\"unit\":{\"downlinkVolume\":0,\"eventTimeStamp\":null,\"serviceSpecificUnits\":null,\"time\":null,\"totalVolume\":165681,\"triggerTimestamp\":\"2024-01-19T13:35:01+02:00\",\"triggers\":[{\"maxNumberOfccc\":null,\"timeLimit\":null,\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"FINAL\",\"volumeLimit\":null,\"volumeLimit64\":null}],\"uplinkVolume\":165681},\"post_surcharge\":0,\"tariff_plan\":\"5G Home X\",\"taxes\":{\"fixed\":0,\"gl\":\"9500A030\",\"name\":\"VAT\",\"percentage\":15,\"tax_amount\":0.0,\"tax_inclusive_amount\":0.0,\"taxable_amount\":0},\"allocated_cost\":0.0,\"error\":null}"
05:54:23.174 [info] Sent 1 messages to topic kafka-topic-test in 186 ms
06:02:48.961 [info]     :supervisor: {:local, :brod_sup}
    :started: [
  pid: #PID<0.240.0>,
  id: :kaffe_producer_client,
  mfargs: {:brod_client, :start_link,
   [
     [{~c"13.40.7.67", 9092}],
     :kaffe_producer_client,
     [
       auto_start_producers: true,
       allow_topic_auto_creation: false,
       default_producer_config: [
         required_acks: 1,
         ack_timeout: 1000,
         partition_buffer_limit: 512,
         partition_onwire_limit: 1,
         max_batch_size: 1048576,
         max_retries: 5,
         retry_backoff_ms: 100,
         compression: :gzip,
         min_compression_batch_size: 1024
       ]
     ]
   ]},
  restart_type: {:permanent, 10},
  shutdown: 5000,
  child_type: :worker
]
06:02:50.538 [info] Running KafkaClusterWeb.Endpoint with cowboy 2.12.0 at 0.0.0.0:4080 (http)
06:02:50.551 [info] Access KafkaClusterWeb.Endpoint at http://localhost:4080
06:02:50.702 [info] ChargeListener started and listening for new_charge notifications
06:02:50.711 [info] Successfully listening to the new_charge channel
06:02:50.759 [info] Started listening on new_charge channel 2 module
06:02:59.880 [info] Received notification with payload :: %{"timestamp" => "2024-01-19T11:35:01+00:00", "charged_to" => [%{"amount" => 0, "balance_name" => "uncapped", "qty" => 165681}], "id" => "\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035", "cost" => 0.0, "status" => 400, "quantity" => 165681, "primary_service" => "5G Home X", "allocated_qty" => 165681, "type" => 100, "service_id" => "a72e5f19-6245-4d24-8f69-3bf4bf215895", "connection_surcharge" => 0, "inserted_at" => "2024-01-19T11:35:32+00:00", "updated_at" => "2024-01-19T11:35:32+00:00", "end_time" => "2024-01-19T11:35:00+00:00", "meta" => %{"chargingId" => 375767394, "consumed" => %{"6000" => %{"allocated_cost" => 0, "allocated_qty" => 0, "cost" => 0, "end_time" => "2024-01-19T13:35:00+02:00", "quantity" => 165681, "session_status" => 300, "start_time" => "2024-01-19T13:25:17+02:00", "uncharged" => 0}}, "ipv4_addr" => "10.209.0.26", "oneTimeEvent" => false, "ratType" => "NR", "requestor" => "satest", "resource_id" => "imei-861935050829590", "service_id" => "msisdn-27816699304", "userLocationinfo" => %{"eutraLocation" => nil, "n3gaLocation" => nil, "nrLocation" => %{"ageOfLocationInformation" => nil, "geodeticInformation" => nil, "geographicalInformation" => nil, "globalGnbId" => nil, "ignoreNcgi" => nil, "ncgi" => %{"nid" => nil, "nrCellId" => "0d1414033", "plmnId" => %{"mcc" => "655", "mnc" => "73"}}, "tai" => %{"nid" => nil, "plmnId" => %{"mcc" => "655", "mnc" => "73"}, "tac" => "07F394"}, "ueLocationTimestamp" => "2024-01-19T13:25:15+02:00"}}}, "rating_group" => 6000, "uncharged" => nil, "charged_for" => "Unlimited home 5G Premium", "rg_meta" => %{"mode" => "ONLINE", "sessionFailover" => "FAILOVER_NOT_SUPPORTED"}, "start_time" => "2024-01-19T11:25:18+00:00", "c_id" => "20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2", "rounding_policy" => "1.110000", "unit_rate" => 0, "sub_id" => "imsi-655730000598400", "cr_id" => "20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2", "tp_meta" => %{"default_quota" => %{"name" => "totalVolume", "quota" => 57982058496}, "final_unit" => %{"finalUnitAction" => "TERMINATE"}, "model" => "POST-PAID", "neg_balances" => false, "policy_states" => ["High Speed", "RICA", "Device", "Payment", "PAYMENT_HOLD"], "quota_calc" => "default", "quota_rules" => [], "unit_info" => %{"quotaHoldingTime" => 0, "timeQuotaThreshold" => 70, "triggers" => [%{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_THRESHOLD"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_EXHAUSTED"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QHT"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "VALIDITY_TIME"}], "unitQuotaThreshold" => 80, "validityTime" => 43200}, "vqt_percentage" => 0.4}, "requestor_node_id" => "trc_udg_upf_01", "requestor_service_id" => nil, "item_seq_num" => 1, "applies_to" => %{"balances" => ["uncapped"], "service_type" => "mobile_data"}, "description" => nil, "unit" => %{"downlinkVolume" => 0, "eventTimeStamp" => nil, "serviceSpecificUnits" => nil, "time" => nil, "totalVolume" => 165681, "triggerTimestamp" => "2024-01-19T13:35:01+02:00", "triggers" => [%{"maxNumberOfccc" => nil, "timeLimit" => nil, "triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "FINAL", "volumeLimit" => nil, "volumeLimit64" => nil}], "uplinkVolume" => 165681}, "post_surcharge" => 0, "tariff_plan" => "5G Home X", "taxes" => %{"fixed" => 0, "gl" => "9500A030", "name" => "VAT", "percentage" => 15, "tax_amount" => 0.0, "tax_inclusive_amount" => 0.0, "taxable_amount" => 0}, "allocated_cost" => 0.0, "error" => nil}
06:02:59.880 [info] Notification count: 1
06:03:00.077 [info]     :supervisor: {#PID<0.359.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.569.0>,
  id: "kafka-topic-test",
  mfargs: {:supervisor3, :start_link,
   [
     :brod_producers_sup,
     {:brod_producers_sup2, #PID<0.240.0>, "kafka-topic-test",
      [
        required_acks: 1,
        ack_timeout: 1000,
        partition_buffer_limit: 512,
        partition_onwire_limit: 1,
        max_batch_size: 1048576,
        max_retries: 5,
        retry_backoff_ms: 100,
        compression: :gzip,
        min_compression_batch_size: 1024
      ]}
   ]},
  restart_type: {:permanent, 10},
  shutdown: :infinity,
  child_type: :supervisor
]
06:03:00.087 [info]     :supervisor: {#PID<0.569.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.570.0>,
  id: 0,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.240.0>,
     "kafka-topic-test",
     0,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :gzip,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
06:03:00.088 [info]     :supervisor: {#PID<0.569.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.571.0>,
  id: 1,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.240.0>,
     "kafka-topic-test",
     1,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :gzip,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
06:03:00.089 [info]     :supervisor: {#PID<0.569.0>, :brod_producers_sup}
    :started: [
  pid: #PID<0.572.0>,
  id: 2,
  mfargs: {:brod_producer, :start_link,
   [
     #PID<0.240.0>,
     "kafka-topic-test",
     2,
     [
       required_acks: 1,
       ack_timeout: 1000,
       partition_buffer_limit: 512,
       partition_onwire_limit: 1,
       max_batch_size: 1048576,
       max_retries: 5,
       retry_backoff_ms: 100,
       compression: :gzip,
       min_compression_batch_size: 1024
     ]
   ]},
  restart_type: {:permanent, 5},
  shutdown: 5000,
  child_type: :worker
]
06:03:00.647 [info] client :kaffe_producer_client connected to kafka3:9092

06:03:00.844 [info] Sent message to topic kafka-topic-test in 957 ms
06:03:00.845 [info] Sent message to topic kafka-topic-test with value :: "{\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"charged_to\":[{\"amount\":0,\"balance_name\":\"uncapped\",\"qty\":165681}],\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"cost\":0.0,\"status\":400,\"quantity\":165681,\"primary_service\":\"5G Home X\",\"allocated_qty\":165681,\"type\":100,\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\",\"connection_surcharge\":0,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"end_time\":\"2024-01-19T11:35:00+00:00\",\"meta\":{\"chargingId\":375767394,\"consumed\":{\"6000\":{\"allocated_cost\":0,\"allocated_qty\":0,\"cost\":0,\"end_time\":\"2024-01-19T13:35:00+02:00\",\"quantity\":165681,\"session_status\":300,\"start_time\":\"2024-01-19T13:25:17+02:00\",\"uncharged\":0}},\"ipv4_addr\":\"10.209.0.26\",\"oneTimeEvent\":false,\"ratType\":\"NR\",\"requestor\":\"satest\",\"resource_id\":\"imei-861935050829590\",\"service_id\":\"msisdn-27816699304\",\"userLocationinfo\":{\"eutraLocation\":null,\"n3gaLocation\":null,\"nrLocation\":{\"ageOfLocationInformation\":null,\"geodeticInformation\":null,\"geographicalInformation\":null,\"globalGnbId\":null,\"ignoreNcgi\":null,\"ncgi\":{\"nid\":null,\"nrCellId\":\"0d1414033\",\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"}},\"tai\":{\"nid\":null,\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"},\"tac\":\"07F394\"},\"ueLocationTimestamp\":\"2024-01-19T13:25:15+02:00\"}}},\"rating_group\":6000,\"uncharged\":null,\"charged_for\":\"Unlimited home 5G Premium\",\"rg_meta\":{\"mode\":\"ONLINE\",\"sessionFailover\":\"FAILOVER_NOT_SUPPORTED\"},\"start_time\":\"2024-01-19T11:25:18+00:00\",\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"rounding_policy\":\"1.110000\",\"unit_rate\":0,\"sub_id\":\"imsi-655730000598400\",\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"tp_meta\":{\"default_quota\":{\"name\":\"totalVolume\",\"quota\":57982058496},\"final_unit\":{\"finalUnitAction\":\"TERMINATE\"},\"model\":\"POST-PAID\",\"neg_balances\":false,\"policy_states\":[\"High Speed\",\"RICA\",\"Device\",\"Payment\",\"PAYMENT_HOLD\"],\"quota_calc\":\"default\",\"quota_rules\":[],\"unit_info\":{\"quotaHoldingTime\":0,\"timeQuotaThreshold\":70,\"triggers\":[{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_THRESHOLD\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_EXHAUSTED\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QHT\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"VALIDITY_TIME\"}],\"unitQuotaThreshold\":80,\"validityTime\":43200},\"vqt_percentage\":0.4},\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"item_seq_num\":1,\"applies_to\":{\"balances\":[\"uncapped\"],\"service_type\":\"mobile_data\"},\"description\":null,\"unit\":{\"downlinkVolume\":0,\"eventTimeStamp\":null,\"serviceSpecificUnits\":null,\"time\":null,\"totalVolume\":165681,\"triggerTimestamp\":\"2024-01-19T13:35:01+02:00\",\"triggers\":[{\"maxNumberOfccc\":null,\"timeLimit\":null,\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"FINAL\",\"volumeLimit\":null,\"volumeLimit64\":null}],\"uplinkVolume\":165681},\"post_surcharge\":0,\"tariff_plan\":\"5G Home X\",\"taxes\":{\"fixed\":0,\"gl\":\"9500A030\",\"name\":\"VAT\",\"percentage\":15,\"tax_amount\":0.0,\"tax_inclusive_amount\":0.0,\"taxable_amount\":0},\"allocated_cost\":0.0,\"error\":null}"
06:03:00.845 [info] Sent 1 messages to topic kafka-topic-test in 957 ms
06:03:12.329 [info] Received notification with payload :: %{"timestamp" => "2024-01-19T11:35:01+00:00", "charged_to" => [%{"amount" => 0, "balance_name" => "uncapped", "qty" => 165681}], "id" => "\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035", "cost" => 0.0, "status" => 400, "quantity" => 165681, "primary_service" => "5G Home X", "allocated_qty" => 165681, "type" => 100, "service_id" => "a72e5f19-6245-4d24-8f69-3bf4bf215895", "connection_surcharge" => 0, "inserted_at" => "2024-01-19T11:35:32+00:00", "updated_at" => "2024-01-19T11:35:32+00:00", "end_time" => "2024-01-19T11:35:00+00:00", "meta" => %{"chargingId" => 375767394, "consumed" => %{"6000" => %{"allocated_cost" => 0, "allocated_qty" => 0, "cost" => 0, "end_time" => "2024-01-19T13:35:00+02:00", "quantity" => 165681, "session_status" => 300, "start_time" => "2024-01-19T13:25:17+02:00", "uncharged" => 0}}, "ipv4_addr" => "10.209.0.26", "oneTimeEvent" => false, "ratType" => "NR", "requestor" => "satest", "resource_id" => "imei-861935050829590", "service_id" => "msisdn-27816699304", "userLocationinfo" => %{"eutraLocation" => nil, "n3gaLocation" => nil, "nrLocation" => %{"ageOfLocationInformation" => nil, "geodeticInformation" => nil, "geographicalInformation" => nil, "globalGnbId" => nil, "ignoreNcgi" => nil, "ncgi" => %{"nid" => nil, "nrCellId" => "0d1414033", "plmnId" => %{"mcc" => "655", "mnc" => "73"}}, "tai" => %{"nid" => nil, "plmnId" => %{"mcc" => "655", "mnc" => "73"}, "tac" => "07F394"}, "ueLocationTimestamp" => "2024-01-19T13:25:15+02:00"}}}, "rating_group" => 6000, "uncharged" => nil, "charged_for" => "Unlimited home 5G Premium", "rg_meta" => %{"mode" => "ONLINE", "sessionFailover" => "FAILOVER_NOT_SUPPORTED"}, "start_time" => "2024-01-19T11:25:18+00:00", "c_id" => "20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2", "rounding_policy" => "1.110000", "unit_rate" => 0, "sub_id" => "imsi-655730000598400", "cr_id" => "20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2", "tp_meta" => %{"default_quota" => %{"name" => "totalVolume", "quota" => 57982058496}, "final_unit" => %{"finalUnitAction" => "TERMINATE"}, "model" => "POST-PAID", "neg_balances" => false, "policy_states" => ["High Speed", "RICA", "Device", "Payment", "PAYMENT_HOLD"], "quota_calc" => "default", "quota_rules" => [], "unit_info" => %{"quotaHoldingTime" => 0, "timeQuotaThreshold" => 70, "triggers" => [%{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_THRESHOLD"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_EXHAUSTED"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QHT"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "VALIDITY_TIME"}], "unitQuotaThreshold" => 80, "validityTime" => 43200}, "vqt_percentage" => 0.4}, "requestor_node_id" => "trc_udg_upf_01", "requestor_service_id" => nil, "item_seq_num" => 1, "applies_to" => %{"balances" => ["uncapped"], "service_type" => "mobile_data"}, "description" => nil, "unit" => %{"downlinkVolume" => 0, "eventTimeStamp" => nil, "serviceSpecificUnits" => nil, "time" => nil, "totalVolume" => 165681, "triggerTimestamp" => "2024-01-19T13:35:01+02:00", "triggers" => [%{"maxNumberOfccc" => nil, "timeLimit" => nil, "triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "FINAL", "volumeLimit" => nil, "volumeLimit64" => nil}], "uplinkVolume" => 165681}, "post_surcharge" => 0, "tariff_plan" => "5G Home X", "taxes" => %{"fixed" => 0, "gl" => "9500A030", "name" => "VAT", "percentage" => 15, "tax_amount" => 0.0, "tax_inclusive_amount" => 0.0, "taxable_amount" => 0}, "allocated_cost" => 0.0, "error" => nil}
06:03:12.329 [info] Notification count: 2
06:03:12.515 [info] Sent message to topic kafka-topic-test in 186 ms
06:03:12.516 [info] Sent message to topic kafka-topic-test with value :: "{\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"charged_to\":[{\"amount\":0,\"balance_name\":\"uncapped\",\"qty\":165681}],\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"cost\":0.0,\"status\":400,\"quantity\":165681,\"primary_service\":\"5G Home X\",\"allocated_qty\":165681,\"type\":100,\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\",\"connection_surcharge\":0,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"end_time\":\"2024-01-19T11:35:00+00:00\",\"meta\":{\"chargingId\":375767394,\"consumed\":{\"6000\":{\"allocated_cost\":0,\"allocated_qty\":0,\"cost\":0,\"end_time\":\"2024-01-19T13:35:00+02:00\",\"quantity\":165681,\"session_status\":300,\"start_time\":\"2024-01-19T13:25:17+02:00\",\"uncharged\":0}},\"ipv4_addr\":\"10.209.0.26\",\"oneTimeEvent\":false,\"ratType\":\"NR\",\"requestor\":\"satest\",\"resource_id\":\"imei-861935050829590\",\"service_id\":\"msisdn-27816699304\",\"userLocationinfo\":{\"eutraLocation\":null,\"n3gaLocation\":null,\"nrLocation\":{\"ageOfLocationInformation\":null,\"geodeticInformation\":null,\"geographicalInformation\":null,\"globalGnbId\":null,\"ignoreNcgi\":null,\"ncgi\":{\"nid\":null,\"nrCellId\":\"0d1414033\",\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"}},\"tai\":{\"nid\":null,\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"},\"tac\":\"07F394\"},\"ueLocationTimestamp\":\"2024-01-19T13:25:15+02:00\"}}},\"rating_group\":6000,\"uncharged\":null,\"charged_for\":\"Unlimited home 5G Premium\",\"rg_meta\":{\"mode\":\"ONLINE\",\"sessionFailover\":\"FAILOVER_NOT_SUPPORTED\"},\"start_time\":\"2024-01-19T11:25:18+00:00\",\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"rounding_policy\":\"1.110000\",\"unit_rate\":0,\"sub_id\":\"imsi-655730000598400\",\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"tp_meta\":{\"default_quota\":{\"name\":\"totalVolume\",\"quota\":57982058496},\"final_unit\":{\"finalUnitAction\":\"TERMINATE\"},\"model\":\"POST-PAID\",\"neg_balances\":false,\"policy_states\":[\"High Speed\",\"RICA\",\"Device\",\"Payment\",\"PAYMENT_HOLD\"],\"quota_calc\":\"default\",\"quota_rules\":[],\"unit_info\":{\"quotaHoldingTime\":0,\"timeQuotaThreshold\":70,\"triggers\":[{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_THRESHOLD\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_EXHAUSTED\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QHT\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"VALIDITY_TIME\"}],\"unitQuotaThreshold\":80,\"validityTime\":43200},\"vqt_percentage\":0.4},\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"item_seq_num\":1,\"applies_to\":{\"balances\":[\"uncapped\"],\"service_type\":\"mobile_data\"},\"description\":null,\"unit\":{\"downlinkVolume\":0,\"eventTimeStamp\":null,\"serviceSpecificUnits\":null,\"time\":null,\"totalVolume\":165681,\"triggerTimestamp\":\"2024-01-19T13:35:01+02:00\",\"triggers\":[{\"maxNumberOfccc\":null,\"timeLimit\":null,\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"FINAL\",\"volumeLimit\":null,\"volumeLimit64\":null}],\"uplinkVolume\":165681},\"post_surcharge\":0,\"tariff_plan\":\"5G Home X\",\"taxes\":{\"fixed\":0,\"gl\":\"9500A030\",\"name\":\"VAT\",\"percentage\":15,\"tax_amount\":0.0,\"tax_inclusive_amount\":0.0,\"taxable_amount\":0},\"allocated_cost\":0.0,\"error\":null}"
06:03:12.516 [info] Sent 1 messages to topic kafka-topic-test in 186 ms
06:07:43.131 [info] Received notification with payload :: %{"timestamp" => "2024-01-19T11:35:01+00:00", "charged_to" => [%{"amount" => 0, "balance_name" => "uncapped", "qty" => 165681}], "id" => "\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035", "cost" => 0.0, "status" => 400, "quantity" => 165681, "primary_service" => "5G Home X", "allocated_qty" => 165681, "type" => 100, "service_id" => "a72e5f19-6245-4d24-8f69-3bf4bf215895", "connection_surcharge" => 0, "inserted_at" => "2024-01-19T11:35:32+00:00", "updated_at" => "2024-01-19T11:35:32+00:00", "end_time" => "2024-01-19T11:35:00+00:00", "meta" => %{"chargingId" => 375767394, "consumed" => %{"6000" => %{"allocated_cost" => 0, "allocated_qty" => 0, "cost" => 0, "end_time" => "2024-01-19T13:35:00+02:00", "quantity" => 165681, "session_status" => 300, "start_time" => "2024-01-19T13:25:17+02:00", "uncharged" => 0}}, "ipv4_addr" => "10.209.0.26", "oneTimeEvent" => false, "ratType" => "NR", "requestor" => "satest", "resource_id" => "imei-861935050829590", "service_id" => "msisdn-27816699304", "userLocationinfo" => %{"eutraLocation" => nil, "n3gaLocation" => nil, "nrLocation" => %{"ageOfLocationInformation" => nil, "geodeticInformation" => nil, "geographicalInformation" => nil, "globalGnbId" => nil, "ignoreNcgi" => nil, "ncgi" => %{"nid" => nil, "nrCellId" => "0d1414033", "plmnId" => %{"mcc" => "655", "mnc" => "73"}}, "tai" => %{"nid" => nil, "plmnId" => %{"mcc" => "655", "mnc" => "73"}, "tac" => "07F394"}, "ueLocationTimestamp" => "2024-01-19T13:25:15+02:00"}}}, "rating_group" => 6000, "uncharged" => nil, "charged_for" => "Unlimited home 5G Premium", "rg_meta" => %{"mode" => "ONLINE", "sessionFailover" => "FAILOVER_NOT_SUPPORTED"}, "start_time" => "2024-01-19T11:25:18+00:00", "c_id" => "20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2", "rounding_policy" => "1.110000", "unit_rate" => 0, "sub_id" => "imsi-655730000598400", "cr_id" => "20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2", "tp_meta" => %{"default_quota" => %{"name" => "totalVolume", "quota" => 57982058496}, "final_unit" => %{"finalUnitAction" => "TERMINATE"}, "model" => "POST-PAID", "neg_balances" => false, "policy_states" => ["High Speed", "RICA", "Device", "Payment", "PAYMENT_HOLD"], "quota_calc" => "default", "quota_rules" => [], "unit_info" => %{"quotaHoldingTime" => 0, "timeQuotaThreshold" => 70, "triggers" => [%{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_THRESHOLD"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_EXHAUSTED"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QHT"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "VALIDITY_TIME"}], "unitQuotaThreshold" => 80, "validityTime" => 43200}, "vqt_percentage" => 0.4}, "requestor_node_id" => "trc_udg_upf_01", "requestor_service_id" => nil, "item_seq_num" => 1, "applies_to" => %{"balances" => ["uncapped"], "service_type" => "mobile_data"}, "description" => nil, "unit" => %{"downlinkVolume" => 0, "eventTimeStamp" => nil, "serviceSpecificUnits" => nil, "time" => nil, "totalVolume" => 165681, "triggerTimestamp" => "2024-01-19T13:35:01+02:00", "triggers" => [%{"maxNumberOfccc" => nil, "timeLimit" => nil, "triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "FINAL", "volumeLimit" => nil, "volumeLimit64" => nil}], "uplinkVolume" => 165681}, "post_surcharge" => 0, "tariff_plan" => "5G Home X", "taxes" => %{"fixed" => 0, "gl" => "9500A030", "name" => "VAT", "percentage" => 15, "tax_amount" => 0.0, "tax_inclusive_amount" => 0.0, "taxable_amount" => 0}, "allocated_cost" => 0.0, "error" => nil}
06:07:43.131 [info] Notification count: 3
06:07:43.319 [info] Sent message to topic kafka-topic-test in 188 ms
06:07:43.320 [info] Sent message to topic kafka-topic-test with value :: "{\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"charged_to\":[{\"amount\":0,\"balance_name\":\"uncapped\",\"qty\":165681}],\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"cost\":0.0,\"status\":400,\"quantity\":165681,\"primary_service\":\"5G Home X\",\"allocated_qty\":165681,\"type\":100,\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\",\"connection_surcharge\":0,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"end_time\":\"2024-01-19T11:35:00+00:00\",\"meta\":{\"chargingId\":375767394,\"consumed\":{\"6000\":{\"allocated_cost\":0,\"allocated_qty\":0,\"cost\":0,\"end_time\":\"2024-01-19T13:35:00+02:00\",\"quantity\":165681,\"session_status\":300,\"start_time\":\"2024-01-19T13:25:17+02:00\",\"uncharged\":0}},\"ipv4_addr\":\"10.209.0.26\",\"oneTimeEvent\":false,\"ratType\":\"NR\",\"requestor\":\"satest\",\"resource_id\":\"imei-861935050829590\",\"service_id\":\"msisdn-27816699304\",\"userLocationinfo\":{\"eutraLocation\":null,\"n3gaLocation\":null,\"nrLocation\":{\"ageOfLocationInformation\":null,\"geodeticInformation\":null,\"geographicalInformation\":null,\"globalGnbId\":null,\"ignoreNcgi\":null,\"ncgi\":{\"nid\":null,\"nrCellId\":\"0d1414033\",\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"}},\"tai\":{\"nid\":null,\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"},\"tac\":\"07F394\"},\"ueLocationTimestamp\":\"2024-01-19T13:25:15+02:00\"}}},\"rating_group\":6000,\"uncharged\":null,\"charged_for\":\"Unlimited home 5G Premium\",\"rg_meta\":{\"mode\":\"ONLINE\",\"sessionFailover\":\"FAILOVER_NOT_SUPPORTED\"},\"start_time\":\"2024-01-19T11:25:18+00:00\",\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"rounding_policy\":\"1.110000\",\"unit_rate\":0,\"sub_id\":\"imsi-655730000598400\",\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"tp_meta\":{\"default_quota\":{\"name\":\"totalVolume\",\"quota\":57982058496},\"final_unit\":{\"finalUnitAction\":\"TERMINATE\"},\"model\":\"POST-PAID\",\"neg_balances\":false,\"policy_states\":[\"High Speed\",\"RICA\",\"Device\",\"Payment\",\"PAYMENT_HOLD\"],\"quota_calc\":\"default\",\"quota_rules\":[],\"unit_info\":{\"quotaHoldingTime\":0,\"timeQuotaThreshold\":70,\"triggers\":[{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_THRESHOLD\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_EXHAUSTED\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QHT\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"VALIDITY_TIME\"}],\"unitQuotaThreshold\":80,\"validityTime\":43200},\"vqt_percentage\":0.4},\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"item_seq_num\":1,\"applies_to\":{\"balances\":[\"uncapped\"],\"service_type\":\"mobile_data\"},\"description\":null,\"unit\":{\"downlinkVolume\":0,\"eventTimeStamp\":null,\"serviceSpecificUnits\":null,\"time\":null,\"totalVolume\":165681,\"triggerTimestamp\":\"2024-01-19T13:35:01+02:00\",\"triggers\":[{\"maxNumberOfccc\":null,\"timeLimit\":null,\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"FINAL\",\"volumeLimit\":null,\"volumeLimit64\":null}],\"uplinkVolume\":165681},\"post_surcharge\":0,\"tariff_plan\":\"5G Home X\",\"taxes\":{\"fixed\":0,\"gl\":\"9500A030\",\"name\":\"VAT\",\"percentage\":15,\"tax_amount\":0.0,\"tax_inclusive_amount\":0.0,\"taxable_amount\":0},\"allocated_cost\":0.0,\"error\":null}"
06:07:43.320 [info] Sent 1 messages to topic kafka-topic-test in 188 ms
06:07:54.479 [info] Received notification with payload :: %{"timestamp" => "2024-01-19T11:35:01+00:00", "charged_to" => [%{"amount" => 0, "balance_name" => "uncapped", "qty" => 165681}], "id" => "\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035", "cost" => 0.0, "status" => 400, "quantity" => 165681, "primary_service" => "5G Home X", "allocated_qty" => 165681, "type" => 100, "service_id" => "a72e5f19-6245-4d24-8f69-3bf4bf215895", "connection_surcharge" => 0, "inserted_at" => "2024-01-19T11:35:32+00:00", "updated_at" => "2024-01-19T11:35:32+00:00", "end_time" => "2024-01-19T11:35:00+00:00", "meta" => %{"chargingId" => 375767394, "consumed" => %{"6000" => %{"allocated_cost" => 0, "allocated_qty" => 0, "cost" => 0, "end_time" => "2024-01-19T13:35:00+02:00", "quantity" => 165681, "session_status" => 300, "start_time" => "2024-01-19T13:25:17+02:00", "uncharged" => 0}}, "ipv4_addr" => "10.209.0.26", "oneTimeEvent" => false, "ratType" => "NR", "requestor" => "satest", "resource_id" => "imei-861935050829590", "service_id" => "msisdn-27816699304", "userLocationinfo" => %{"eutraLocation" => nil, "n3gaLocation" => nil, "nrLocation" => %{"ageOfLocationInformation" => nil, "geodeticInformation" => nil, "geographicalInformation" => nil, "globalGnbId" => nil, "ignoreNcgi" => nil, "ncgi" => %{"nid" => nil, "nrCellId" => "0d1414033", "plmnId" => %{"mcc" => "655", "mnc" => "73"}}, "tai" => %{"nid" => nil, "plmnId" => %{"mcc" => "655", "mnc" => "73"}, "tac" => "07F394"}, "ueLocationTimestamp" => "2024-01-19T13:25:15+02:00"}}}, "rating_group" => 6000, "uncharged" => nil, "charged_for" => "Unlimited home 5G Premium", "rg_meta" => %{"mode" => "ONLINE", "sessionFailover" => "FAILOVER_NOT_SUPPORTED"}, "start_time" => "2024-01-19T11:25:18+00:00", "c_id" => "20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2", "rounding_policy" => "1.110000", "unit_rate" => 0, "sub_id" => "imsi-655730000598400", "cr_id" => "20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2", "tp_meta" => %{"default_quota" => %{"name" => "totalVolume", "quota" => 57982058496}, "final_unit" => %{"finalUnitAction" => "TERMINATE"}, "model" => "POST-PAID", "neg_balances" => false, "policy_states" => ["High Speed", "RICA", "Device", "Payment", "PAYMENT_HOLD"], "quota_calc" => "default", "quota_rules" => [], "unit_info" => %{"quotaHoldingTime" => 0, "timeQuotaThreshold" => 70, "triggers" => [%{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_THRESHOLD"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QUOTA_EXHAUSTED"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "QHT"}, %{"triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "VALIDITY_TIME"}], "unitQuotaThreshold" => 80, "validityTime" => 43200}, "vqt_percentage" => 0.4}, "requestor_node_id" => "trc_udg_upf_01", "requestor_service_id" => nil, "item_seq_num" => 1, "applies_to" => %{"balances" => ["uncapped"], "service_type" => "mobile_data"}, "description" => nil, "unit" => %{"downlinkVolume" => 0, "eventTimeStamp" => nil, "serviceSpecificUnits" => nil, "time" => nil, "totalVolume" => 165681, "triggerTimestamp" => "2024-01-19T13:35:01+02:00", "triggers" => [%{"maxNumberOfccc" => nil, "timeLimit" => nil, "triggerCategory" => "IMMEDIATE_REPORT", "triggerType" => "FINAL", "volumeLimit" => nil, "volumeLimit64" => nil}], "uplinkVolume" => 165681}, "post_surcharge" => 0, "tariff_plan" => "5G Home X", "taxes" => %{"fixed" => 0, "gl" => "9500A030", "name" => "VAT", "percentage" => 15, "tax_amount" => 0.0, "tax_inclusive_amount" => 0.0, "taxable_amount" => 0}, "allocated_cost" => 0.0, "error" => nil}
06:07:54.479 [info] Notification count: 4
06:07:54.664 [info] Sent message to topic kafka-topic-test in 185 ms
06:07:54.665 [info] Sent message to topic kafka-topic-test with value :: "{\"timestamp\":\"2024-01-19T11:35:01+00:00\",\"charged_to\":[{\"amount\":0,\"balance_name\":\"uncapped\",\"qty\":165681}],\"id\":\"\\\\x61623639386565652d643966372d343036352d613462622d646537626439353137393035\",\"cost\":0.0,\"status\":400,\"quantity\":165681,\"primary_service\":\"5G Home X\",\"allocated_qty\":165681,\"type\":100,\"service_id\":\"a72e5f19-6245-4d24-8f69-3bf4bf215895\",\"connection_surcharge\":0,\"inserted_at\":\"2024-01-19T11:35:32+00:00\",\"updated_at\":\"2024-01-19T11:35:32+00:00\",\"end_time\":\"2024-01-19T11:35:00+00:00\",\"meta\":{\"chargingId\":375767394,\"consumed\":{\"6000\":{\"allocated_cost\":0,\"allocated_qty\":0,\"cost\":0,\"end_time\":\"2024-01-19T13:35:00+02:00\",\"quantity\":165681,\"session_status\":300,\"start_time\":\"2024-01-19T13:25:17+02:00\",\"uncharged\":0}},\"ipv4_addr\":\"10.209.0.26\",\"oneTimeEvent\":false,\"ratType\":\"NR\",\"requestor\":\"satest\",\"resource_id\":\"imei-861935050829590\",\"service_id\":\"msisdn-27816699304\",\"userLocationinfo\":{\"eutraLocation\":null,\"n3gaLocation\":null,\"nrLocation\":{\"ageOfLocationInformation\":null,\"geodeticInformation\":null,\"geographicalInformation\":null,\"globalGnbId\":null,\"ignoreNcgi\":null,\"ncgi\":{\"nid\":null,\"nrCellId\":\"0d1414033\",\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"}},\"tai\":{\"nid\":null,\"plmnId\":{\"mcc\":\"655\",\"mnc\":\"73\"},\"tac\":\"07F394\"},\"ueLocationTimestamp\":\"2024-01-19T13:25:15+02:00\"}}},\"rating_group\":6000,\"uncharged\":null,\"charged_for\":\"Unlimited home 5G Premium\",\"rg_meta\":{\"mode\":\"ONLINE\",\"sessionFailover\":\"FAILOVER_NOT_SUPPORTED\"},\"start_time\":\"2024-01-19T11:25:18+00:00\",\"c_id\":\"20240119--c854085c-b6be-11ee-9f99-6cae8b6312a2\",\"rounding_policy\":\"1.110000\",\"unit_rate\":0,\"sub_id\":\"imsi-655730000598400\",\"cr_id\":\"20240119--c853a236-b6be-11ee-a9a1-6cae8b6312a2\",\"tp_meta\":{\"default_quota\":{\"name\":\"totalVolume\",\"quota\":57982058496},\"final_unit\":{\"finalUnitAction\":\"TERMINATE\"},\"model\":\"POST-PAID\",\"neg_balances\":false,\"policy_states\":[\"High Speed\",\"RICA\",\"Device\",\"Payment\",\"PAYMENT_HOLD\"],\"quota_calc\":\"default\",\"quota_rules\":[],\"unit_info\":{\"quotaHoldingTime\":0,\"timeQuotaThreshold\":70,\"triggers\":[{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_THRESHOLD\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QUOTA_EXHAUSTED\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"QHT\"},{\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"VALIDITY_TIME\"}],\"unitQuotaThreshold\":80,\"validityTime\":43200},\"vqt_percentage\":0.4},\"requestor_node_id\":\"trc_udg_upf_01\",\"requestor_service_id\":null,\"item_seq_num\":1,\"applies_to\":{\"balances\":[\"uncapped\"],\"service_type\":\"mobile_data\"},\"description\":null,\"unit\":{\"downlinkVolume\":0,\"eventTimeStamp\":null,\"serviceSpecificUnits\":null,\"time\":null,\"totalVolume\":165681,\"triggerTimestamp\":\"2024-01-19T13:35:01+02:00\",\"triggers\":[{\"maxNumberOfccc\":null,\"timeLimit\":null,\"triggerCategory\":\"IMMEDIATE_REPORT\",\"triggerType\":\"FINAL\",\"volumeLimit\":null,\"volumeLimit64\":null}],\"uplinkVolume\":165681},\"post_surcharge\":0,\"tariff_plan\":\"5G Home X\",\"taxes\":{\"fixed\":0,\"gl\":\"9500A030\",\"name\":\"VAT\",\"percentage\":15,\"tax_amount\":0.0,\"tax_inclusive_amount\":0.0,\"taxable_amount\":0},\"allocated_cost\":0.0,\"error\":null}"
06:07:54.665 [info] Sent 1 messages to topic kafka-topic-test in 185 ms
06:10:26.141 [info] Received notification with payload :: %{"key" => "value"}
06:10:26.143 [info] Notification count: 5
06:10:26.327 [info] Sent message to topic kafka-topic-test in 184 ms
06:10:26.327 [info] Sent message to topic kafka-topic-test with value :: "{\"key\":\"value\"}"
06:10:26.327 [info] Sent 1 messages to topic kafka-topic-test in 184 ms
